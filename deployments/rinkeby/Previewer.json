{
  "address": "0x4339F33f5e36974E8650cF00B2699d993e29d93F",
  "abi": [
    {
      "inputs": [
        {
          "internalType": "contract Auditor",
          "name": "auditor_",
          "type": "address"
        }
      ],
      "stateMutability": "nonpayable",
      "type": "constructor"
    },
    {
      "inputs": [],
      "name": "AlreadyMatured",
      "type": "error"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "account",
          "type": "address"
        }
      ],
      "name": "accounts",
      "outputs": [
        {
          "components": [
            {
              "internalType": "contract FixedLender",
              "name": "market",
              "type": "address"
            },
            {
              "internalType": "string",
              "name": "assetSymbol",
              "type": "string"
            },
            {
              "internalType": "uint256",
              "name": "oraclePrice",
              "type": "uint256"
            },
            {
              "internalType": "uint128",
              "name": "penaltyRate",
              "type": "uint128"
            },
            {
              "internalType": "uint128",
              "name": "adjustFactor",
              "type": "uint128"
            },
            {
              "internalType": "uint8",
              "name": "decimals",
              "type": "uint8"
            },
            {
              "internalType": "uint8",
              "name": "maxFuturePools",
              "type": "uint8"
            },
            {
              "internalType": "bool",
              "name": "isCollateral",
              "type": "bool"
            },
            {
              "internalType": "uint256",
              "name": "smartPoolShares",
              "type": "uint256"
            },
            {
              "internalType": "uint256",
              "name": "smartPoolAssets",
              "type": "uint256"
            },
            {
              "components": [
                {
                  "internalType": "uint256",
                  "name": "maturity",
                  "type": "uint256"
                },
                {
                  "internalType": "uint256",
                  "name": "assets",
                  "type": "uint256"
                }
              ],
              "internalType": "struct Previewer.MaturityLiquidity[]",
              "name": "availableLiquidity",
              "type": "tuple[]"
            },
            {
              "components": [
                {
                  "internalType": "uint256",
                  "name": "maturity",
                  "type": "uint256"
                },
                {
                  "components": [
                    {
                      "internalType": "uint256",
                      "name": "principal",
                      "type": "uint256"
                    },
                    {
                      "internalType": "uint256",
                      "name": "fee",
                      "type": "uint256"
                    }
                  ],
                  "internalType": "struct PoolLib.Position",
                  "name": "position",
                  "type": "tuple"
                }
              ],
              "internalType": "struct Previewer.MaturityPosition[]",
              "name": "maturitySupplyPositions",
              "type": "tuple[]"
            },
            {
              "components": [
                {
                  "internalType": "uint256",
                  "name": "maturity",
                  "type": "uint256"
                },
                {
                  "components": [
                    {
                      "internalType": "uint256",
                      "name": "principal",
                      "type": "uint256"
                    },
                    {
                      "internalType": "uint256",
                      "name": "fee",
                      "type": "uint256"
                    }
                  ],
                  "internalType": "struct PoolLib.Position",
                  "name": "position",
                  "type": "tuple"
                }
              ],
              "internalType": "struct Previewer.MaturityPosition[]",
              "name": "maturityBorrowPositions",
              "type": "tuple[]"
            }
          ],
          "internalType": "struct Previewer.MarketAccount[]",
          "name": "data",
          "type": "tuple[]"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "auditor",
      "outputs": [
        {
          "internalType": "contract Auditor",
          "name": "",
          "type": "address"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "contract FixedLender",
          "name": "market",
          "type": "address"
        },
        {
          "internalType": "uint256",
          "name": "maturity",
          "type": "uint256"
        },
        {
          "internalType": "uint256",
          "name": "assets",
          "type": "uint256"
        }
      ],
      "name": "previewBorrowAtMaturity",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "positionAssets",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "contract FixedLender",
          "name": "market",
          "type": "address"
        },
        {
          "internalType": "uint256",
          "name": "assets",
          "type": "uint256"
        }
      ],
      "name": "previewDepositAtAllMaturities",
      "outputs": [
        {
          "components": [
            {
              "internalType": "uint256",
              "name": "maturity",
              "type": "uint256"
            },
            {
              "internalType": "uint256",
              "name": "assets",
              "type": "uint256"
            }
          ],
          "internalType": "struct Previewer.MaturityLiquidity[]",
          "name": "positionAssetsMaturities",
          "type": "tuple[]"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "contract FixedLender",
          "name": "market",
          "type": "address"
        },
        {
          "internalType": "uint256",
          "name": "maturity",
          "type": "uint256"
        },
        {
          "internalType": "uint256",
          "name": "assets",
          "type": "uint256"
        }
      ],
      "name": "previewDepositAtMaturity",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "positionAssets",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "contract FixedLender",
          "name": "market",
          "type": "address"
        },
        {
          "internalType": "uint256",
          "name": "maturity",
          "type": "uint256"
        },
        {
          "internalType": "uint256",
          "name": "positionAssets",
          "type": "uint256"
        },
        {
          "internalType": "address",
          "name": "borrower",
          "type": "address"
        }
      ],
      "name": "previewRepayAtMaturity",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "repayAssets",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "contract FixedLender",
          "name": "market",
          "type": "address"
        },
        {
          "internalType": "uint256",
          "name": "maturity",
          "type": "uint256"
        },
        {
          "internalType": "uint256",
          "name": "positionAssets",
          "type": "uint256"
        }
      ],
      "name": "previewWithdrawAtMaturity",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "withdrawAssets",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    }
  ],
  "transactionHash": "0xa1f847e9d492ab7762a27d829420437c400629eba821a06a94e23f6ff363edd1",
  "receipt": {
    "to": null,
    "from": "0xDb90CDB64CfF03f254e4015C4F705C3F3C834400",
    "contractAddress": "0x4339F33f5e36974E8650cF00B2699d993e29d93F",
    "transactionIndex": 6,
    "gasUsed": "2385206",
    "logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
    "blockHash": "0x2efc4369ba3a002daf909721a24a2e5ce56078797e307f5474c3517a6be8dd81",
    "transactionHash": "0xa1f847e9d492ab7762a27d829420437c400629eba821a06a94e23f6ff363edd1",
    "logs": [],
    "blockNumber": 10949050,
    "cumulativeGasUsed": "2974081",
    "status": 1,
    "byzantium": true
  },
  "args": [
    "0x778c90630f26447FD92719937627981e5582db66"
  ],
  "numDeployments": 3,
  "solcInputHash": "d458a8179032d046da879dd185ed2161",
  "metadata": "{\"compiler\":{\"version\":\"0.8.13+commit.abaa5c0e\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"contract Auditor\",\"name\":\"auditor_\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[],\"name\":\"AlreadyMatured\",\"type\":\"error\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"account\",\"type\":\"address\"}],\"name\":\"accounts\",\"outputs\":[{\"components\":[{\"internalType\":\"contract FixedLender\",\"name\":\"market\",\"type\":\"address\"},{\"internalType\":\"string\",\"name\":\"assetSymbol\",\"type\":\"string\"},{\"internalType\":\"uint256\",\"name\":\"oraclePrice\",\"type\":\"uint256\"},{\"internalType\":\"uint128\",\"name\":\"penaltyRate\",\"type\":\"uint128\"},{\"internalType\":\"uint128\",\"name\":\"adjustFactor\",\"type\":\"uint128\"},{\"internalType\":\"uint8\",\"name\":\"decimals\",\"type\":\"uint8\"},{\"internalType\":\"uint8\",\"name\":\"maxFuturePools\",\"type\":\"uint8\"},{\"internalType\":\"bool\",\"name\":\"isCollateral\",\"type\":\"bool\"},{\"internalType\":\"uint256\",\"name\":\"smartPoolShares\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"smartPoolAssets\",\"type\":\"uint256\"},{\"components\":[{\"internalType\":\"uint256\",\"name\":\"maturity\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"assets\",\"type\":\"uint256\"}],\"internalType\":\"struct Previewer.MaturityLiquidity[]\",\"name\":\"availableLiquidity\",\"type\":\"tuple[]\"},{\"components\":[{\"internalType\":\"uint256\",\"name\":\"maturity\",\"type\":\"uint256\"},{\"components\":[{\"internalType\":\"uint256\",\"name\":\"principal\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"fee\",\"type\":\"uint256\"}],\"internalType\":\"struct PoolLib.Position\",\"name\":\"position\",\"type\":\"tuple\"}],\"internalType\":\"struct Previewer.MaturityPosition[]\",\"name\":\"maturitySupplyPositions\",\"type\":\"tuple[]\"},{\"components\":[{\"internalType\":\"uint256\",\"name\":\"maturity\",\"type\":\"uint256\"},{\"components\":[{\"internalType\":\"uint256\",\"name\":\"principal\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"fee\",\"type\":\"uint256\"}],\"internalType\":\"struct PoolLib.Position\",\"name\":\"position\",\"type\":\"tuple\"}],\"internalType\":\"struct Previewer.MaturityPosition[]\",\"name\":\"maturityBorrowPositions\",\"type\":\"tuple[]\"}],\"internalType\":\"struct Previewer.MarketAccount[]\",\"name\":\"data\",\"type\":\"tuple[]\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"auditor\",\"outputs\":[{\"internalType\":\"contract Auditor\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"contract FixedLender\",\"name\":\"market\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"maturity\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"assets\",\"type\":\"uint256\"}],\"name\":\"previewBorrowAtMaturity\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"positionAssets\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"contract FixedLender\",\"name\":\"market\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"assets\",\"type\":\"uint256\"}],\"name\":\"previewDepositAtAllMaturities\",\"outputs\":[{\"components\":[{\"internalType\":\"uint256\",\"name\":\"maturity\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"assets\",\"type\":\"uint256\"}],\"internalType\":\"struct Previewer.MaturityLiquidity[]\",\"name\":\"positionAssetsMaturities\",\"type\":\"tuple[]\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"contract FixedLender\",\"name\":\"market\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"maturity\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"assets\",\"type\":\"uint256\"}],\"name\":\"previewDepositAtMaturity\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"positionAssets\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"contract FixedLender\",\"name\":\"market\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"maturity\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"positionAssets\",\"type\":\"uint256\"},{\"internalType\":\"address\",\"name\":\"borrower\",\"type\":\"address\"}],\"name\":\"previewRepayAtMaturity\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"repayAssets\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"contract FixedLender\",\"name\":\"market\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"maturity\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"positionAssets\",\"type\":\"uint256\"}],\"name\":\"previewWithdrawAtMaturity\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"withdrawAssets\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{\"accounts(address)\":{\"params\":{\"account\":\"address which the extended data will be calculated.\"},\"returns\":{\"data\":\"extended accountability of all markets for the account.\"}},\"previewBorrowAtMaturity(address,uint256,uint256)\":{\"params\":{\"assets\":\"amount of assets that will be borrowed.\",\"market\":\"address of the market.\",\"maturity\":\"maturity date/pool where the assets will be borrowed.\"},\"returns\":{\"positionAssets\":\"amount plus fees that the depositor will repay at maturity.\"}},\"previewDepositAtAllMaturities(address,uint256)\":{\"params\":{\"assets\":\"amount of assets that will be deposited.\",\"market\":\"address of the market.\"},\"returns\":{\"positionAssetsMaturities\":\"array containing amount plus yield that user will receive after each maturity.\"}},\"previewDepositAtMaturity(address,uint256,uint256)\":{\"params\":{\"assets\":\"amount of assets that will be deposited.\",\"market\":\"address of the market.\",\"maturity\":\"maturity date/pool where the assets will be deposited.\"},\"returns\":{\"positionAssets\":\"amount plus yield that the depositor will receive after maturity.\"}},\"previewRepayAtMaturity(address,uint256,uint256,address)\":{\"params\":{\"borrower\":\"address of the borrower.\",\"market\":\"address of the market.\",\"maturity\":\"maturity date/pool where the assets will be repaid.\",\"positionAssets\":\"amount of assets that will be subtracted from the position.\"},\"returns\":{\"repayAssets\":\"amount of assets that will be repaid.\"}},\"previewWithdrawAtMaturity(address,uint256,uint256)\":{\"params\":{\"market\":\"address of the market.\",\"maturity\":\"maturity date/pool where the assets will be withdrawn.\",\"positionAssets\":\"amount of assets that will be tried to withdraw.\"},\"returns\":{\"withdrawAssets\":\"amount that will be withdrawn.\"}}},\"title\":\"Previewer\",\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{\"accounts(address)\":{\"notice\":\"Function to get a certain account extended data.\"},\"previewBorrowAtMaturity(address,uint256,uint256)\":{\"notice\":\"Gets the amount plus fees to be repaid at maturity when borrowing certain amount of assets.\"},\"previewDepositAtAllMaturities(address,uint256)\":{\"notice\":\"Gets the assets plus yield offered by all VALID maturities when depositing a certain amount.\"},\"previewDepositAtMaturity(address,uint256,uint256)\":{\"notice\":\"Gets the assets plus yield offered by a maturity when depositing a certain amount.\"},\"previewRepayAtMaturity(address,uint256,uint256,address)\":{\"notice\":\"Gets the assets that will be repaid when repaying a certain amount at the current maturity.\"},\"previewWithdrawAtMaturity(address,uint256,uint256)\":{\"notice\":\"Gets the amount to be withdrawn for a certain positionAmount of assets at maturity.\"}},\"notice\":\"Contract to be consumed by Exactly's front-end dApp.\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"contracts/periphery/Previewer.sol\":\"Previewer\"},\"evmVersion\":\"london\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\",\"useLiteralContent\":true},\"optimizer\":{\"enabled\":true,\"runs\":10000},\"remappings\":[]},\"sources\":{\"@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\npragma solidity ^0.8.0;\\n\\ninterface AggregatorV3Interface {\\n  function decimals() external view returns (uint8);\\n\\n  function description() external view returns (string memory);\\n\\n  function version() external view returns (uint256);\\n\\n  // getRoundData and latestRoundData should both raise \\\"No data present\\\"\\n  // if they do not have data to report, instead of returning unset values\\n  // which could be misinterpreted as actual reported values.\\n  function getRoundData(uint80 _roundId)\\n    external\\n    view\\n    returns (\\n      uint80 roundId,\\n      int256 answer,\\n      uint256 startedAt,\\n      uint256 updatedAt,\\n      uint80 answeredInRound\\n    );\\n\\n  function latestRoundData()\\n    external\\n    view\\n    returns (\\n      uint80 roundId,\\n      int256 answer,\\n      uint256 startedAt,\\n      uint256 updatedAt,\\n      uint80 answeredInRound\\n    );\\n}\\n\",\"keccak256\":\"0xf2b6c9adb3552254df1445b73563cf014434ff5e78663e9b961b6c059506ceb5\",\"license\":\"MIT\"},\"@openzeppelin/contracts/access/AccessControl.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\n// OpenZeppelin Contracts (last updated v4.6.0) (access/AccessControl.sol)\\n\\npragma solidity ^0.8.0;\\n\\nimport \\\"./IAccessControl.sol\\\";\\nimport \\\"../utils/Context.sol\\\";\\nimport \\\"../utils/Strings.sol\\\";\\nimport \\\"../utils/introspection/ERC165.sol\\\";\\n\\n/**\\n * @dev Contract module that allows children to implement role-based access\\n * control mechanisms. This is a lightweight version that doesn't allow enumerating role\\n * members except through off-chain means by accessing the contract event logs. Some\\n * applications may benefit from on-chain enumerability, for those cases see\\n * {AccessControlEnumerable}.\\n *\\n * Roles are referred to by their `bytes32` identifier. These should be exposed\\n * in the external API and be unique. The best way to achieve this is by\\n * using `public constant` hash digests:\\n *\\n * ```\\n * bytes32 public constant MY_ROLE = keccak256(\\\"MY_ROLE\\\");\\n * ```\\n *\\n * Roles can be used to represent a set of permissions. To restrict access to a\\n * function call, use {hasRole}:\\n *\\n * ```\\n * function foo() public {\\n *     require(hasRole(MY_ROLE, msg.sender));\\n *     ...\\n * }\\n * ```\\n *\\n * Roles can be granted and revoked dynamically via the {grantRole} and\\n * {revokeRole} functions. Each role has an associated admin role, and only\\n * accounts that have a role's admin role can call {grantRole} and {revokeRole}.\\n *\\n * By default, the admin role for all roles is `DEFAULT_ADMIN_ROLE`, which means\\n * that only accounts with this role will be able to grant or revoke other\\n * roles. More complex role relationships can be created by using\\n * {_setRoleAdmin}.\\n *\\n * WARNING: The `DEFAULT_ADMIN_ROLE` is also its own admin: it has permission to\\n * grant and revoke this role. Extra precautions should be taken to secure\\n * accounts that have been granted it.\\n */\\nabstract contract AccessControl is Context, IAccessControl, ERC165 {\\n    struct RoleData {\\n        mapping(address => bool) members;\\n        bytes32 adminRole;\\n    }\\n\\n    mapping(bytes32 => RoleData) private _roles;\\n\\n    bytes32 public constant DEFAULT_ADMIN_ROLE = 0x00;\\n\\n    /**\\n     * @dev Modifier that checks that an account has a specific role. Reverts\\n     * with a standardized message including the required role.\\n     *\\n     * The format of the revert reason is given by the following regular expression:\\n     *\\n     *  /^AccessControl: account (0x[0-9a-f]{40}) is missing role (0x[0-9a-f]{64})$/\\n     *\\n     * _Available since v4.1._\\n     */\\n    modifier onlyRole(bytes32 role) {\\n        _checkRole(role);\\n        _;\\n    }\\n\\n    /**\\n     * @dev See {IERC165-supportsInterface}.\\n     */\\n    function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {\\n        return interfaceId == type(IAccessControl).interfaceId || super.supportsInterface(interfaceId);\\n    }\\n\\n    /**\\n     * @dev Returns `true` if `account` has been granted `role`.\\n     */\\n    function hasRole(bytes32 role, address account) public view virtual override returns (bool) {\\n        return _roles[role].members[account];\\n    }\\n\\n    /**\\n     * @dev Revert with a standard message if `_msgSender()` is missing `role`.\\n     * Overriding this function changes the behavior of the {onlyRole} modifier.\\n     *\\n     * Format of the revert message is described in {_checkRole}.\\n     *\\n     * _Available since v4.6._\\n     */\\n    function _checkRole(bytes32 role) internal view virtual {\\n        _checkRole(role, _msgSender());\\n    }\\n\\n    /**\\n     * @dev Revert with a standard message if `account` is missing `role`.\\n     *\\n     * The format of the revert reason is given by the following regular expression:\\n     *\\n     *  /^AccessControl: account (0x[0-9a-f]{40}) is missing role (0x[0-9a-f]{64})$/\\n     */\\n    function _checkRole(bytes32 role, address account) internal view virtual {\\n        if (!hasRole(role, account)) {\\n            revert(\\n                string(\\n                    abi.encodePacked(\\n                        \\\"AccessControl: account \\\",\\n                        Strings.toHexString(uint160(account), 20),\\n                        \\\" is missing role \\\",\\n                        Strings.toHexString(uint256(role), 32)\\n                    )\\n                )\\n            );\\n        }\\n    }\\n\\n    /**\\n     * @dev Returns the admin role that controls `role`. See {grantRole} and\\n     * {revokeRole}.\\n     *\\n     * To change a role's admin, use {_setRoleAdmin}.\\n     */\\n    function getRoleAdmin(bytes32 role) public view virtual override returns (bytes32) {\\n        return _roles[role].adminRole;\\n    }\\n\\n    /**\\n     * @dev Grants `role` to `account`.\\n     *\\n     * If `account` had not been already granted `role`, emits a {RoleGranted}\\n     * event.\\n     *\\n     * Requirements:\\n     *\\n     * - the caller must have ``role``'s admin role.\\n     */\\n    function grantRole(bytes32 role, address account) public virtual override onlyRole(getRoleAdmin(role)) {\\n        _grantRole(role, account);\\n    }\\n\\n    /**\\n     * @dev Revokes `role` from `account`.\\n     *\\n     * If `account` had been granted `role`, emits a {RoleRevoked} event.\\n     *\\n     * Requirements:\\n     *\\n     * - the caller must have ``role``'s admin role.\\n     */\\n    function revokeRole(bytes32 role, address account) public virtual override onlyRole(getRoleAdmin(role)) {\\n        _revokeRole(role, account);\\n    }\\n\\n    /**\\n     * @dev Revokes `role` from the calling account.\\n     *\\n     * Roles are often managed via {grantRole} and {revokeRole}: this function's\\n     * purpose is to provide a mechanism for accounts to lose their privileges\\n     * if they are compromised (such as when a trusted device is misplaced).\\n     *\\n     * If the calling account had been revoked `role`, emits a {RoleRevoked}\\n     * event.\\n     *\\n     * Requirements:\\n     *\\n     * - the caller must be `account`.\\n     */\\n    function renounceRole(bytes32 role, address account) public virtual override {\\n        require(account == _msgSender(), \\\"AccessControl: can only renounce roles for self\\\");\\n\\n        _revokeRole(role, account);\\n    }\\n\\n    /**\\n     * @dev Grants `role` to `account`.\\n     *\\n     * If `account` had not been already granted `role`, emits a {RoleGranted}\\n     * event. Note that unlike {grantRole}, this function doesn't perform any\\n     * checks on the calling account.\\n     *\\n     * [WARNING]\\n     * ====\\n     * This function should only be called from the constructor when setting\\n     * up the initial roles for the system.\\n     *\\n     * Using this function in any other way is effectively circumventing the admin\\n     * system imposed by {AccessControl}.\\n     * ====\\n     *\\n     * NOTE: This function is deprecated in favor of {_grantRole}.\\n     */\\n    function _setupRole(bytes32 role, address account) internal virtual {\\n        _grantRole(role, account);\\n    }\\n\\n    /**\\n     * @dev Sets `adminRole` as ``role``'s admin role.\\n     *\\n     * Emits a {RoleAdminChanged} event.\\n     */\\n    function _setRoleAdmin(bytes32 role, bytes32 adminRole) internal virtual {\\n        bytes32 previousAdminRole = getRoleAdmin(role);\\n        _roles[role].adminRole = adminRole;\\n        emit RoleAdminChanged(role, previousAdminRole, adminRole);\\n    }\\n\\n    /**\\n     * @dev Grants `role` to `account`.\\n     *\\n     * Internal function without access restriction.\\n     */\\n    function _grantRole(bytes32 role, address account) internal virtual {\\n        if (!hasRole(role, account)) {\\n            _roles[role].members[account] = true;\\n            emit RoleGranted(role, account, _msgSender());\\n        }\\n    }\\n\\n    /**\\n     * @dev Revokes `role` from `account`.\\n     *\\n     * Internal function without access restriction.\\n     */\\n    function _revokeRole(bytes32 role, address account) internal virtual {\\n        if (hasRole(role, account)) {\\n            _roles[role].members[account] = false;\\n            emit RoleRevoked(role, account, _msgSender());\\n        }\\n    }\\n}\\n\",\"keccak256\":\"0xb4d87ee2ead4bd192b41c128f287d4b7f24b9e0cd740cc9b476881c461286007\",\"license\":\"MIT\"},\"@openzeppelin/contracts/access/IAccessControl.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\n// OpenZeppelin Contracts v4.4.1 (access/IAccessControl.sol)\\n\\npragma solidity ^0.8.0;\\n\\n/**\\n * @dev External interface of AccessControl declared to support ERC165 detection.\\n */\\ninterface IAccessControl {\\n    /**\\n     * @dev Emitted when `newAdminRole` is set as ``role``'s admin role, replacing `previousAdminRole`\\n     *\\n     * `DEFAULT_ADMIN_ROLE` is the starting admin for all roles, despite\\n     * {RoleAdminChanged} not being emitted signaling this.\\n     *\\n     * _Available since v3.1._\\n     */\\n    event RoleAdminChanged(bytes32 indexed role, bytes32 indexed previousAdminRole, bytes32 indexed newAdminRole);\\n\\n    /**\\n     * @dev Emitted when `account` is granted `role`.\\n     *\\n     * `sender` is the account that originated the contract call, an admin role\\n     * bearer except when using {AccessControl-_setupRole}.\\n     */\\n    event RoleGranted(bytes32 indexed role, address indexed account, address indexed sender);\\n\\n    /**\\n     * @dev Emitted when `account` is revoked `role`.\\n     *\\n     * `sender` is the account that originated the contract call:\\n     *   - if using `revokeRole`, it is the admin role bearer\\n     *   - if using `renounceRole`, it is the role bearer (i.e. `account`)\\n     */\\n    event RoleRevoked(bytes32 indexed role, address indexed account, address indexed sender);\\n\\n    /**\\n     * @dev Returns `true` if `account` has been granted `role`.\\n     */\\n    function hasRole(bytes32 role, address account) external view returns (bool);\\n\\n    /**\\n     * @dev Returns the admin role that controls `role`. See {grantRole} and\\n     * {revokeRole}.\\n     *\\n     * To change a role's admin, use {AccessControl-_setRoleAdmin}.\\n     */\\n    function getRoleAdmin(bytes32 role) external view returns (bytes32);\\n\\n    /**\\n     * @dev Grants `role` to `account`.\\n     *\\n     * If `account` had not been already granted `role`, emits a {RoleGranted}\\n     * event.\\n     *\\n     * Requirements:\\n     *\\n     * - the caller must have ``role``'s admin role.\\n     */\\n    function grantRole(bytes32 role, address account) external;\\n\\n    /**\\n     * @dev Revokes `role` from `account`.\\n     *\\n     * If `account` had been granted `role`, emits a {RoleRevoked} event.\\n     *\\n     * Requirements:\\n     *\\n     * - the caller must have ``role``'s admin role.\\n     */\\n    function revokeRole(bytes32 role, address account) external;\\n\\n    /**\\n     * @dev Revokes `role` from the calling account.\\n     *\\n     * Roles are often managed via {grantRole} and {revokeRole}: this function's\\n     * purpose is to provide a mechanism for accounts to lose their privileges\\n     * if they are compromised (such as when a trusted device is misplaced).\\n     *\\n     * If the calling account had been granted `role`, emits a {RoleRevoked}\\n     * event.\\n     *\\n     * Requirements:\\n     *\\n     * - the caller must be `account`.\\n     */\\n    function renounceRole(bytes32 role, address account) external;\\n}\\n\",\"keccak256\":\"0x59ce320a585d7e1f163cd70390a0ef2ff9cec832e2aa544293a00692465a7a57\",\"license\":\"MIT\"},\"@openzeppelin/contracts/security/Pausable.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\n// OpenZeppelin Contracts v4.4.1 (security/Pausable.sol)\\n\\npragma solidity ^0.8.0;\\n\\nimport \\\"../utils/Context.sol\\\";\\n\\n/**\\n * @dev Contract module which allows children to implement an emergency stop\\n * mechanism that can be triggered by an authorized account.\\n *\\n * This module is used through inheritance. It will make available the\\n * modifiers `whenNotPaused` and `whenPaused`, which can be applied to\\n * the functions of your contract. Note that they will not be pausable by\\n * simply including this module, only once the modifiers are put in place.\\n */\\nabstract contract Pausable is Context {\\n    /**\\n     * @dev Emitted when the pause is triggered by `account`.\\n     */\\n    event Paused(address account);\\n\\n    /**\\n     * @dev Emitted when the pause is lifted by `account`.\\n     */\\n    event Unpaused(address account);\\n\\n    bool private _paused;\\n\\n    /**\\n     * @dev Initializes the contract in unpaused state.\\n     */\\n    constructor() {\\n        _paused = false;\\n    }\\n\\n    /**\\n     * @dev Returns true if the contract is paused, and false otherwise.\\n     */\\n    function paused() public view virtual returns (bool) {\\n        return _paused;\\n    }\\n\\n    /**\\n     * @dev Modifier to make a function callable only when the contract is not paused.\\n     *\\n     * Requirements:\\n     *\\n     * - The contract must not be paused.\\n     */\\n    modifier whenNotPaused() {\\n        require(!paused(), \\\"Pausable: paused\\\");\\n        _;\\n    }\\n\\n    /**\\n     * @dev Modifier to make a function callable only when the contract is paused.\\n     *\\n     * Requirements:\\n     *\\n     * - The contract must be paused.\\n     */\\n    modifier whenPaused() {\\n        require(paused(), \\\"Pausable: not paused\\\");\\n        _;\\n    }\\n\\n    /**\\n     * @dev Triggers stopped state.\\n     *\\n     * Requirements:\\n     *\\n     * - The contract must not be paused.\\n     */\\n    function _pause() internal virtual whenNotPaused {\\n        _paused = true;\\n        emit Paused(_msgSender());\\n    }\\n\\n    /**\\n     * @dev Returns to normal state.\\n     *\\n     * Requirements:\\n     *\\n     * - The contract must be paused.\\n     */\\n    function _unpause() internal virtual whenPaused {\\n        _paused = false;\\n        emit Unpaused(_msgSender());\\n    }\\n}\\n\",\"keccak256\":\"0xe68ed7fb8766ed1e888291f881e36b616037f852b37d96877045319ad298ba87\",\"license\":\"MIT\"},\"@openzeppelin/contracts/utils/Context.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\n// OpenZeppelin Contracts v4.4.1 (utils/Context.sol)\\n\\npragma solidity ^0.8.0;\\n\\n/**\\n * @dev Provides information about the current execution context, including the\\n * sender of the transaction and its data. While these are generally available\\n * via msg.sender and msg.data, they should not be accessed in such a direct\\n * manner, since when dealing with meta-transactions the account sending and\\n * paying for execution may not be the actual sender (as far as an application\\n * is concerned).\\n *\\n * This contract is only required for intermediate, library-like contracts.\\n */\\nabstract contract Context {\\n    function _msgSender() internal view virtual returns (address) {\\n        return msg.sender;\\n    }\\n\\n    function _msgData() internal view virtual returns (bytes calldata) {\\n        return msg.data;\\n    }\\n}\\n\",\"keccak256\":\"0xe2e337e6dde9ef6b680e07338c493ebea1b5fd09b43424112868e9cc1706bca7\",\"license\":\"MIT\"},\"@openzeppelin/contracts/utils/Strings.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\n// OpenZeppelin Contracts v4.4.1 (utils/Strings.sol)\\n\\npragma solidity ^0.8.0;\\n\\n/**\\n * @dev String operations.\\n */\\nlibrary Strings {\\n    bytes16 private constant _HEX_SYMBOLS = \\\"0123456789abcdef\\\";\\n\\n    /**\\n     * @dev Converts a `uint256` to its ASCII `string` decimal representation.\\n     */\\n    function toString(uint256 value) internal pure returns (string memory) {\\n        // Inspired by OraclizeAPI's implementation - MIT licence\\n        // https://github.com/oraclize/ethereum-api/blob/b42146b063c7d6ee1358846c198246239e9360e8/oraclizeAPI_0.4.25.sol\\n\\n        if (value == 0) {\\n            return \\\"0\\\";\\n        }\\n        uint256 temp = value;\\n        uint256 digits;\\n        while (temp != 0) {\\n            digits++;\\n            temp /= 10;\\n        }\\n        bytes memory buffer = new bytes(digits);\\n        while (value != 0) {\\n            digits -= 1;\\n            buffer[digits] = bytes1(uint8(48 + uint256(value % 10)));\\n            value /= 10;\\n        }\\n        return string(buffer);\\n    }\\n\\n    /**\\n     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation.\\n     */\\n    function toHexString(uint256 value) internal pure returns (string memory) {\\n        if (value == 0) {\\n            return \\\"0x00\\\";\\n        }\\n        uint256 temp = value;\\n        uint256 length = 0;\\n        while (temp != 0) {\\n            length++;\\n            temp >>= 8;\\n        }\\n        return toHexString(value, length);\\n    }\\n\\n    /**\\n     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation with fixed length.\\n     */\\n    function toHexString(uint256 value, uint256 length) internal pure returns (string memory) {\\n        bytes memory buffer = new bytes(2 * length + 2);\\n        buffer[0] = \\\"0\\\";\\n        buffer[1] = \\\"x\\\";\\n        for (uint256 i = 2 * length + 1; i > 1; --i) {\\n            buffer[i] = _HEX_SYMBOLS[value & 0xf];\\n            value >>= 4;\\n        }\\n        require(value == 0, \\\"Strings: hex length insufficient\\\");\\n        return string(buffer);\\n    }\\n}\\n\",\"keccak256\":\"0x32c202bd28995dd20c4347b7c6467a6d3241c74c8ad3edcbb610cd9205916c45\",\"license\":\"MIT\"},\"@openzeppelin/contracts/utils/introspection/ERC165.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\n// OpenZeppelin Contracts v4.4.1 (utils/introspection/ERC165.sol)\\n\\npragma solidity ^0.8.0;\\n\\nimport \\\"./IERC165.sol\\\";\\n\\n/**\\n * @dev Implementation of the {IERC165} interface.\\n *\\n * Contracts that want to implement ERC165 should inherit from this contract and override {supportsInterface} to check\\n * for the additional interface id that will be supported. For example:\\n *\\n * ```solidity\\n * function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {\\n *     return interfaceId == type(MyInterface).interfaceId || super.supportsInterface(interfaceId);\\n * }\\n * ```\\n *\\n * Alternatively, {ERC165Storage} provides an easier to use but more expensive implementation.\\n */\\nabstract contract ERC165 is IERC165 {\\n    /**\\n     * @dev See {IERC165-supportsInterface}.\\n     */\\n    function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {\\n        return interfaceId == type(IERC165).interfaceId;\\n    }\\n}\\n\",\"keccak256\":\"0xd10975de010d89fd1c78dc5e8a9a7e7f496198085c151648f20cba166b32582b\",\"license\":\"MIT\"},\"@openzeppelin/contracts/utils/introspection/IERC165.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\n// OpenZeppelin Contracts v4.4.1 (utils/introspection/IERC165.sol)\\n\\npragma solidity ^0.8.0;\\n\\n/**\\n * @dev Interface of the ERC165 standard, as defined in the\\n * https://eips.ethereum.org/EIPS/eip-165[EIP].\\n *\\n * Implementers can declare support of contract interfaces, which can then be\\n * queried by others ({ERC165Checker}).\\n *\\n * For an implementation, see {ERC165}.\\n */\\ninterface IERC165 {\\n    /**\\n     * @dev Returns true if this contract implements the interface defined by\\n     * `interfaceId`. See the corresponding\\n     * https://eips.ethereum.org/EIPS/eip-165#how-interfaces-are-identified[EIP section]\\n     * to learn more about how these ids are created.\\n     *\\n     * This function call must use less than 30 000 gas.\\n     */\\n    function supportsInterface(bytes4 interfaceId) external view returns (bool);\\n}\\n\",\"keccak256\":\"0x447a5f3ddc18419d41ff92b3773fb86471b1db25773e07f877f548918a185bf1\",\"license\":\"MIT\"},\"@openzeppelin/contracts/utils/math/Math.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\n// OpenZeppelin Contracts (last updated v4.5.0) (utils/math/Math.sol)\\n\\npragma solidity ^0.8.0;\\n\\n/**\\n * @dev Standard math utilities missing in the Solidity language.\\n */\\nlibrary Math {\\n    /**\\n     * @dev Returns the largest of two numbers.\\n     */\\n    function max(uint256 a, uint256 b) internal pure returns (uint256) {\\n        return a >= b ? a : b;\\n    }\\n\\n    /**\\n     * @dev Returns the smallest of two numbers.\\n     */\\n    function min(uint256 a, uint256 b) internal pure returns (uint256) {\\n        return a < b ? a : b;\\n    }\\n\\n    /**\\n     * @dev Returns the average of two numbers. The result is rounded towards\\n     * zero.\\n     */\\n    function average(uint256 a, uint256 b) internal pure returns (uint256) {\\n        // (a + b) / 2 can overflow.\\n        return (a & b) + (a ^ b) / 2;\\n    }\\n\\n    /**\\n     * @dev Returns the ceiling of the division of two numbers.\\n     *\\n     * This differs from standard division with `/` in that it rounds up instead\\n     * of rounding down.\\n     */\\n    function ceilDiv(uint256 a, uint256 b) internal pure returns (uint256) {\\n        // (a + b - 1) / b can overflow on addition, so we distribute.\\n        return a / b + (a % b == 0 ? 0 : 1);\\n    }\\n}\\n\",\"keccak256\":\"0xc995bddbca1ae19788db9f8b61e63385edd3fddf89693b612d5abd1a275974d2\",\"license\":\"MIT\"},\"@rari-capital/solmate/src/mixins/ERC4626.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\npragma solidity >=0.8.0;\\n\\nimport {ERC20} from \\\"../tokens/ERC20.sol\\\";\\nimport {SafeTransferLib} from \\\"../utils/SafeTransferLib.sol\\\";\\nimport {FixedPointMathLib} from \\\"../utils/FixedPointMathLib.sol\\\";\\n\\n/// @notice Minimal ERC4626 tokenized Vault implementation.\\n/// @author Solmate (https://github.com/Rari-Capital/solmate/blob/main/src/mixins/ERC4626.sol)\\nabstract contract ERC4626 is ERC20 {\\n    using SafeTransferLib for ERC20;\\n    using FixedPointMathLib for uint256;\\n\\n    /*//////////////////////////////////////////////////////////////\\n                                 EVENTS\\n    //////////////////////////////////////////////////////////////*/\\n\\n    event Deposit(address indexed caller, address indexed owner, uint256 assets, uint256 shares);\\n\\n    event Withdraw(\\n        address indexed caller,\\n        address indexed receiver,\\n        address indexed owner,\\n        uint256 assets,\\n        uint256 shares\\n    );\\n\\n    /*//////////////////////////////////////////////////////////////\\n                               IMMUTABLES\\n    //////////////////////////////////////////////////////////////*/\\n\\n    ERC20 public immutable asset;\\n\\n    constructor(\\n        ERC20 _asset,\\n        string memory _name,\\n        string memory _symbol\\n    ) ERC20(_name, _symbol, _asset.decimals()) {\\n        asset = _asset;\\n    }\\n\\n    /*//////////////////////////////////////////////////////////////\\n                        DEPOSIT/WITHDRAWAL LOGIC\\n    //////////////////////////////////////////////////////////////*/\\n\\n    function deposit(uint256 assets, address receiver) public virtual returns (uint256 shares) {\\n        // Check for rounding error since we round down in previewDeposit.\\n        require((shares = previewDeposit(assets)) != 0, \\\"ZERO_SHARES\\\");\\n\\n        // Need to transfer before minting or ERC777s could reenter.\\n        asset.safeTransferFrom(msg.sender, address(this), assets);\\n\\n        _mint(receiver, shares);\\n\\n        emit Deposit(msg.sender, receiver, assets, shares);\\n\\n        afterDeposit(assets, shares);\\n    }\\n\\n    function mint(uint256 shares, address receiver) public virtual returns (uint256 assets) {\\n        assets = previewMint(shares); // No need to check for rounding error, previewMint rounds up.\\n\\n        // Need to transfer before minting or ERC777s could reenter.\\n        asset.safeTransferFrom(msg.sender, address(this), assets);\\n\\n        _mint(receiver, shares);\\n\\n        emit Deposit(msg.sender, receiver, assets, shares);\\n\\n        afterDeposit(assets, shares);\\n    }\\n\\n    function withdraw(\\n        uint256 assets,\\n        address receiver,\\n        address owner\\n    ) public virtual returns (uint256 shares) {\\n        shares = previewWithdraw(assets); // No need to check for rounding error, previewWithdraw rounds up.\\n\\n        if (msg.sender != owner) {\\n            uint256 allowed = allowance[owner][msg.sender]; // Saves gas for limited approvals.\\n\\n            if (allowed != type(uint256).max) allowance[owner][msg.sender] = allowed - shares;\\n        }\\n\\n        beforeWithdraw(assets, shares);\\n\\n        _burn(owner, shares);\\n\\n        emit Withdraw(msg.sender, receiver, owner, assets, shares);\\n\\n        asset.safeTransfer(receiver, assets);\\n    }\\n\\n    function redeem(\\n        uint256 shares,\\n        address receiver,\\n        address owner\\n    ) public virtual returns (uint256 assets) {\\n        if (msg.sender != owner) {\\n            uint256 allowed = allowance[owner][msg.sender]; // Saves gas for limited approvals.\\n\\n            if (allowed != type(uint256).max) allowance[owner][msg.sender] = allowed - shares;\\n        }\\n\\n        // Check for rounding error since we round down in previewRedeem.\\n        require((assets = previewRedeem(shares)) != 0, \\\"ZERO_ASSETS\\\");\\n\\n        beforeWithdraw(assets, shares);\\n\\n        _burn(owner, shares);\\n\\n        emit Withdraw(msg.sender, receiver, owner, assets, shares);\\n\\n        asset.safeTransfer(receiver, assets);\\n    }\\n\\n    /*//////////////////////////////////////////////////////////////\\n                            ACCOUNTING LOGIC\\n    //////////////////////////////////////////////////////////////*/\\n\\n    function totalAssets() public view virtual returns (uint256);\\n\\n    function convertToShares(uint256 assets) public view virtual returns (uint256) {\\n        uint256 supply = totalSupply; // Saves an extra SLOAD if totalSupply is non-zero.\\n\\n        return supply == 0 ? assets : assets.mulDivDown(supply, totalAssets());\\n    }\\n\\n    function convertToAssets(uint256 shares) public view virtual returns (uint256) {\\n        uint256 supply = totalSupply; // Saves an extra SLOAD if totalSupply is non-zero.\\n\\n        return supply == 0 ? shares : shares.mulDivDown(totalAssets(), supply);\\n    }\\n\\n    function previewDeposit(uint256 assets) public view virtual returns (uint256) {\\n        return convertToShares(assets);\\n    }\\n\\n    function previewMint(uint256 shares) public view virtual returns (uint256) {\\n        uint256 supply = totalSupply; // Saves an extra SLOAD if totalSupply is non-zero.\\n\\n        return supply == 0 ? shares : shares.mulDivUp(totalAssets(), supply);\\n    }\\n\\n    function previewWithdraw(uint256 assets) public view virtual returns (uint256) {\\n        uint256 supply = totalSupply; // Saves an extra SLOAD if totalSupply is non-zero.\\n\\n        return supply == 0 ? assets : assets.mulDivUp(supply, totalAssets());\\n    }\\n\\n    function previewRedeem(uint256 shares) public view virtual returns (uint256) {\\n        return convertToAssets(shares);\\n    }\\n\\n    /*//////////////////////////////////////////////////////////////\\n                     DEPOSIT/WITHDRAWAL LIMIT LOGIC\\n    //////////////////////////////////////////////////////////////*/\\n\\n    function maxDeposit(address) public view virtual returns (uint256) {\\n        return type(uint256).max;\\n    }\\n\\n    function maxMint(address) public view virtual returns (uint256) {\\n        return type(uint256).max;\\n    }\\n\\n    function maxWithdraw(address owner) public view virtual returns (uint256) {\\n        return convertToAssets(balanceOf[owner]);\\n    }\\n\\n    function maxRedeem(address owner) public view virtual returns (uint256) {\\n        return balanceOf[owner];\\n    }\\n\\n    /*//////////////////////////////////////////////////////////////\\n                          INTERNAL HOOKS LOGIC\\n    //////////////////////////////////////////////////////////////*/\\n\\n    function beforeWithdraw(uint256 assets, uint256 shares) internal virtual {}\\n\\n    function afterDeposit(uint256 assets, uint256 shares) internal virtual {}\\n}\\n\",\"keccak256\":\"0xa0e0c28a727524fa94e7e6c1f4c793a6bd1e6d1bc652b7b02b343ebaf4cd774b\",\"license\":\"MIT\"},\"@rari-capital/solmate/src/tokens/ERC20.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\npragma solidity >=0.8.0;\\n\\n/// @notice Modern and gas efficient ERC20 + EIP-2612 implementation.\\n/// @author Solmate (https://github.com/Rari-Capital/solmate/blob/main/src/tokens/ERC20.sol)\\n/// @author Modified from Uniswap (https://github.com/Uniswap/uniswap-v2-core/blob/master/contracts/UniswapV2ERC20.sol)\\n/// @dev Do not manually set balances without updating totalSupply, as the sum of all user balances must not exceed it.\\nabstract contract ERC20 {\\n    /*//////////////////////////////////////////////////////////////\\n                                 EVENTS\\n    //////////////////////////////////////////////////////////////*/\\n\\n    event Transfer(address indexed from, address indexed to, uint256 amount);\\n\\n    event Approval(address indexed owner, address indexed spender, uint256 amount);\\n\\n    /*//////////////////////////////////////////////////////////////\\n                            METADATA STORAGE\\n    //////////////////////////////////////////////////////////////*/\\n\\n    string public name;\\n\\n    string public symbol;\\n\\n    uint8 public immutable decimals;\\n\\n    /*//////////////////////////////////////////////////////////////\\n                              ERC20 STORAGE\\n    //////////////////////////////////////////////////////////////*/\\n\\n    uint256 public totalSupply;\\n\\n    mapping(address => uint256) public balanceOf;\\n\\n    mapping(address => mapping(address => uint256)) public allowance;\\n\\n    /*//////////////////////////////////////////////////////////////\\n                            EIP-2612 STORAGE\\n    //////////////////////////////////////////////////////////////*/\\n\\n    uint256 internal immutable INITIAL_CHAIN_ID;\\n\\n    bytes32 internal immutable INITIAL_DOMAIN_SEPARATOR;\\n\\n    mapping(address => uint256) public nonces;\\n\\n    /*//////////////////////////////////////////////////////////////\\n                               CONSTRUCTOR\\n    //////////////////////////////////////////////////////////////*/\\n\\n    constructor(\\n        string memory _name,\\n        string memory _symbol,\\n        uint8 _decimals\\n    ) {\\n        name = _name;\\n        symbol = _symbol;\\n        decimals = _decimals;\\n\\n        INITIAL_CHAIN_ID = block.chainid;\\n        INITIAL_DOMAIN_SEPARATOR = computeDomainSeparator();\\n    }\\n\\n    /*//////////////////////////////////////////////////////////////\\n                               ERC20 LOGIC\\n    //////////////////////////////////////////////////////////////*/\\n\\n    function approve(address spender, uint256 amount) public virtual returns (bool) {\\n        allowance[msg.sender][spender] = amount;\\n\\n        emit Approval(msg.sender, spender, amount);\\n\\n        return true;\\n    }\\n\\n    function transfer(address to, uint256 amount) public virtual returns (bool) {\\n        balanceOf[msg.sender] -= amount;\\n\\n        // Cannot overflow because the sum of all user\\n        // balances can't exceed the max uint256 value.\\n        unchecked {\\n            balanceOf[to] += amount;\\n        }\\n\\n        emit Transfer(msg.sender, to, amount);\\n\\n        return true;\\n    }\\n\\n    function transferFrom(\\n        address from,\\n        address to,\\n        uint256 amount\\n    ) public virtual returns (bool) {\\n        uint256 allowed = allowance[from][msg.sender]; // Saves gas for limited approvals.\\n\\n        if (allowed != type(uint256).max) allowance[from][msg.sender] = allowed - amount;\\n\\n        balanceOf[from] -= amount;\\n\\n        // Cannot overflow because the sum of all user\\n        // balances can't exceed the max uint256 value.\\n        unchecked {\\n            balanceOf[to] += amount;\\n        }\\n\\n        emit Transfer(from, to, amount);\\n\\n        return true;\\n    }\\n\\n    /*//////////////////////////////////////////////////////////////\\n                             EIP-2612 LOGIC\\n    //////////////////////////////////////////////////////////////*/\\n\\n    function permit(\\n        address owner,\\n        address spender,\\n        uint256 value,\\n        uint256 deadline,\\n        uint8 v,\\n        bytes32 r,\\n        bytes32 s\\n    ) public virtual {\\n        require(deadline >= block.timestamp, \\\"PERMIT_DEADLINE_EXPIRED\\\");\\n\\n        // Unchecked because the only math done is incrementing\\n        // the owner's nonce which cannot realistically overflow.\\n        unchecked {\\n            address recoveredAddress = ecrecover(\\n                keccak256(\\n                    abi.encodePacked(\\n                        \\\"\\\\x19\\\\x01\\\",\\n                        DOMAIN_SEPARATOR(),\\n                        keccak256(\\n                            abi.encode(\\n                                keccak256(\\n                                    \\\"Permit(address owner,address spender,uint256 value,uint256 nonce,uint256 deadline)\\\"\\n                                ),\\n                                owner,\\n                                spender,\\n                                value,\\n                                nonces[owner]++,\\n                                deadline\\n                            )\\n                        )\\n                    )\\n                ),\\n                v,\\n                r,\\n                s\\n            );\\n\\n            require(recoveredAddress != address(0) && recoveredAddress == owner, \\\"INVALID_SIGNER\\\");\\n\\n            allowance[recoveredAddress][spender] = value;\\n        }\\n\\n        emit Approval(owner, spender, value);\\n    }\\n\\n    function DOMAIN_SEPARATOR() public view virtual returns (bytes32) {\\n        return block.chainid == INITIAL_CHAIN_ID ? INITIAL_DOMAIN_SEPARATOR : computeDomainSeparator();\\n    }\\n\\n    function computeDomainSeparator() internal view virtual returns (bytes32) {\\n        return\\n            keccak256(\\n                abi.encode(\\n                    keccak256(\\\"EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)\\\"),\\n                    keccak256(bytes(name)),\\n                    keccak256(\\\"1\\\"),\\n                    block.chainid,\\n                    address(this)\\n                )\\n            );\\n    }\\n\\n    /*//////////////////////////////////////////////////////////////\\n                        INTERNAL MINT/BURN LOGIC\\n    //////////////////////////////////////////////////////////////*/\\n\\n    function _mint(address to, uint256 amount) internal virtual {\\n        totalSupply += amount;\\n\\n        // Cannot overflow because the sum of all user\\n        // balances can't exceed the max uint256 value.\\n        unchecked {\\n            balanceOf[to] += amount;\\n        }\\n\\n        emit Transfer(address(0), to, amount);\\n    }\\n\\n    function _burn(address from, uint256 amount) internal virtual {\\n        balanceOf[from] -= amount;\\n\\n        // Cannot underflow because a user's balance\\n        // will never be larger than the total supply.\\n        unchecked {\\n            totalSupply -= amount;\\n        }\\n\\n        emit Transfer(from, address(0), amount);\\n    }\\n}\\n\",\"keccak256\":\"0x43aa1509bb753f053143530705d9c4eee415691d26a4779769bf028a74e6ac69\",\"license\":\"MIT\"},\"@rari-capital/solmate/src/utils/FixedPointMathLib.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\npragma solidity >=0.8.0;\\n\\n/// @notice Arithmetic library with operations for fixed-point numbers.\\n/// @author Solmate (https://github.com/Rari-Capital/solmate/blob/main/src/utils/FixedPointMathLib.sol)\\nlibrary FixedPointMathLib {\\n    /*//////////////////////////////////////////////////////////////\\n                    SIMPLIFIED FIXED POINT OPERATIONS\\n    //////////////////////////////////////////////////////////////*/\\n\\n    uint256 internal constant WAD = 1e18; // The scalar of ETH and most ERC20s.\\n\\n    function mulWadDown(uint256 x, uint256 y) internal pure returns (uint256) {\\n        return mulDivDown(x, y, WAD); // Equivalent to (x * y) / WAD rounded down.\\n    }\\n\\n    function mulWadUp(uint256 x, uint256 y) internal pure returns (uint256) {\\n        return mulDivUp(x, y, WAD); // Equivalent to (x * y) / WAD rounded up.\\n    }\\n\\n    function divWadDown(uint256 x, uint256 y) internal pure returns (uint256) {\\n        return mulDivDown(x, WAD, y); // Equivalent to (x * WAD) / y rounded down.\\n    }\\n\\n    function divWadUp(uint256 x, uint256 y) internal pure returns (uint256) {\\n        return mulDivUp(x, WAD, y); // Equivalent to (x * WAD) / y rounded up.\\n    }\\n\\n    function powWad(int256 x, int256 y) internal pure returns (int256) {\\n        // Equivalent to x to the power of y because x ** y = (e ** ln(x)) ** y = e ** (ln(x) * y)\\n        return expWad((lnWad(x) * y) / int256(WAD)); // Using ln(x) means x must be greater than 0.\\n    }\\n\\n    function expWad(int256 x) internal pure returns (int256 r) {\\n        unchecked {\\n            // When the result is < 0.5 we return zero. This happens when\\n            // x <= floor(log(0.5e18) * 1e18) ~ -42e18\\n            if (x <= -42139678854452767551) return 0;\\n\\n            // When the result is > (2**255 - 1) / 1e18 we can not represent it as an\\n            // int. This happens when x >= floor(log((2**255 - 1) / 1e18) * 1e18) ~ 135.\\n            if (x >= 135305999368893231589) revert(\\\"EXP_OVERFLOW\\\");\\n\\n            // x is now in the range (-42, 136) * 1e18. Convert to (-42, 136) * 2**96\\n            // for more intermediate precision and a binary basis. This base conversion\\n            // is a multiplication by 1e18 / 2**96 = 5**18 / 2**78.\\n            x = (x << 78) / 5**18;\\n\\n            // Reduce range of x to (-\\u00bd ln 2, \\u00bd ln 2) * 2**96 by factoring out powers\\n            // of two such that exp(x) = exp(x') * 2**k, where k is an integer.\\n            // Solving this gives k = round(x / log(2)) and x' = x - k * log(2).\\n            int256 k = ((x << 96) / 54916777467707473351141471128 + 2**95) >> 96;\\n            x = x - k * 54916777467707473351141471128;\\n\\n            // k is in the range [-61, 195].\\n\\n            // Evaluate using a (6, 7)-term rational approximation.\\n            // p is made monic, we'll multiply by a scale factor later.\\n            int256 y = x + 1346386616545796478920950773328;\\n            y = ((y * x) >> 96) + 57155421227552351082224309758442;\\n            int256 p = y + x - 94201549194550492254356042504812;\\n            p = ((p * y) >> 96) + 28719021644029726153956944680412240;\\n            p = p * x + (4385272521454847904659076985693276 << 96);\\n\\n            // We leave p in 2**192 basis so we don't need to scale it back up for the division.\\n            int256 q = x - 2855989394907223263936484059900;\\n            q = ((q * x) >> 96) + 50020603652535783019961831881945;\\n            q = ((q * x) >> 96) - 533845033583426703283633433725380;\\n            q = ((q * x) >> 96) + 3604857256930695427073651918091429;\\n            q = ((q * x) >> 96) - 14423608567350463180887372962807573;\\n            q = ((q * x) >> 96) + 26449188498355588339934803723976023;\\n\\n            assembly {\\n                // Div in assembly because solidity adds a zero check despite the unchecked.\\n                // The q polynomial won't have zeros in the domain as all its roots are complex.\\n                // No scaling is necessary because p is already 2**96 too large.\\n                r := sdiv(p, q)\\n            }\\n\\n            // r should be in the range (0.09, 0.25) * 2**96.\\n\\n            // We now need to multiply r by:\\n            // * the scale factor s = ~6.031367120.\\n            // * the 2**k factor from the range reduction.\\n            // * the 1e18 / 2**96 factor for base conversion.\\n            // We do this all at once, with an intermediate result in 2**213\\n            // basis, so the final right shift is always by a positive amount.\\n            r = int256((uint256(r) * 3822833074963236453042738258902158003155416615667) >> uint256(195 - k));\\n        }\\n    }\\n\\n    function lnWad(int256 x) internal pure returns (int256 r) {\\n        unchecked {\\n            require(x > 0, \\\"UNDEFINED\\\");\\n\\n            // We want to convert x from 10**18 fixed point to 2**96 fixed point.\\n            // We do this by multiplying by 2**96 / 10**18. But since\\n            // ln(x * C) = ln(x) + ln(C), we can simply do nothing here\\n            // and add ln(2**96 / 10**18) at the end.\\n\\n            // Reduce range of x to (1, 2) * 2**96\\n            // ln(2^k * x) = k * ln(2) + ln(x)\\n            int256 k = int256(log2(uint256(x))) - 96;\\n            x <<= uint256(159 - k);\\n            x = int256(uint256(x) >> 159);\\n\\n            // Evaluate using a (8, 8)-term rational approximation.\\n            // p is made monic, we will multiply by a scale factor later.\\n            int256 p = x + 3273285459638523848632254066296;\\n            p = ((p * x) >> 96) + 24828157081833163892658089445524;\\n            p = ((p * x) >> 96) + 43456485725739037958740375743393;\\n            p = ((p * x) >> 96) - 11111509109440967052023855526967;\\n            p = ((p * x) >> 96) - 45023709667254063763336534515857;\\n            p = ((p * x) >> 96) - 14706773417378608786704636184526;\\n            p = p * x - (795164235651350426258249787498 << 96);\\n\\n            // We leave p in 2**192 basis so we don't need to scale it back up for the division.\\n            // q is monic by convention.\\n            int256 q = x + 5573035233440673466300451813936;\\n            q = ((q * x) >> 96) + 71694874799317883764090561454958;\\n            q = ((q * x) >> 96) + 283447036172924575727196451306956;\\n            q = ((q * x) >> 96) + 401686690394027663651624208769553;\\n            q = ((q * x) >> 96) + 204048457590392012362485061816622;\\n            q = ((q * x) >> 96) + 31853899698501571402653359427138;\\n            q = ((q * x) >> 96) + 909429971244387300277376558375;\\n            assembly {\\n                // Div in assembly because solidity adds a zero check despite the unchecked.\\n                // The q polynomial is known not to have zeros in the domain.\\n                // No scaling required because p is already 2**96 too large.\\n                r := sdiv(p, q)\\n            }\\n\\n            // r is in the range (0, 0.125) * 2**96\\n\\n            // Finalization, we need to:\\n            // * multiply by the scale factor s = 5.549\\u2026\\n            // * add ln(2**96 / 10**18)\\n            // * add k * ln(2)\\n            // * multiply by 10**18 / 2**96 = 5**18 >> 78\\n\\n            // mul s * 5e18 * 2**96, base is now 5**18 * 2**192\\n            r *= 1677202110996718588342820967067443963516166;\\n            // add ln(2) * k * 5e18 * 2**192\\n            r += 16597577552685614221487285958193947469193820559219878177908093499208371 * k;\\n            // add ln(2**96 / 10**18) * 5e18 * 2**192\\n            r += 600920179829731861736702779321621459595472258049074101567377883020018308;\\n            // base conversion: mul 2**18 / 2**192\\n            r >>= 174;\\n        }\\n    }\\n\\n    /*//////////////////////////////////////////////////////////////\\n                    LOW LEVEL FIXED POINT OPERATIONS\\n    //////////////////////////////////////////////////////////////*/\\n\\n    function mulDivDown(\\n        uint256 x,\\n        uint256 y,\\n        uint256 denominator\\n    ) internal pure returns (uint256 z) {\\n        assembly {\\n            // Store x * y in z for now.\\n            z := mul(x, y)\\n\\n            // Equivalent to require(denominator != 0 && (x == 0 || (x * y) / x == y))\\n            if iszero(and(iszero(iszero(denominator)), or(iszero(x), eq(div(z, x), y)))) {\\n                revert(0, 0)\\n            }\\n\\n            // Divide z by the denominator.\\n            z := div(z, denominator)\\n        }\\n    }\\n\\n    function mulDivUp(\\n        uint256 x,\\n        uint256 y,\\n        uint256 denominator\\n    ) internal pure returns (uint256 z) {\\n        assembly {\\n            // Store x * y in z for now.\\n            z := mul(x, y)\\n\\n            // Equivalent to require(denominator != 0 && (x == 0 || (x * y) / x == y))\\n            if iszero(and(iszero(iszero(denominator)), or(iszero(x), eq(div(z, x), y)))) {\\n                revert(0, 0)\\n            }\\n\\n            // First, divide z - 1 by the denominator and add 1.\\n            // We allow z - 1 to underflow if z is 0, because we multiply the\\n            // end result by 0 if z is zero, ensuring we return 0 if z is zero.\\n            z := mul(iszero(iszero(z)), add(div(sub(z, 1), denominator), 1))\\n        }\\n    }\\n\\n    function rpow(\\n        uint256 x,\\n        uint256 n,\\n        uint256 scalar\\n    ) internal pure returns (uint256 z) {\\n        assembly {\\n            switch x\\n            case 0 {\\n                switch n\\n                case 0 {\\n                    // 0 ** 0 = 1\\n                    z := scalar\\n                }\\n                default {\\n                    // 0 ** n = 0\\n                    z := 0\\n                }\\n            }\\n            default {\\n                switch mod(n, 2)\\n                case 0 {\\n                    // If n is even, store scalar in z for now.\\n                    z := scalar\\n                }\\n                default {\\n                    // If n is odd, store x in z for now.\\n                    z := x\\n                }\\n\\n                // Shifting right by 1 is like dividing by 2.\\n                let half := shr(1, scalar)\\n\\n                for {\\n                    // Shift n right by 1 before looping to halve it.\\n                    n := shr(1, n)\\n                } n {\\n                    // Shift n right by 1 each iteration to halve it.\\n                    n := shr(1, n)\\n                } {\\n                    // Revert immediately if x ** 2 would overflow.\\n                    // Equivalent to iszero(eq(div(xx, x), x)) here.\\n                    if shr(128, x) {\\n                        revert(0, 0)\\n                    }\\n\\n                    // Store x squared.\\n                    let xx := mul(x, x)\\n\\n                    // Round to the nearest number.\\n                    let xxRound := add(xx, half)\\n\\n                    // Revert if xx + half overflowed.\\n                    if lt(xxRound, xx) {\\n                        revert(0, 0)\\n                    }\\n\\n                    // Set x to scaled xxRound.\\n                    x := div(xxRound, scalar)\\n\\n                    // If n is even:\\n                    if mod(n, 2) {\\n                        // Compute z * x.\\n                        let zx := mul(z, x)\\n\\n                        // If z * x overflowed:\\n                        if iszero(eq(div(zx, x), z)) {\\n                            // Revert if x is non-zero.\\n                            if iszero(iszero(x)) {\\n                                revert(0, 0)\\n                            }\\n                        }\\n\\n                        // Round to the nearest number.\\n                        let zxRound := add(zx, half)\\n\\n                        // Revert if zx + half overflowed.\\n                        if lt(zxRound, zx) {\\n                            revert(0, 0)\\n                        }\\n\\n                        // Return properly scaled zxRound.\\n                        z := div(zxRound, scalar)\\n                    }\\n                }\\n            }\\n        }\\n    }\\n\\n    /*//////////////////////////////////////////////////////////////\\n                        GENERAL NUMBER UTILITIES\\n    //////////////////////////////////////////////////////////////*/\\n\\n    function sqrt(uint256 x) internal pure returns (uint256 z) {\\n        assembly {\\n            let y := x // We start y at x, which will help us make our initial estimate.\\n\\n            z := 181 // The \\\"correct\\\" value is 1, but this saves a multiplication later.\\n\\n            // This segment is to get a reasonable initial estimate for the Babylonian method. With a bad\\n            // start, the correct # of bits increases ~linearly each iteration instead of ~quadratically.\\n\\n            // We check y >= 2^(k + 8) but shift right by k bits\\n            // each branch to ensure that if x >= 256, then y >= 256.\\n            if iszero(lt(y, 0x10000000000000000000000000000000000)) {\\n                y := shr(128, y)\\n                z := shl(64, z)\\n            }\\n            if iszero(lt(y, 0x1000000000000000000)) {\\n                y := shr(64, y)\\n                z := shl(32, z)\\n            }\\n            if iszero(lt(y, 0x10000000000)) {\\n                y := shr(32, y)\\n                z := shl(16, z)\\n            }\\n            if iszero(lt(y, 0x1000000)) {\\n                y := shr(16, y)\\n                z := shl(8, z)\\n            }\\n\\n            // Goal was to get z*z*y within a small factor of x. More iterations could\\n            // get y in a tighter range. Currently, we will have y in [256, 256*2^16).\\n            // We ensured y >= 256 so that the relative difference between y and y+1 is small.\\n            // That's not possible if x < 256 but we can just verify those cases exhaustively.\\n\\n            // Now, z*z*y <= x < z*z*(y+1), and y <= 2^(16+8), and either y >= 256, or x < 256.\\n            // Correctness can be checked exhaustively for x < 256, so we assume y >= 256.\\n            // Then z*sqrt(y) is within sqrt(257)/sqrt(256) of sqrt(x), or about 20bps.\\n\\n            // For s in the range [1/256, 256], the estimate f(s) = (181/1024) * (s+1) is in the range\\n            // (1/2.84 * sqrt(s), 2.84 * sqrt(s)), with largest error when s = 1 and when s = 256 or 1/256.\\n\\n            // Since y is in [256, 256*2^16), let a = y/65536, so that a is in [1/256, 256). Then we can estimate\\n            // sqrt(y) using sqrt(65536) * 181/1024 * (a + 1) = 181/4 * (y + 65536)/65536 = 181 * (y + 65536)/2^18.\\n\\n            // There is no overflow risk here since y < 2^136 after the first branch above.\\n            z := shr(18, mul(z, add(y, 65536))) // A mul() is saved from starting z at 181.\\n\\n            // Given the worst case multiplicative error of 2.84 above, 7 iterations should be enough.\\n            z := shr(1, add(z, div(x, z)))\\n            z := shr(1, add(z, div(x, z)))\\n            z := shr(1, add(z, div(x, z)))\\n            z := shr(1, add(z, div(x, z)))\\n            z := shr(1, add(z, div(x, z)))\\n            z := shr(1, add(z, div(x, z)))\\n            z := shr(1, add(z, div(x, z)))\\n\\n            // If x+1 is a perfect square, the Babylonian method cycles between\\n            // floor(sqrt(x)) and ceil(sqrt(x)). This statement ensures we return floor.\\n            // See: https://en.wikipedia.org/wiki/Integer_square_root#Using_only_integer_division\\n            // Since the ceil is rare, we save gas on the assignment and repeat division in the rare case.\\n            // If you don't care whether the floor or ceil square root is returned, you can remove this statement.\\n            z := sub(z, lt(div(x, z), z))\\n        }\\n    }\\n\\n    function log2(uint256 x) internal pure returns (uint256 r) {\\n        require(x > 0, \\\"UNDEFINED\\\");\\n\\n        assembly {\\n            r := shl(7, lt(0xffffffffffffffffffffffffffffffff, x))\\n            r := or(r, shl(6, lt(0xffffffffffffffff, shr(r, x))))\\n            r := or(r, shl(5, lt(0xffffffff, shr(r, x))))\\n            r := or(r, shl(4, lt(0xffff, shr(r, x))))\\n            r := or(r, shl(3, lt(0xff, shr(r, x))))\\n            r := or(r, shl(2, lt(0xf, shr(r, x))))\\n            r := or(r, shl(1, lt(0x3, shr(r, x))))\\n            r := or(r, lt(0x1, shr(r, x)))\\n        }\\n    }\\n}\\n\",\"keccak256\":\"0x622fcd8a49e132df5ec7651cc6ae3aaf0cf59bdcd67a9a804a1b9e2485113b7d\",\"license\":\"MIT\"},\"@rari-capital/solmate/src/utils/ReentrancyGuard.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\npragma solidity >=0.8.0;\\n\\n/// @notice Gas optimized reentrancy protection for smart contracts.\\n/// @author Solmate (https://github.com/Rari-Capital/solmate/blob/main/src/utils/ReentrancyGuard.sol)\\n/// @author Modified from OpenZeppelin (https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/security/ReentrancyGuard.sol)\\nabstract contract ReentrancyGuard {\\n    uint256 private locked = 1;\\n\\n    modifier nonReentrant() virtual {\\n        require(locked == 1, \\\"REENTRANCY\\\");\\n\\n        locked = 2;\\n\\n        _;\\n\\n        locked = 1;\\n    }\\n}\\n\",\"keccak256\":\"0xa0e50a0f232da7f289430601ba927c315266b20ec739761430b0fde926fefe55\",\"license\":\"MIT\"},\"@rari-capital/solmate/src/utils/SafeTransferLib.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\npragma solidity >=0.8.0;\\n\\nimport {ERC20} from \\\"../tokens/ERC20.sol\\\";\\n\\n/// @notice Safe ETH and ERC20 transfer library that gracefully handles missing return values.\\n/// @author Solmate (https://github.com/Rari-Capital/solmate/blob/main/src/utils/SafeTransferLib.sol)\\n/// @dev Caution! This library won't check that a token has code, responsibility is delegated to the caller.\\nlibrary SafeTransferLib {\\n    /*//////////////////////////////////////////////////////////////\\n                             ETH OPERATIONS\\n    //////////////////////////////////////////////////////////////*/\\n\\n    function safeTransferETH(address to, uint256 amount) internal {\\n        bool success;\\n\\n        assembly {\\n            // Transfer the ETH and store if it succeeded or not.\\n            success := call(gas(), to, amount, 0, 0, 0, 0)\\n        }\\n\\n        require(success, \\\"ETH_TRANSFER_FAILED\\\");\\n    }\\n\\n    /*//////////////////////////////////////////////////////////////\\n                            ERC20 OPERATIONS\\n    //////////////////////////////////////////////////////////////*/\\n\\n    function safeTransferFrom(\\n        ERC20 token,\\n        address from,\\n        address to,\\n        uint256 amount\\n    ) internal {\\n        bool success;\\n\\n        assembly {\\n            // We'll write our calldata to this slot below, but restore it later.\\n            let memPointer := mload(0x40)\\n\\n            // Write the abi-encoded calldata into memory, beginning with the function selector.\\n            mstore(0, 0x23b872dd00000000000000000000000000000000000000000000000000000000)\\n            mstore(4, from) // Append the \\\"from\\\" argument.\\n            mstore(36, to) // Append the \\\"to\\\" argument.\\n            mstore(68, amount) // Append the \\\"amount\\\" argument.\\n\\n            success := and(\\n                // Set success to whether the call reverted, if not we check it either\\n                // returned exactly 1 (can't just be non-zero data), or had no return data.\\n                or(and(eq(mload(0), 1), gt(returndatasize(), 31)), iszero(returndatasize())),\\n                // We use 100 because that's the total length of our calldata (4 + 32 * 3)\\n                // Counterintuitively, this call() must be positioned after the or() in the\\n                // surrounding and() because and() evaluates its arguments from right to left.\\n                call(gas(), token, 0, 0, 100, 0, 32)\\n            )\\n\\n            mstore(0x60, 0) // Restore the zero slot to zero.\\n            mstore(0x40, memPointer) // Restore the memPointer.\\n        }\\n\\n        require(success, \\\"TRANSFER_FROM_FAILED\\\");\\n    }\\n\\n    function safeTransfer(\\n        ERC20 token,\\n        address to,\\n        uint256 amount\\n    ) internal {\\n        bool success;\\n\\n        assembly {\\n            // We'll write our calldata to this slot below, but restore it later.\\n            let memPointer := mload(0x40)\\n\\n            // Write the abi-encoded calldata into memory, beginning with the function selector.\\n            mstore(0, 0xa9059cbb00000000000000000000000000000000000000000000000000000000)\\n            mstore(4, to) // Append the \\\"to\\\" argument.\\n            mstore(36, amount) // Append the \\\"amount\\\" argument.\\n\\n            success := and(\\n                // Set success to whether the call reverted, if not we check it either\\n                // returned exactly 1 (can't just be non-zero data), or had no return data.\\n                or(and(eq(mload(0), 1), gt(returndatasize(), 31)), iszero(returndatasize())),\\n                // We use 68 because that's the total length of our calldata (4 + 32 * 2)\\n                // Counterintuitively, this call() must be positioned after the or() in the\\n                // surrounding and() because and() evaluates its arguments from right to left.\\n                call(gas(), token, 0, 0, 68, 0, 32)\\n            )\\n\\n            mstore(0x60, 0) // Restore the zero slot to zero.\\n            mstore(0x40, memPointer) // Restore the memPointer.\\n        }\\n\\n        require(success, \\\"TRANSFER_FAILED\\\");\\n    }\\n\\n    function safeApprove(\\n        ERC20 token,\\n        address to,\\n        uint256 amount\\n    ) internal {\\n        bool success;\\n\\n        assembly {\\n            // We'll write our calldata to this slot below, but restore it later.\\n            let memPointer := mload(0x40)\\n\\n            // Write the abi-encoded calldata into memory, beginning with the function selector.\\n            mstore(0, 0x095ea7b300000000000000000000000000000000000000000000000000000000)\\n            mstore(4, to) // Append the \\\"to\\\" argument.\\n            mstore(36, amount) // Append the \\\"amount\\\" argument.\\n\\n            success := and(\\n                // Set success to whether the call reverted, if not we check it either\\n                // returned exactly 1 (can't just be non-zero data), or had no return data.\\n                or(and(eq(mload(0), 1), gt(returndatasize(), 31)), iszero(returndatasize())),\\n                // We use 68 because that's the total length of our calldata (4 + 32 * 2)\\n                // Counterintuitively, this call() must be positioned after the or() in the\\n                // surrounding and() because and() evaluates its arguments from right to left.\\n                call(gas(), token, 0, 0, 68, 0, 32)\\n            )\\n\\n            mstore(0x60, 0) // Restore the zero slot to zero.\\n            mstore(0x40, memPointer) // Restore the memPointer.\\n        }\\n\\n        require(success, \\\"APPROVE_FAILED\\\");\\n    }\\n}\\n\",\"keccak256\":\"0x5f2e1158c68c1f3d15b80e8a7dd92b6849f873066969562ad33c0abb80e536ff\",\"license\":\"MIT\"},\"contracts/Auditor.sol\":{\"content\":\"// SPDX-License-Identifier: GPL-3.0-or-later\\npragma solidity 0.8.13;\\n\\nimport { AccessControl } from \\\"@openzeppelin/contracts/access/AccessControl.sol\\\";\\nimport { FixedPointMathLib } from \\\"@rari-capital/solmate/src/utils/FixedPointMathLib.sol\\\";\\nimport { FixedLender, NotFixedLender } from \\\"./FixedLender.sol\\\";\\nimport { ExactlyOracle } from \\\"./ExactlyOracle.sol\\\";\\nimport { PoolLib } from \\\"./utils/PoolLib.sol\\\";\\n\\ncontract Auditor is AccessControl {\\n  using FixedPointMathLib for uint256;\\n\\n  // Struct to avoid stack too deep\\n  struct AccountLiquidity {\\n    uint256 balance;\\n    uint256 borrowBalance;\\n    uint256 oraclePrice;\\n  }\\n\\n  // Struct for FixedLender's markets\\n  struct Market {\\n    uint128 adjustFactor;\\n    uint8 decimals;\\n    uint8 index;\\n    bool isListed;\\n  }\\n\\n  // Protocol Management\\n  mapping(address => uint256) public accountMarkets;\\n  mapping(FixedLender => Market) public markets;\\n\\n  uint256 public liquidationIncentive;\\n  FixedLender[] public allMarkets;\\n\\n  ExactlyOracle public oracle;\\n\\n  /// @notice Event emitted when a new market is listed for borrow/lending.\\n  /// @param fixedLender address of the fixedLender market that was listed.\\n  event MarketListed(FixedLender fixedLender, uint8 decimals);\\n\\n  /// @notice Event emitted when a user enters a market to use his deposit as collateral for a loan.\\n  /// @param fixedLender address of the market that the user entered.\\n  /// @param account address of the user that just entered a market.\\n  event MarketEntered(FixedLender indexed fixedLender, address indexed account);\\n\\n  /// @notice Event emitted when a user leaves a market. Means that they would stop using their deposit as collateral\\n  /// and won't ask for any loans in this market.\\n  /// @param fixedLender address of the market that the user just left.\\n  /// @param account address of the user that just left a market.\\n  event MarketExited(FixedLender indexed fixedLender, address indexed account);\\n\\n  /// @notice Event emitted when a new Oracle has been set.\\n  /// @param newOracle address of the new oracle that is used to calculate liquidity.\\n  event OracleSet(ExactlyOracle newOracle);\\n\\n  /// @notice Event emitted when a new liquidationIncentive has been set.\\n  /// @param newLiquidationIncentive represented with 1e18 decimals.\\n  event LiquidationIncentiveSet(uint256 newLiquidationIncentive);\\n\\n  /// @notice Event emitted when a adjust factor is changed by admin.\\n  /// @param fixedLender address of the market that has a new adjust factor.\\n  /// @param newAdjustFactor adjust factor for the underlying asset.\\n  event AdjustFactorSet(FixedLender indexed fixedLender, uint256 newAdjustFactor);\\n\\n  constructor(ExactlyOracle oracle_, uint256 liquidationIncentive_) {\\n    _grantRole(DEFAULT_ADMIN_ROLE, msg.sender);\\n\\n    setOracle(oracle_);\\n    setLiquidationIncentive(liquidationIncentive_);\\n  }\\n\\n  /// @notice Allows assets of a certain `fixedLender` market to be used as collateral for borrowing other assets.\\n  /// @param fixedLender market to enable as collateral for `msg.sender`.\\n  function enterMarket(FixedLender fixedLender) external {\\n    validateMarketListed(fixedLender);\\n    uint256 marketIndex = markets[fixedLender].index;\\n\\n    uint256 marketMap = accountMarkets[msg.sender];\\n\\n    if ((marketMap & (1 << marketIndex)) != 0) return;\\n    accountMarkets[msg.sender] = marketMap | (1 << marketIndex);\\n\\n    emit MarketEntered(fixedLender, msg.sender);\\n  }\\n\\n  /// @notice Removes fixedLender from sender's account liquidity calculation.\\n  /// @dev Sender must not have an outstanding borrow balance in the asset, or be providing necessary collateral\\n  /// for an outstanding borrow.\\n  /// @param fixedLender The address of the asset to be removed.\\n  function exitMarket(FixedLender fixedLender) external {\\n    validateMarketListed(fixedLender);\\n    uint256 marketIndex = markets[fixedLender].index;\\n\\n    (uint256 amountHeld, uint256 borrowBalance) = fixedLender.getAccountSnapshot(msg.sender, PoolLib.MATURITY_ALL);\\n\\n    // Fail if the sender has a borrow balance\\n    if (borrowBalance != 0) revert BalanceOwed();\\n\\n    // Fail if the sender is not permitted to redeem all of their tokens\\n    validateAccountShortfall(fixedLender, msg.sender, amountHeld);\\n\\n    uint256 marketMap = accountMarkets[msg.sender];\\n\\n    if ((marketMap & (1 << marketIndex)) == 0) return;\\n    accountMarkets[msg.sender] = marketMap & ~(1 << marketIndex);\\n\\n    emit MarketExited(fixedLender, msg.sender);\\n  }\\n\\n  /// @notice Sets Oracle's to be used.\\n  /// @param _priceOracle address of the new oracle.\\n  function setOracle(ExactlyOracle _priceOracle) public onlyRole(DEFAULT_ADMIN_ROLE) {\\n    oracle = _priceOracle;\\n    emit OracleSet(_priceOracle);\\n  }\\n\\n  /// @notice Sets liquidation incentive for the whole ecosystem.\\n  /// @dev Value can only be set between 20% and 5%.\\n  /// @param _liquidationIncentive new liquidation incentive. It's a factor, so 15% would be 1.15e18.\\n  function setLiquidationIncentive(uint256 _liquidationIncentive) public onlyRole(DEFAULT_ADMIN_ROLE) {\\n    if (_liquidationIncentive > 1.2e18 || _liquidationIncentive < 1.05e18) revert InvalidParameter();\\n    liquidationIncentive = _liquidationIncentive;\\n    emit LiquidationIncentiveSet(_liquidationIncentive);\\n  }\\n\\n  /// @notice Enables a certain FixedLender market.\\n  /// @dev Enabling more than 256 markets will cause an overflow when casting market index to uint8.\\n  /// @param fixedLender address to add to the protocol.\\n  /// @param adjustFactor fixedLender's adjust factor for the underlying asset.\\n  /// @param decimals decimals of the market's underlying asset.\\n  function enableMarket(\\n    FixedLender fixedLender,\\n    uint128 adjustFactor,\\n    uint8 decimals\\n  ) external onlyRole(DEFAULT_ADMIN_ROLE) {\\n    if (fixedLender.auditor() != this) revert AuditorMismatch();\\n\\n    if (markets[fixedLender].isListed) revert MarketAlreadyListed();\\n\\n    markets[fixedLender] = Market({\\n      isListed: true,\\n      adjustFactor: adjustFactor,\\n      decimals: decimals,\\n      index: uint8(allMarkets.length)\\n    });\\n\\n    allMarkets.push(fixedLender);\\n\\n    emit MarketListed(fixedLender, decimals);\\n    setAdjustFactor(fixedLender, adjustFactor);\\n  }\\n\\n  /// @notice Sets the adjust factor for a certain fixedLender.\\n  /// @dev Market should be listed and value can only be set between 90% and 30%.\\n  /// @param fixedLender address of the market to change adjust factor for.\\n  /// @param adjustFactor adjust factor for the underlying asset.\\n  function setAdjustFactor(FixedLender fixedLender, uint128 adjustFactor) public onlyRole(DEFAULT_ADMIN_ROLE) {\\n    validateMarketListed(fixedLender);\\n    if (adjustFactor > 0.9e18 || adjustFactor < 0.3e18) revert InvalidParameter();\\n    markets[fixedLender].adjustFactor = adjustFactor;\\n    emit AdjustFactorSet(fixedLender, adjustFactor);\\n  }\\n\\n  /// @notice Validates that the current state of the position and system are valid (liquidity).\\n  /// @dev Hook function to be called after calling the poolAccounting borrowMP function.\\n  /// @param fixedLender address of the fixedLender that will lend money in a maturity.\\n  /// @param borrower address of the user that will borrow money from a maturity date.\\n  function validateBorrowMP(FixedLender fixedLender, address borrower) external {\\n    validateMarketListed(fixedLender);\\n    uint256 marketIndex = markets[fixedLender].index;\\n    uint256 marketMap = accountMarkets[borrower];\\n\\n    // we validate borrow state\\n    if ((marketMap & (1 << marketIndex)) == 0) {\\n      // only fixedLenders may call validateBorrowMP if borrower not in market\\n      if (msg.sender != address(fixedLender)) revert NotFixedLender();\\n\\n      accountMarkets[borrower] = marketMap | (1 << marketIndex);\\n      emit MarketEntered(fixedLender, borrower);\\n\\n      // it should be impossible to break this invariant\\n      assert((accountMarkets[borrower] & (1 << marketIndex)) != 0);\\n    }\\n\\n    // We verify that current liquidity is not short\\n    (uint256 collateral, uint256 debt) = accountLiquidity(borrower, fixedLender, 0);\\n\\n    if (collateral < debt) revert InsufficientLiquidity();\\n  }\\n\\n  /// @notice Allows/rejects liquidation of assets.\\n  /// @dev This function can be called externally, but only will have effect when called from a fixedLender.\\n  /// @param fixedLenderBorrowed market from where the debt is pending.\\n  /// @param fixedLenderCollateral market where the assets will be liquidated (should be msg.sender on FixedLender.sol).\\n  /// @param liquidator address that is liquidating the assets.\\n  /// @param borrower address which the assets are being liquidated.\\n  function liquidateAllowed(\\n    FixedLender fixedLenderBorrowed,\\n    FixedLender fixedLenderCollateral,\\n    address liquidator,\\n    address borrower\\n  ) external view {\\n    if (borrower == liquidator) revert LiquidatorNotBorrower();\\n\\n    // if markets are listed, they have the same auditor\\n    if (!markets[fixedLenderBorrowed].isListed || !markets[fixedLenderCollateral].isListed) revert MarketNotListed();\\n\\n    // The borrower must have shortfall in order to be liquidatable\\n    (uint256 sumCollateral, uint256 sumDebt) = accountLiquidity(borrower, FixedLender(address(0)), 0);\\n\\n    if (sumCollateral >= sumDebt) revert InsufficientShortfall();\\n  }\\n\\n  /// @notice Allow/rejects seizing of assets.\\n  /// @dev This function can be called externally, but only will have effect when called from a fixedLender.\\n  /// @param fixedLenderCollateral market where the assets will be seized (should be msg.sender on FixedLender.sol).\\n  /// @param fixedLenderBorrowed market from where the debt will be paid.\\n  /// @param liquidator address to validate where the seized assets will be received.\\n  /// @param borrower address to validate where the assets will be removed.\\n  function seizeAllowed(\\n    FixedLender fixedLenderCollateral,\\n    FixedLender fixedLenderBorrowed,\\n    address liquidator,\\n    address borrower\\n  ) external view {\\n    if (borrower == liquidator) revert LiquidatorNotBorrower();\\n\\n    // If markets are listed, they have also the same Auditor\\n    if (!markets[fixedLenderCollateral].isListed || !markets[fixedLenderBorrowed].isListed) revert MarketNotListed();\\n  }\\n\\n  /// @notice Calculates the amount of collateral to be seized when a position is undercollaterized.\\n  /// @param fixedLenderBorrowed market from where the debt is pending.\\n  /// @param fixedLenderCollateral market where the assets will be liquidated (should be msg.sender on FixedLender.sol).\\n  /// @param actualRepayAmount repay amount in the borrowed asset.\\n  /// @return amount of collateral to be seized.\\n  function liquidateCalculateSeizeAmount(\\n    FixedLender fixedLenderBorrowed,\\n    FixedLender fixedLenderCollateral,\\n    uint256 actualRepayAmount\\n  ) external view returns (uint256) {\\n    // Read oracle prices for borrowed and collateral markets\\n    uint256 priceBorrowed = oracle.getAssetPrice(fixedLenderBorrowed);\\n    uint256 priceCollateral = oracle.getAssetPrice(fixedLenderCollateral);\\n\\n    uint256 amountInUSD = actualRepayAmount.mulDivDown(priceBorrowed, 10**markets[fixedLenderBorrowed].decimals);\\n    // 10**18: usd amount decimals\\n    uint256 seizeTokens = amountInUSD.mulDivDown(10**markets[fixedLenderCollateral].decimals, priceCollateral);\\n\\n    return seizeTokens.mulWadDown(liquidationIncentive);\\n  }\\n\\n  /// @notice Retrieves all markets.\\n  function getAllMarkets() external view returns (FixedLender[] memory) {\\n    return allMarkets;\\n  }\\n\\n  /// @notice Checks if the user has an account liquidity shortfall\\n  /// @dev This function is called indirectly from fixedLender contracts(withdraw), eToken transfers and directly from\\n  /// this contract when the user wants to exit a market.\\n  /// @param fixedLender address of the fixedLender where the smart pool belongs.\\n  /// @param account address of the user to check for possible shortfall.\\n  /// @param amount amount that the user wants to withdraw or transfer.\\n  function validateAccountShortfall(\\n    FixedLender fixedLender,\\n    address account,\\n    uint256 amount\\n  ) public view {\\n    // If the user is not 'in' the market, then we can bypass the liquidity check\\n    if ((accountMarkets[account] & (1 << markets[fixedLender].index)) == 0) return;\\n\\n    // Otherwise, perform a hypothetical liquidity check to guard against shortfall\\n    (uint256 collateral, uint256 debt) = accountLiquidity(account, fixedLender, amount);\\n    if (collateral < debt) revert InsufficientLiquidity();\\n  }\\n\\n  /// @notice Returns account's liquidity for a certain market/maturity pool.\\n  /// @param account wallet which the liquidity will be calculated.\\n  /// @param fixedLenderToSimulate fixedLender in which we want to simulate withdraw/borrow ops (see next two args).\\n  /// @param withdrawAmount amount to simulate withdraw.\\n  /// @return sumCollateral sum of all collateral, already multiplied by each adjust factor. denominated in usd.\\n  /// @return sumDebt sum of all debt. denominated in usd.\\n  function accountLiquidity(\\n    address account,\\n    FixedLender fixedLenderToSimulate,\\n    uint256 withdrawAmount\\n  ) public view returns (uint256 sumCollateral, uint256 sumDebt) {\\n    AccountLiquidity memory vars; // Holds all our calculation results\\n\\n    // For each asset the account is in\\n    uint256 marketMap = accountMarkets[account];\\n    uint256 maxValue = allMarkets.length;\\n    for (uint256 i = 0; i < maxValue; ) {\\n      if ((marketMap & (1 << i)) != 0) {\\n        FixedLender market = allMarkets[i];\\n        uint256 decimals = markets[market].decimals;\\n        uint256 adjustFactor = markets[market].adjustFactor;\\n\\n        // Read the balances\\n        (vars.balance, vars.borrowBalance) = market.getAccountSnapshot(account, PoolLib.MATURITY_ALL);\\n\\n        // Get the normalized price of the asset (18 decimals)\\n        vars.oraclePrice = oracle.getAssetPrice(market);\\n\\n        // We sum all the collateral prices\\n        sumCollateral += vars.balance.mulDivDown(vars.oraclePrice, 10**decimals).mulWadDown(adjustFactor);\\n\\n        // We sum all the debt\\n        sumDebt += vars.borrowBalance.mulDivDown(vars.oraclePrice, 10**decimals);\\n\\n        // Simulate the effects of borrowing from/lending to a pool\\n        if (market == FixedLender(fixedLenderToSimulate)) {\\n          // Calculate the effects of redeeming fixedLenders\\n          // (having less collateral is the same as having more debt for this calculation)\\n          if (withdrawAmount != 0) {\\n            sumDebt += withdrawAmount.mulDivDown(vars.oraclePrice, 10**decimals).mulWadDown(adjustFactor);\\n          }\\n        }\\n      }\\n      unchecked {\\n        ++i;\\n      }\\n      if ((1 << i) > marketMap) break;\\n    }\\n  }\\n\\n  /// @notice Verifies if market is listed as valid.\\n  /// @param fixedLender address of the fixedLender to be validated by the auditor.\\n  function validateMarketListed(FixedLender fixedLender) internal view {\\n    if (!markets[fixedLender].isListed) revert MarketNotListed();\\n  }\\n}\\n\\nerror AuditorMismatch();\\nerror BalanceOwed();\\nerror InsufficientLiquidity();\\nerror InsufficientShortfall();\\nerror InvalidParameter();\\nerror LiquidatorNotBorrower();\\nerror MarketAlreadyListed();\\nerror MarketNotListed();\\n\",\"keccak256\":\"0x13543f8106b55bb7cd31d73d24832ec4468e8c737501ea6ce1e2061577196e36\",\"license\":\"GPL-3.0-or-later\"},\"contracts/ExactlyOracle.sol\":{\"content\":\"// SPDX-License-Identifier: GPL-3.0-or-later\\npragma solidity 0.8.13;\\n\\nimport { AccessControl } from \\\"@openzeppelin/contracts/access/AccessControl.sol\\\";\\nimport { AggregatorV3Interface } from \\\"@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol\\\";\\nimport { FixedLender } from \\\"./FixedLender.sol\\\";\\n\\n/// @title ExactlyOracle\\n/// @notice Proxy to get the price of an asset from a price source (Chainlink Price Feed Aggregator).\\ncontract ExactlyOracle is AccessControl {\\n  /// @notice Auditor's target precision.\\n  uint256 public constant TARGET_DECIMALS = 18;\\n  /// @notice Chainlink's Price Feed precision when using USD as the base currency.\\n  uint256 public constant ORACLE_DECIMALS = 8;\\n\\n  mapping(FixedLender => AggregatorV3Interface) public assetsSources;\\n  uint256 public immutable priceExpiration;\\n\\n  /// @notice Emitted when a FixedLender and source is changed by admin.\\n  /// @param fixedLender address of the asset used to get the price from this oracle.\\n  /// @param source address of Chainlink's Price Feed aggregator used to query the asset price in USD.\\n  event AssetSourceSet(FixedLender indexed fixedLender, AggregatorV3Interface indexed source);\\n\\n  /// @notice Constructor.\\n  /// @param priceExpiration_ The max delay time for Chainlink's prices to be considered as updated.\\n  constructor(uint256 priceExpiration_) {\\n    _grantRole(DEFAULT_ADMIN_ROLE, msg.sender);\\n\\n    priceExpiration = priceExpiration_;\\n  }\\n\\n  /// @notice Sets the Chainlink Price Feed Aggregator source for an asset.\\n  /// @param fixedLender The FixedLender address of the asset.\\n  /// @param source address of Chainlink's Price Feed aggregator used to query the asset price in USD.\\n  function setAssetSource(FixedLender fixedLender, AggregatorV3Interface source) external onlyRole(DEFAULT_ADMIN_ROLE) {\\n    if (source.decimals() != ORACLE_DECIMALS) revert InvalidSource();\\n    assetsSources[fixedLender] = source;\\n    emit AssetSourceSet(fixedLender, source);\\n  }\\n\\n  /// @notice Gets an asset price by FixedLender.\\n  /// @dev If Chainlink's asset price is <= 0 or the updatedAt time is outdated the call is reverted.\\n  /// @param fixedLender The FixedLender address of the asset.\\n  /// @return The price of the asset scaled to 18-digit decimals.\\n  function getAssetPrice(FixedLender fixedLender) public view returns (uint256) {\\n    (, int256 price, , uint256 updatedAt, ) = assetsSources[fixedLender].latestRoundData();\\n    if (price > 0 && updatedAt >= block.timestamp - priceExpiration) return scaleOraclePriceByDigits(uint256(price));\\n    else revert InvalidPrice();\\n  }\\n\\n  /// @notice Scale the price returned by the oracle to an 18-digit decimal to be used by the Auditor.\\n  /// @param price The price to be scaled.\\n  /// @return The price of the asset scaled to 18-digit decimals.\\n  function scaleOraclePriceByDigits(uint256 price) internal pure returns (uint256) {\\n    return price * 10**(TARGET_DECIMALS - ORACLE_DECIMALS);\\n  }\\n}\\n\\nerror InvalidPrice();\\nerror InvalidSource();\\n\",\"keccak256\":\"0xb94a43b8c33c1c21bfbaa927add7d28db3387d20577788bee1428f22b5df656e\",\"license\":\"GPL-3.0-or-later\"},\"contracts/FixedLender.sol\":{\"content\":\"// SPDX-License-Identifier: GPL-3.0-or-later\\npragma solidity 0.8.13;\\n\\nimport { Math } from \\\"@openzeppelin/contracts/utils/math/Math.sol\\\";\\nimport { Pausable } from \\\"@openzeppelin/contracts/security/Pausable.sol\\\";\\nimport { AccessControl } from \\\"@openzeppelin/contracts/access/AccessControl.sol\\\";\\nimport { ReentrancyGuard } from \\\"@rari-capital/solmate/src/utils/ReentrancyGuard.sol\\\";\\nimport { FixedPointMathLib } from \\\"@rari-capital/solmate/src/utils/FixedPointMathLib.sol\\\";\\nimport { ERC4626, ERC20, SafeTransferLib } from \\\"@rari-capital/solmate/src/mixins/ERC4626.sol\\\";\\nimport { PoolLib, InsufficientProtocolLiquidity } from \\\"./utils/PoolLib.sol\\\";\\nimport { Auditor, InvalidParameter } from \\\"./Auditor.sol\\\";\\nimport { InterestRateModel } from \\\"./InterestRateModel.sol\\\";\\nimport { PoolAccounting } from \\\"./PoolAccounting.sol\\\";\\nimport { TSUtils } from \\\"./utils/TSUtils.sol\\\";\\n\\ncontract FixedLender is ERC4626, AccessControl, PoolAccounting, ReentrancyGuard, Pausable {\\n  using FixedPointMathLib for uint256;\\n  using FixedPointMathLib for uint128;\\n  using SafeTransferLib for ERC20;\\n\\n  bytes32 public constant PAUSER_ROLE = keccak256(\\\"PAUSER_ROLE\\\");\\n  uint256 public constant CLOSE_FACTOR = 5e17;\\n\\n  Auditor public immutable auditor;\\n\\n  uint8 public maxFuturePools;\\n  uint32 public lastAccumulatedEarningsAccrual;\\n  uint128 public accumulatedEarningsSmoothFactor;\\n\\n  uint256 public smartPoolAssets;\\n\\n  /// @notice Event emitted when a user deposits an amount of an asset to a certain maturity date collecting a fee at\\n  /// the end of the period.\\n  /// @param maturity maturity in which the user will be able to collect his deposit + his fee.\\n  /// @param caller address which deposited the assets.\\n  /// @param owner address that will be able to withdraw the deposited assets.\\n  /// @param assets amount of the asset that were deposited.\\n  /// @param fee is the extra amount that it will be collected at maturity.\\n  event DepositAtMaturity(\\n    uint256 indexed maturity,\\n    address indexed caller,\\n    address indexed owner,\\n    uint256 assets,\\n    uint256 fee\\n  );\\n\\n  /// @notice Event emitted when a user collects its deposits after maturity.\\n  /// @param maturity maturity where the user collected its deposits.\\n  /// @param caller address which withdraw the asset.\\n  /// @param receiver address which will be collecting the assets.\\n  /// @param owner address which had the assets withdrawn.\\n  /// @param assets amount of the asset that were withdrawn.\\n  /// @param assetsDiscounted amount of the asset that were deposited (in case of early withdrawal).\\n  event WithdrawAtMaturity(\\n    uint256 indexed maturity,\\n    address caller,\\n    address indexed receiver,\\n    address indexed owner,\\n    uint256 assets,\\n    uint256 assetsDiscounted\\n  );\\n\\n  /// @notice Event emitted when a user borrows amount of an asset from a certain maturity date.\\n  /// @param maturity maturity in which the user will have to repay the loan.\\n  /// @param caller address which borrowed the asset.\\n  /// @param receiver address that received the borrowed assets.\\n  /// @param borrower address which will be repaying the borrowed assets.\\n  /// @param assets amount of the asset that were borrowed.\\n  /// @param fee extra amount that will need to be paid at maturity.\\n  event BorrowAtMaturity(\\n    uint256 indexed maturity,\\n    address caller,\\n    address indexed receiver,\\n    address indexed borrower,\\n    uint256 assets,\\n    uint256 fee\\n  );\\n\\n  /// @notice Event emitted when a user repays its borrows after maturity.\\n  /// @param maturity maturity where the user repaid its borrowed amounts.\\n  /// @param caller address which repaid the previously borrowed amount.\\n  /// @param borrower address which had the original debt.\\n  /// @param assets amount that was repaid.\\n  /// @param positionAssets amount of the debt that was covered in this repayment (penalties could have been repaid).\\n  event RepayAtMaturity(\\n    uint256 indexed maturity,\\n    address indexed caller,\\n    address indexed borrower,\\n    uint256 assets,\\n    uint256 positionAssets\\n  );\\n\\n  /// @notice Event emitted when a user's position had a liquidation.\\n  /// @param receiver address which repaid the previously borrowed amount.\\n  /// @param borrower address which had the original debt.\\n  /// @param assets amount of the asset that were repaid.\\n  /// @param collateralFixedLender address of the asset that were seized by the liquidator.\\n  /// @param seizedAssets amount seized of the collateral.\\n  event LiquidateBorrow(\\n    address indexed receiver,\\n    address indexed borrower,\\n    uint256 assets,\\n    FixedLender indexed collateralFixedLender,\\n    uint256 seizedAssets\\n  );\\n\\n  /// @notice Event emitted when a user's collateral has been seized.\\n  /// @param liquidator address which seized this collateral.\\n  /// @param borrower address which had the original debt.\\n  /// @param assets amount seized of the collateral.\\n  event AssetSeized(address indexed liquidator, address indexed borrower, uint256 assets);\\n\\n  /// @notice Event emitted when earnings are accrued to the smart pool.\\n  /// @param previousAssets previous balance of the smart pool, denominated in assets (underlying).\\n  /// @param earnings new smart pool earnings, denominated in assets (underlying).\\n  event SmartPoolEarningsAccrued(uint256 previousAssets, uint256 earnings);\\n\\n  /// @notice Event emitted when the accumulatedEarningsSmoothFactor is changed by admin.\\n  /// @param newAccumulatedEarningsSmoothFactor factor represented with 1e18 decimals.\\n  event AccumulatedEarningsSmoothFactorSet(uint128 newAccumulatedEarningsSmoothFactor);\\n\\n  /// @notice Event emitted when the maxFuturePools is changed by admin.\\n  /// @param newMaxFuturePools represented with 0 decimals.\\n  event MaxFuturePoolsSet(uint256 newMaxFuturePools);\\n\\n  constructor(\\n    ERC20 asset_,\\n    uint8 maxFuturePools_,\\n    uint128 accumulatedEarningsSmoothFactor_,\\n    Auditor auditor_,\\n    InterestRateModel interestRateModel_,\\n    uint256 penaltyRate_,\\n    uint256 smartPoolReserveFactor_,\\n    DampSpeed memory dampSpeed_\\n  )\\n    ERC4626(asset_, string(abi.encodePacked(\\\"EToken\\\", asset_.symbol())), string(abi.encodePacked(\\\"e\\\", asset_.symbol())))\\n    PoolAccounting(interestRateModel_, penaltyRate_, smartPoolReserveFactor_, dampSpeed_)\\n  {\\n    _grantRole(DEFAULT_ADMIN_ROLE, msg.sender);\\n\\n    auditor = auditor_;\\n    setMaxFuturePools(maxFuturePools_);\\n    setAccumulatedEarningsSmoothFactor(accumulatedEarningsSmoothFactor_);\\n  }\\n\\n  /// @notice Calculates the smart pool balance plus earnings to be accrued at current timestamp\\n  /// from maturities and accumulator.\\n  /// @return actual smartPoolAssets plus earnings to be accrued at current timestamp.\\n  function totalAssets() public view override returns (uint256) {\\n    unchecked {\\n      uint256 memMaxFuturePools = maxFuturePools;\\n      uint256 smartPoolEarnings = 0;\\n\\n      uint256 lastAccrual;\\n      uint256 unassignedEarnings;\\n      uint256 latestMaturity = block.timestamp - (block.timestamp % TSUtils.INTERVAL);\\n      uint256 maxMaturity = latestMaturity + memMaxFuturePools * TSUtils.INTERVAL;\\n\\n      assembly {\\n        mstore(0x20, maturityPools.slot) // hashing scratch space, second word for storage location hashing\\n      }\\n\\n      for (uint256 maturity = latestMaturity; maturity <= maxMaturity; maturity += TSUtils.INTERVAL) {\\n        assembly {\\n          mstore(0x00, maturity) // hashing scratch space, first word for storage location hashing\\n          let location := keccak256(0x00, 0x40) // struct storage location: keccak256([maturity, maturityPools.slot])\\n          unassignedEarnings := sload(add(location, 2)) // third word\\n          lastAccrual := sload(add(location, 3)) // forth word\\n        }\\n\\n        if (maturity > lastAccrual) {\\n          smartPoolEarnings += unassignedEarnings.mulDivDown(block.timestamp - lastAccrual, maturity - lastAccrual);\\n        }\\n      }\\n\\n      return smartPoolAssets + smartPoolEarnings + smartPoolAccumulatedEarnings();\\n    }\\n  }\\n\\n  /// @notice Withdraws the owner's smart pool assets to the receiver address.\\n  /// @dev Makes sure that the owner doesn't have shortfall after withdrawing.\\n  /// @param assets amount of underlying to be withdrawn.\\n  /// @param receiver address to which the assets will be transferred.\\n  /// @param owner address which owns the smart pool assets.\\n  function withdraw(\\n    uint256 assets,\\n    address receiver,\\n    address owner\\n  ) public override returns (uint256) {\\n    auditor.validateAccountShortfall(this, owner, assets);\\n    return super.withdraw(assets, receiver, owner);\\n  }\\n\\n  /// @notice Redeems the owner's smart pool assets to the receiver address.\\n  /// @dev Makes sure that the owner doesn't have shortfall after withdrawing.\\n  /// @param shares amount of shares to be redeemed for underlying asset.\\n  /// @param receiver address to which the assets will be transferred.\\n  /// @param owner address which owns the smart pool assets.\\n  function redeem(\\n    uint256 shares,\\n    address receiver,\\n    address owner\\n  ) public override returns (uint256) {\\n    auditor.validateAccountShortfall(this, owner, previewMint(shares));\\n    return super.redeem(shares, receiver, owner);\\n  }\\n\\n  /// @notice Hook to update the smart pool average, smart pool balance and distribute earnings from accumulator.\\n  /// @param assets amount of assets to be withdrawn from the smart pool.\\n  function beforeWithdraw(uint256 assets, uint256) internal override {\\n    uint256 memSPAssets = smartPoolAssets;\\n    updateSmartPoolAssetsAverage(memSPAssets);\\n    uint256 earnings = smartPoolAccumulatedEarnings();\\n    lastAccumulatedEarningsAccrual = uint32(block.timestamp);\\n    smartPoolEarningsAccumulator -= earnings;\\n    emit SmartPoolEarningsAccrued(memSPAssets, earnings);\\n    memSPAssets = memSPAssets + earnings - assets;\\n    smartPoolAssets = memSPAssets;\\n    // we check if the underlying liquidity that the user wants to withdraw is borrowed\\n    if (memSPAssets < smartPoolBorrowed) revert InsufficientProtocolLiquidity();\\n  }\\n\\n  /// @notice Hook to update the smart pool average, smart pool balance and distribute earnings from accumulator.\\n  /// @param assets amount of assets to be deposited to the smart pool.\\n  function afterDeposit(uint256 assets, uint256) internal virtual override whenNotPaused {\\n    uint256 memSPAssets = smartPoolAssets;\\n    updateSmartPoolAssetsAverage(memSPAssets);\\n    uint256 earnings = smartPoolAccumulatedEarnings();\\n    lastAccumulatedEarningsAccrual = uint32(block.timestamp);\\n    smartPoolEarningsAccumulator -= earnings;\\n    emit SmartPoolEarningsAccrued(memSPAssets, earnings);\\n    smartPoolAssets = memSPAssets + earnings + assets;\\n  }\\n\\n  /// @notice Calculates the earnings to be distributed from the accumulator given the current timestamp.\\n  /// @return earnings to be distributed from the accumulator.\\n  function smartPoolAccumulatedEarnings() internal view returns (uint256 earnings) {\\n    uint256 elapsed = block.timestamp - lastAccumulatedEarningsAccrual;\\n    if (elapsed == 0) return 0;\\n    earnings = smartPoolEarningsAccumulator.mulDivDown(\\n      elapsed,\\n      elapsed + accumulatedEarningsSmoothFactor.mulWadDown(maxFuturePools * TSUtils.INTERVAL)\\n    );\\n  }\\n\\n  /// @notice Moves amount of shares from the caller's account to `to`.\\n  /// @dev It's expected that this function can't be paused to prevent freezing user funds.\\n  /// Makes sure that the caller doesn't have shortfall after transferring.\\n  /// @param to address to which the tokens will be transferred.\\n  /// @param shares amount of tokens.\\n  function transfer(address to, uint256 shares) public virtual override returns (bool) {\\n    auditor.validateAccountShortfall(this, msg.sender, previewMint(shares));\\n    return super.transfer(to, shares);\\n  }\\n\\n  /// @notice Moves amount of shares from `from` to `to` using the allowance mechanism.\\n  /// @dev It's expected that this function can't be paused to prevent freezing user funds.\\n  /// Makes sure that `from` address doesn't have shortfall after transferring.\\n  /// @param from address from which the tokens will be transferred.\\n  /// @param to address to which the tokens will be transferred.\\n  /// @param shares amount of tokens.\\n  function transferFrom(\\n    address from,\\n    address to,\\n    uint256 shares\\n  ) public virtual override returns (bool) {\\n    auditor.validateAccountShortfall(this, from, previewMint(shares));\\n    return super.transferFrom(from, to, shares);\\n  }\\n\\n  /// @notice Sets the protocol's max future pools for borrowing and lending.\\n  /// @dev Value can not be 0 or higher than 224.\\n  /// Value shouldn't be lower than previous value or VALID maturities will become NOT_READY.\\n  /// @param futurePools number of pools to be active at the same time.\\n  function setMaxFuturePools(uint8 futurePools) public onlyRole(DEFAULT_ADMIN_ROLE) {\\n    if (futurePools > 224 || futurePools == 0) revert InvalidParameter();\\n    maxFuturePools = futurePools;\\n    emit MaxFuturePoolsSet(futurePools);\\n  }\\n\\n  /// @notice Sets the factor used when smoothly accruing earnings to the smart pool.\\n  /// @dev Value can only be lower than 4. If set at 0, then all remaining accumulated earnings are\\n  /// distributed in following operation to the smart pool.\\n  /// @param accumulatedEarningsSmoothFactor_ represented with 18 decimals.\\n  function setAccumulatedEarningsSmoothFactor(uint128 accumulatedEarningsSmoothFactor_)\\n    public\\n    onlyRole(DEFAULT_ADMIN_ROLE)\\n  {\\n    if (accumulatedEarningsSmoothFactor_ > 4e18) revert InvalidParameter();\\n    accumulatedEarningsSmoothFactor = accumulatedEarningsSmoothFactor_;\\n    emit AccumulatedEarningsSmoothFactorSet(accumulatedEarningsSmoothFactor_);\\n  }\\n\\n  /// @notice Sets the _pause state to true in case of emergency, triggered by an authorized account.\\n  function pause() external onlyRole(PAUSER_ROLE) {\\n    _pause();\\n  }\\n\\n  /// @notice Sets the _pause state to false when threat is gone, triggered by an authorized account.\\n  function unpause() external onlyRole(PAUSER_ROLE) {\\n    _unpause();\\n  }\\n\\n  /// @notice Liquidates uncollaterized position(s).\\n  /// @dev Msg.sender liquidates borrower's position(s) and repays a certain amount of debt for multiple maturities,\\n  /// seizing a part of borrower's collateral.\\n  /// @param borrower wallet that has an outstanding debt across all maturities.\\n  /// @param positionAssets amount of debt to be covered by liquidator(msg.sender).\\n  /// @param maxAssetsAllowed maximum amount of debt that the liquidator is willing to accept.\\n  /// @param collateralFixedLender fixedLender from which the collateral will be seized to give the liquidator.\\n  function liquidate(\\n    address borrower,\\n    uint256 positionAssets,\\n    uint256 maxAssetsAllowed,\\n    FixedLender collateralFixedLender\\n  ) external nonReentrant whenNotPaused returns (uint256 repaidAssets) {\\n    // reverts on failure\\n    auditor.liquidateAllowed(this, collateralFixedLender, msg.sender, borrower);\\n\\n    (uint256 sumBorrows, ) = getAccountBorrows(borrower, PoolLib.MATURITY_ALL);\\n    positionAssets = Math.min(positionAssets, CLOSE_FACTOR.mulWadDown(sumBorrows));\\n\\n    uint256 encodedMaturities = userMpBorrowed[borrower];\\n    uint256 baseMaturity = encodedMaturities % (1 << 32);\\n    uint256 packedMaturities = encodedMaturities >> 32;\\n    for (uint224 i = 0; i < 224; ) {\\n      if ((packedMaturities & (1 << i)) != 0) {\\n        (uint256 actualRepay, uint256 coveredDebt) = noTransferRepay(\\n          baseMaturity + (i * TSUtils.INTERVAL),\\n          positionAssets,\\n          maxAssetsAllowed,\\n          borrower\\n        );\\n        repaidAssets += actualRepay;\\n        positionAssets -= coveredDebt;\\n        maxAssetsAllowed -= actualRepay;\\n      }\\n      if (positionAssets == 0) break;\\n      unchecked {\\n        ++i;\\n      }\\n      if ((1 << i) > packedMaturities) break;\\n    }\\n\\n    // reverts on failure\\n    uint256 seizeTokens = auditor.liquidateCalculateSeizeAmount(this, collateralFixedLender, repaidAssets);\\n\\n    // If this is also the collateral run seizeInternal to avoid re-entrancy, otherwise make an external call.\\n    // both revert on failure\\n    if (address(collateralFixedLender) == address(this)) {\\n      _seize(this, msg.sender, borrower, seizeTokens);\\n    } else {\\n      collateralFixedLender.seize(msg.sender, borrower, seizeTokens);\\n    }\\n\\n    // We emit a LiquidateBorrow event\\n    emit LiquidateBorrow(msg.sender, borrower, repaidAssets, collateralFixedLender, seizeTokens);\\n\\n    asset.safeTransferFrom(msg.sender, address(this), repaidAssets);\\n  }\\n\\n  /// @notice Public function to seize a certain amount of tokens.\\n  /// @dev Public function for liquidator to seize borrowers tokens in the smart pool.\\n  /// This function will only be called from another FixedLender, on `liquidation` calls.\\n  /// That's why msg.sender needs to be passed to the private function (to be validated as a market)\\n  /// @param liquidator address which will receive the seized tokens.\\n  /// @param borrower address from which the tokens will be seized.\\n  /// @param assets amount to be removed from borrower's possession.\\n  function seize(\\n    address liquidator,\\n    address borrower,\\n    uint256 assets\\n  ) external nonReentrant whenNotPaused {\\n    _seize(FixedLender(msg.sender), liquidator, borrower, assets);\\n  }\\n\\n  /// @dev Borrows a certain amount from a maturity date.\\n  /// @param maturity maturity date for repayment.\\n  /// @param assets amount to send to borrower.\\n  /// @param maxAssetsAllowed maximum amount of debt that the user is willing to accept.\\n  /// @param receiver address that will receive the borrowed assets.\\n  /// @param borrower address that will repay the borrowed assets.\\n  function borrowAtMaturity(\\n    uint256 maturity,\\n    uint256 assets,\\n    uint256 maxAssetsAllowed,\\n    address receiver,\\n    address borrower\\n  ) public nonReentrant whenNotPaused returns (uint256 assetsOwed) {\\n    // reverts on failure\\n    TSUtils.validateRequiredPoolState(maxFuturePools, maturity, TSUtils.State.VALID, TSUtils.State.NONE);\\n\\n    uint256 earningsSP;\\n    uint256 memSPAssets = smartPoolAssets;\\n    (assetsOwed, earningsSP) = borrowMP(maturity, borrower, assets, maxAssetsAllowed, memSPAssets);\\n\\n    if (msg.sender != borrower) {\\n      uint256 allowed = allowance[borrower][msg.sender]; // saves gas for limited approvals.\\n\\n      if (allowed != type(uint256).max) allowance[borrower][msg.sender] = allowed - previewWithdraw(assetsOwed);\\n    }\\n\\n    emit SmartPoolEarningsAccrued(memSPAssets, earningsSP);\\n    smartPoolAssets = memSPAssets + earningsSP;\\n    auditor.validateBorrowMP(this, borrower);\\n\\n    asset.safeTransfer(receiver, assets);\\n\\n    emit BorrowAtMaturity(maturity, msg.sender, receiver, borrower, assets, assetsOwed - assets);\\n  }\\n\\n  /// @notice Deposits a certain amount to a maturity.\\n  /// @param maturity maturity date / pool ID.\\n  /// @param assets amount to receive from the msg.sender.\\n  /// @param minAssetsRequired minimum amount of assets required by the depositor for the transaction to be accepted.\\n  /// @param receiver address that will be able to withdraw the deposited assets.\\n  /// @return maturityAssets total amount of assets (principal + fee) to be withdrawn at maturity.\\n  function depositAtMaturity(\\n    uint256 maturity,\\n    uint256 assets,\\n    uint256 minAssetsRequired,\\n    address receiver\\n  ) public nonReentrant whenNotPaused returns (uint256 maturityAssets) {\\n    // reverts on failure\\n    TSUtils.validateRequiredPoolState(maxFuturePools, maturity, TSUtils.State.VALID, TSUtils.State.NONE);\\n\\n    uint256 earningsSP;\\n    (maturityAssets, earningsSP) = depositMP(maturity, receiver, assets, minAssetsRequired);\\n\\n    uint256 memSPAssets = smartPoolAssets;\\n    emit SmartPoolEarningsAccrued(memSPAssets, earningsSP);\\n    smartPoolAssets = memSPAssets + earningsSP;\\n\\n    emit DepositAtMaturity(maturity, msg.sender, receiver, assets, maturityAssets - assets);\\n    asset.safeTransferFrom(msg.sender, address(this), assets);\\n  }\\n\\n  /// @notice Withdraws a certain amount from a maturity.\\n  /// @dev It's expected that this function can't be paused to prevent freezing user funds.\\n  /// @param maturity maturity date where the assets will be withdrawn.\\n  /// @param positionAssets the amount of assets (principal + fee) to be withdrawn.\\n  /// @param minAssetsRequired minimum amount required by the user (if discount included for early withdrawal).\\n  /// @param receiver address that will receive the withdrawn assets.\\n  /// @param owner address that previously deposited the assets.\\n  /// @return assetsDiscounted amount of assets withdrawn (can include a discount for early withdraw).\\n  function withdrawAtMaturity(\\n    uint256 maturity,\\n    uint256 positionAssets,\\n    uint256 minAssetsRequired,\\n    address receiver,\\n    address owner\\n  ) public nonReentrant returns (uint256 assetsDiscounted) {\\n    if (positionAssets == 0) revert ZeroWithdraw();\\n\\n    // reverts on failure\\n    TSUtils.validateRequiredPoolState(maxFuturePools, maturity, TSUtils.State.VALID, TSUtils.State.MATURED);\\n\\n    uint256 earningsSP;\\n    uint256 memSPAssets = smartPoolAssets;\\n    // We check if there's any discount to be applied for early withdrawal\\n    (assetsDiscounted, earningsSP) = withdrawMP(maturity, owner, positionAssets, minAssetsRequired, memSPAssets);\\n\\n    if (msg.sender != owner) {\\n      uint256 allowed = allowance[owner][msg.sender]; // saves gas for limited approvals.\\n\\n      if (allowed != type(uint256).max) allowance[owner][msg.sender] = allowed - previewWithdraw(assetsDiscounted);\\n    }\\n\\n    emit SmartPoolEarningsAccrued(memSPAssets, earningsSP);\\n    smartPoolAssets = memSPAssets + earningsSP;\\n\\n    asset.safeTransfer(receiver, assetsDiscounted);\\n\\n    emit WithdrawAtMaturity(maturity, msg.sender, receiver, owner, positionAssets, assetsDiscounted);\\n  }\\n\\n  /// @notice Repays a certain amount to a maturity.\\n  /// @param maturity maturity date where the assets will be repaid.\\n  /// @param positionAssets amount to be paid for the borrower's debt.\\n  /// @param maxAssetsAllowed maximum amount of debt that the user is willing to accept to be repaid.\\n  /// @param borrower address of the account that has the debt.\\n  /// @return actualRepayAssets the actual amount that was transferred into the protocol.\\n  function repayAtMaturity(\\n    uint256 maturity,\\n    uint256 positionAssets,\\n    uint256 maxAssetsAllowed,\\n    address borrower\\n  ) public nonReentrant whenNotPaused returns (uint256 actualRepayAssets) {\\n    // reverts on failure\\n    TSUtils.validateRequiredPoolState(maxFuturePools, maturity, TSUtils.State.VALID, TSUtils.State.MATURED);\\n\\n    (actualRepayAssets, ) = noTransferRepay(maturity, positionAssets, maxAssetsAllowed, borrower);\\n    asset.safeTransferFrom(msg.sender, address(this), actualRepayAssets);\\n  }\\n\\n  /// @notice Gets current snapshot for a wallet in certain maturity.\\n  /// @param who wallet to return status snapshot in the specified maturity date.\\n  /// @param maturity maturity. `PoolLib.MATURITY_ALL` (`type(uint256).max`) for all maturities.\\n  /// @return the amount the user deposited to the smart pool and the total money he owes from maturities.\\n  function getAccountSnapshot(address who, uint256 maturity) public view returns (uint256, uint256) {\\n    (uint256 position, uint256 penalties) = getAccountBorrows(who, maturity);\\n    return (maxWithdraw(who), position + penalties);\\n  }\\n\\n  /// @notice This function allows to (partially) repay a position. It does not transfer tokens.\\n  /// @dev Internal repay function, allows partial repayment.\\n  /// @param maturity the maturity to access the pool.\\n  /// @param positionAssets the amount of debt of the pool that should be paid.\\n  /// @param maxAssetsAllowed maximum amount of debt that the user is willing to accept to be repaid.\\n  /// @param borrower the address of the account that has the debt.\\n  /// @return actualRepayAssets the actual amount that should be transferred into the protocol.\\n  function noTransferRepay(\\n    uint256 maturity,\\n    uint256 positionAssets,\\n    uint256 maxAssetsAllowed,\\n    address borrower\\n  ) internal returns (uint256 actualRepayAssets, uint256 debtCovered) {\\n    if (positionAssets == 0) revert ZeroRepay();\\n\\n    uint256 earningsSP;\\n    (actualRepayAssets, debtCovered, earningsSP) = repayMP(maturity, borrower, positionAssets, maxAssetsAllowed);\\n\\n    uint256 memSPAssets = smartPoolAssets;\\n    emit SmartPoolEarningsAccrued(memSPAssets, earningsSP);\\n    smartPoolAssets = memSPAssets + earningsSP;\\n\\n    emit RepayAtMaturity(maturity, msg.sender, borrower, actualRepayAssets, debtCovered);\\n  }\\n\\n  /// @notice Internal function to seize a certain amount of tokens.\\n  /// @dev Internal function for liquidator to seize borrowers tokens in the smart pool.\\n  /// Will only be called from this FixedLender on `liquidation` or through `seize` calls from another FixedLender.\\n  /// That's why msg.sender needs to be passed to the internal function (to be validated as a market).\\n  /// @param seizerFixedLender address which is calling the seize function (see `seize` public function).\\n  /// @param liquidator address which will receive the seized tokens.\\n  /// @param borrower address from which the tokens will be seized.\\n  /// @param assets amount to be removed from borrower's possession.\\n  function _seize(\\n    FixedLender seizerFixedLender,\\n    address liquidator,\\n    address borrower,\\n    uint256 assets\\n  ) internal {\\n    if (assets == 0) revert ZeroWithdraw();\\n\\n    // reverts on failure\\n    auditor.seizeAllowed(this, seizerFixedLender, liquidator, borrower);\\n\\n    uint256 shares = previewWithdraw(assets);\\n    beforeWithdraw(assets, shares);\\n    _burn(borrower, shares);\\n    emit Withdraw(msg.sender, liquidator, borrower, assets, shares);\\n\\n    asset.safeTransfer(liquidator, assets);\\n    emit AssetSeized(liquidator, borrower, assets);\\n  }\\n}\\n\\nerror NotFixedLender();\\nerror ZeroWithdraw();\\nerror ZeroRepay();\\n\",\"keccak256\":\"0x2db9cef1f9fbe7f20032bac55e1b15835f21e4655cdfdadb492dc6c7ac04e212\",\"license\":\"GPL-3.0-or-later\"},\"contracts/InterestRateModel.sol\":{\"content\":\"// SPDX-License-Identifier: GPL-3.0-or-later\\npragma solidity 0.8.13;\\n\\nimport { Math } from \\\"@openzeppelin/contracts/utils/math/Math.sol\\\";\\nimport { AccessControl } from \\\"@openzeppelin/contracts/access/AccessControl.sol\\\";\\nimport { FixedPointMathLib } from \\\"@rari-capital/solmate/src/utils/FixedPointMathLib.sol\\\";\\n\\nimport { InvalidParameter } from \\\"./Auditor.sol\\\";\\nimport { PoolLib } from \\\"./utils/PoolLib.sol\\\";\\n\\ncontract InterestRateModel is AccessControl {\\n  using PoolLib for PoolLib.MaturityPool;\\n  using FixedPointMathLib for uint256;\\n  using FixedPointMathLib for int256;\\n\\n  // Parameters to the system, expressed with 1e18 decimals\\n  uint256 public curveParameterA;\\n  int256 public curveParameterB;\\n  uint256 public maxUtilization;\\n  uint256 public fullUtilization;\\n  uint256 public spFeeRate;\\n\\n  /// @notice Emitted when the curve parameters are changed by admin.\\n  /// @param a new curve parameter A.\\n  /// @param b new curve parameter B.\\n  /// @param maxUtilization new max utilization rate.\\n  /// @param fullUtilization new full utilization rate.\\n  event CurveParametersSet(uint256 a, int256 b, uint256 maxUtilization, uint256 fullUtilization);\\n\\n  /// @notice Emitted when the spFeeRate parameter is changed by admin.\\n  /// @param spFeeRate rate charged to the mp suppliers to be accrued by the sp suppliers.\\n  event SpFeeRateSet(uint256 spFeeRate);\\n\\n  constructor(\\n    uint256 curveParameterA_,\\n    int256 curveParameterB_,\\n    uint256 maxUtilization_,\\n    uint256 fullUtilization_,\\n    uint256 spFeeRate_\\n  ) {\\n    _grantRole(DEFAULT_ADMIN_ROLE, msg.sender);\\n\\n    setCurveParameters(curveParameterA_, curveParameterB_, maxUtilization_, fullUtilization_);\\n    setSPFeeRate(spFeeRate_);\\n  }\\n\\n  /// @notice Sets the rate charged to the mp depositors that the sp suppliers will retain for initially providing\\n  /// liquidity.\\n  /// @dev Value can only be set between 20% and 0%.\\n  /// @param spFeeRate_ percentage amount represented with 1e18 decimals.\\n  function setSPFeeRate(uint256 spFeeRate_) public onlyRole(DEFAULT_ADMIN_ROLE) {\\n    if (spFeeRate_ > 0.2e18) revert InvalidParameter();\\n    spFeeRate = spFeeRate_;\\n    emit SpFeeRateSet(spFeeRate_);\\n  }\\n\\n  /// @notice Gets this model's curve parameters.\\n  /// @return parameters (curveA, curveB, maxUtilization, fullUtilization).\\n  function getCurveParameters()\\n    external\\n    view\\n    returns (\\n      uint256,\\n      int256,\\n      uint256,\\n      uint256\\n    )\\n  {\\n    return (curveParameterA, curveParameterB, maxUtilization, fullUtilization);\\n  }\\n\\n  /// @notice Calculates the amount of revenue sharing between the smart pool and the new MP supplier.\\n  /// @param suppliedSP amount of money currently being supplied in the maturity pool.\\n  /// @param unassignedEarnings earnings not yet accrued to the SP that should be shared with the current supplier.\\n  /// @param amount amount being provided by the MP supplier.\\n  /// @return earningsShare yield to be offered to the MP supplier.\\n  /// @return earningsShareSP yield to be accrued by the SP suppliers for initially providing the liquidity.\\n  function getYieldForDeposit(\\n    uint256 suppliedSP,\\n    uint256 unassignedEarnings,\\n    uint256 amount\\n  ) external view returns (uint256 earningsShare, uint256 earningsShareSP) {\\n    if (suppliedSP != 0) {\\n      // User can't make more fees after the total borrowed amount\\n      earningsShare = unassignedEarnings.mulDivDown(Math.min(amount, suppliedSP), suppliedSP);\\n      earningsShareSP = earningsShare.mulWadDown(spFeeRate);\\n      earningsShare -= earningsShareSP;\\n    }\\n  }\\n\\n  /// @notice Updates this model's curve parameters.\\n  /// @dev FullUR can only be between 1 and 52. UMaxUR can only be higher than FullUR and at most 3 times FullUR.\\n  /// @param curveParameterA_ curve parameter A.\\n  /// @param curveParameterB_ curve parameter B.\\n  /// @param maxUtilization_ % of MP supp.\\n  /// @param fullUtilization_ full UR.\\n  function setCurveParameters(\\n    uint256 curveParameterA_,\\n    int256 curveParameterB_,\\n    uint256 maxUtilization_,\\n    uint256 fullUtilization_\\n  ) public onlyRole(DEFAULT_ADMIN_ROLE) {\\n    if (\\n      fullUtilization_ > 52e18 ||\\n      fullUtilization_ < 1e18 ||\\n      fullUtilization_ >= maxUtilization_ ||\\n      fullUtilization_ < maxUtilization_ / 3\\n    ) revert InvalidParameter();\\n\\n    curveParameterA = curveParameterA_;\\n    curveParameterB = curveParameterB_;\\n    maxUtilization = maxUtilization_;\\n    fullUtilization = fullUtilization_;\\n\\n    // reverts if it's an invalid curve (such as one yielding a negative interest rate).\\n    // doing it works because it's a monotonously increasing function.\\n    rate(0, 0);\\n\\n    emit CurveParametersSet(curveParameterA_, curveParameterB_, maxUtilization_, fullUtilization_);\\n  }\\n\\n  /// @notice Gets fee to borrow a certain amount in a certain maturity with supply/demand values in the maturity pool\\n  /// and supply/demand values in the smart pool.\\n  /// @param maturity maturity date for calculating days left to maturity.\\n  /// @param currentDate the current block timestamp. Received from caller for easier testing.\\n  /// @param amount the current borrow's amount.\\n  /// @param borrowedMP ex-ante amount borrowed from this maturity.\\n  /// @param suppliedMP deposits in maturity pool.\\n  /// @param smartPoolAssetsAverage the average of the smart pool's assets.\\n  /// @return fee the borrower will have to pay, as a factor (1% interest is represented as the wad for 0.01 == 10^16).\\n  function getRateToBorrow(\\n    uint256 maturity,\\n    uint256 currentDate,\\n    uint256 amount,\\n    uint256 borrowedMP,\\n    uint256 suppliedMP,\\n    uint256 smartPoolAssetsAverage\\n  ) public view returns (uint256) {\\n    if (currentDate >= maturity) revert AlreadyMatured();\\n\\n    uint256 supplied = suppliedMP + smartPoolAssetsAverage.divWadDown(fullUtilization);\\n    uint256 utilizationBefore = borrowedMP.divWadDown(supplied);\\n    uint256 utilizationAfter = (borrowedMP + amount).divWadDown(supplied);\\n\\n    if (utilizationAfter > fullUtilization) revert UtilizationExceeded();\\n\\n    return rate(utilizationBefore, utilizationAfter).mulDivDown(maturity - currentDate, 365 days);\\n  }\\n\\n  /// @notice Returns the interest rate integral from `u0` to `u1`, using the analytical solution (ln).\\n  /// @dev handles special case where delta utilization tends to zero, using l'h\\u00f4pital's rule.\\n  /// @param utilizationBefore ex-ante utilization rate, with 18 decimals precision.\\n  /// @param utilizationAfter ex-post utilization rate, with 18 decimals precision.\\n  /// @return the interest rate, with 18 decimals precision.\\n  function rate(uint256 utilizationBefore, uint256 utilizationAfter) internal view returns (uint256) {\\n    int256 r = int256(\\n      utilizationAfter - utilizationBefore < 2.5e9\\n        ? curveParameterA.divWadDown(maxUtilization - utilizationBefore)\\n        : curveParameterA.mulDivDown(\\n          uint256(int256((maxUtilization - utilizationBefore).divWadDown(maxUtilization - utilizationAfter)).lnWad()),\\n          utilizationAfter - utilizationBefore\\n        )\\n    ) + curveParameterB;\\n    assert(r >= 0);\\n    return uint256(r);\\n  }\\n}\\n\\nerror AlreadyMatured();\\nerror InvalidAmount();\\nerror UtilizationExceeded();\\n\",\"keccak256\":\"0xa23ff07be56a5b1dda646c1bf1f275b68df98ae237fb2184200fbdc8eec52159\",\"license\":\"GPL-3.0-or-later\"},\"contracts/PoolAccounting.sol\":{\"content\":\"// SPDX-License-Identifier: GPL-3.0-or-later\\npragma solidity 0.8.13;\\n\\nimport { Math } from \\\"@openzeppelin/contracts/utils/math/Math.sol\\\";\\nimport { AccessControl } from \\\"@openzeppelin/contracts/access/AccessControl.sol\\\";\\nimport { FixedPointMathLib } from \\\"@rari-capital/solmate/src/utils/FixedPointMathLib.sol\\\";\\nimport { InterestRateModel } from \\\"./InterestRateModel.sol\\\";\\nimport { InvalidParameter } from \\\"./Auditor.sol\\\";\\nimport { TSUtils } from \\\"./utils/TSUtils.sol\\\";\\nimport { PoolLib } from \\\"./utils/PoolLib.sol\\\";\\n\\nabstract contract PoolAccounting is AccessControl {\\n  using PoolLib for PoolLib.MaturityPool;\\n  using PoolLib for PoolLib.Position;\\n  using PoolLib for uint256;\\n  using FixedPointMathLib for uint256;\\n  using FixedPointMathLib for int256;\\n\\n  // Vars used in `borrowMP` to avoid stack too deep problem\\n  struct BorrowVars {\\n    PoolLib.Position position;\\n    uint256 fee;\\n    uint256 newUnassignedEarnings;\\n    uint256 earningsSP;\\n  }\\n\\n  struct DampSpeed {\\n    uint256 up;\\n    uint256 down;\\n  }\\n\\n  mapping(uint256 => mapping(address => PoolLib.Position)) public mpUserSuppliedAmount;\\n  mapping(uint256 => mapping(address => PoolLib.Position)) public mpUserBorrowedAmount;\\n\\n  mapping(address => uint256) public userMpBorrowed;\\n  mapping(address => uint256) public userMpSupplied;\\n  mapping(uint256 => PoolLib.MaturityPool) public maturityPools;\\n  uint256 public smartPoolBorrowed;\\n  uint256 public smartPoolEarningsAccumulator;\\n  uint256 public smartPoolAssetsAverage;\\n  uint32 public lastAverageUpdate;\\n\\n  InterestRateModel public interestRateModel;\\n\\n  uint256 public penaltyRate;\\n  uint256 public smartPoolReserveFactor;\\n  uint256 public dampSpeedUp;\\n  uint256 public dampSpeedDown;\\n\\n  /// @notice emitted when the interestRateModel is changed by admin.\\n  /// @param newInterestRateModel new interest rate model to be used by this PoolAccounting.\\n  event InterestRateModelSet(InterestRateModel indexed newInterestRateModel);\\n\\n  /// @notice emitted when the penaltyRate is changed by admin.\\n  /// @param newPenaltyRate penaltyRate percentage per second represented with 1e18 decimals.\\n  event PenaltyRateSet(uint256 newPenaltyRate);\\n\\n  /// @notice emitted when the smartPoolReserveFactor is changed by admin.\\n  /// @param newSmartPoolReserveFactor smartPoolReserveFactor percentage.\\n  event SmartPoolReserveFactorSet(uint256 newSmartPoolReserveFactor);\\n\\n  /// @notice emitted when the damp speeds are changed by admin.\\n  /// @param newDampSpeedUp represented with 1e18 decimals.\\n  /// @param newDampSpeedDown represented with 1e18 decimals.\\n  event DampSpeedSet(uint256 newDampSpeedUp, uint256 newDampSpeedDown);\\n\\n  constructor(\\n    InterestRateModel interestRateModel_,\\n    uint256 penaltyRate_,\\n    uint256 smartPoolReserveFactor_,\\n    DampSpeed memory dampSpeed\\n  ) {\\n    _grantRole(DEFAULT_ADMIN_ROLE, msg.sender);\\n    setInterestRateModel(interestRateModel_);\\n    setPenaltyRate(penaltyRate_);\\n    setSmartPoolReserveFactor(smartPoolReserveFactor_);\\n    setDampSpeed(dampSpeed);\\n  }\\n\\n  /// @notice Sets the interest rate model to be used by this PoolAccounting.\\n  /// @param interestRateModel_ new interest rate model.\\n  function setInterestRateModel(InterestRateModel interestRateModel_) public onlyRole(DEFAULT_ADMIN_ROLE) {\\n    interestRateModel = interestRateModel_;\\n    emit InterestRateModelSet(interestRateModel_);\\n  }\\n\\n  /// @notice Sets the penalty rate per second.\\n  /// @dev Value can only be set approximately between 5% and 1% daily.\\n  /// @param penaltyRate_ percentage represented with 18 decimals.\\n  function setPenaltyRate(uint256 penaltyRate_) public onlyRole(DEFAULT_ADMIN_ROLE) {\\n    if (penaltyRate_ > 5.79e11 || penaltyRate_ < 1.15e11) revert InvalidParameter();\\n    penaltyRate = penaltyRate_;\\n    emit PenaltyRateSet(penaltyRate_);\\n  }\\n\\n  /// @notice Sets the percentage that represents the smart pool liquidity reserves that can't be borrowed.\\n  /// @dev Value can only be set between 20% and 0%.\\n  /// @param smartPoolReserveFactor_ parameter represented with 18 decimals.\\n  function setSmartPoolReserveFactor(uint256 smartPoolReserveFactor_) public onlyRole(DEFAULT_ADMIN_ROLE) {\\n    if (smartPoolReserveFactor_ > 0.2e18) revert InvalidParameter();\\n    smartPoolReserveFactor = smartPoolReserveFactor_;\\n    emit SmartPoolReserveFactorSet(smartPoolReserveFactor_);\\n  }\\n\\n  /// @notice Sets the damp speed used to update the smartPoolAssetsAverage.\\n  /// @dev Values can only be set between 0 and 100%.\\n  /// @param dampSpeed represented with 18 decimals.\\n  function setDampSpeed(DampSpeed memory dampSpeed) public onlyRole(DEFAULT_ADMIN_ROLE) {\\n    if (dampSpeed.up > 1e18 || dampSpeed.down > 1e18) revert InvalidParameter();\\n    dampSpeedUp = dampSpeed.up;\\n    dampSpeedDown = dampSpeed.down;\\n    emit DampSpeedSet(dampSpeed.up, dampSpeed.down);\\n  }\\n\\n  /// @notice Accounts for borrowing from a maturity pool.\\n  /// @dev It doesn't check liquidity for the borrower.\\n  /// The `fixedLender` should call `validateBorrowMP` immediately after calling this function.\\n  /// @param maturity maturity date / pool id where the assets will be borrowed.\\n  /// @param borrower borrower that will take the debt.\\n  /// @param amount amount that the borrower will be borrowing.\\n  /// @param maxAmountAllowed maximum amount that the borrower is willing to pay at maturity.\\n  /// @param smartPoolAssets total assets in the smart pool.\\n  /// @return totalOwedNewBorrow total amount that will need to be paid at maturity for this borrow.\\n  /// @return earningsSP amount of earnings to be accrued by the smart pool.\\n  function borrowMP(\\n    uint256 maturity,\\n    address borrower,\\n    uint256 amount,\\n    uint256 maxAmountAllowed,\\n    uint256 smartPoolAssets\\n  ) internal returns (uint256 totalOwedNewBorrow, uint256 earningsSP) {\\n    BorrowVars memory borrowVars;\\n    PoolLib.MaturityPool storage pool = maturityPools[maturity];\\n\\n    earningsSP = pool.accrueEarnings(maturity, block.timestamp);\\n\\n    updateSmartPoolAssetsAverage(smartPoolAssets);\\n    borrowVars.fee = amount.mulWadDown(\\n      interestRateModel.getRateToBorrow(\\n        maturity,\\n        block.timestamp,\\n        amount,\\n        pool.borrowed,\\n        pool.supplied,\\n        smartPoolAssetsAverage\\n      )\\n    );\\n    totalOwedNewBorrow = amount + borrowVars.fee;\\n\\n    uint256 memSPBorrowed = smartPoolBorrowed;\\n    memSPBorrowed = memSPBorrowed + pool.borrow(amount, smartPoolAssets - memSPBorrowed);\\n    smartPoolBorrowed = memSPBorrowed;\\n    if (memSPBorrowed > smartPoolAssets.mulWadDown(1e18 - smartPoolReserveFactor)) {\\n      revert SmartPoolReserveExceeded();\\n    }\\n    // We validate that the user is not taking arbitrary fees\\n    if (totalOwedNewBorrow > maxAmountAllowed) revert TooMuchSlippage();\\n\\n    // If user doesn't have a current position, we add it to the list of all of them\\n    borrowVars.position = mpUserBorrowedAmount[maturity][borrower];\\n    if (borrowVars.position.principal == 0) {\\n      userMpBorrowed[borrower] = userMpBorrowed[borrower].setMaturity(maturity);\\n    }\\n\\n    // We calculate what portion of the fees are to be accrued and what portion goes to earnings accumulator\\n    (borrowVars.newUnassignedEarnings, borrowVars.earningsSP) = PoolLib.distributeEarningsAccordingly(\\n      borrowVars.fee,\\n      pool.smartPoolBorrowed(),\\n      amount\\n    );\\n    smartPoolEarningsAccumulator += borrowVars.earningsSP;\\n    pool.earningsUnassigned += borrowVars.newUnassignedEarnings;\\n\\n    mpUserBorrowedAmount[maturity][borrower] = PoolLib.Position(\\n      borrowVars.position.principal + amount,\\n      borrowVars.position.fee + borrowVars.fee\\n    );\\n  }\\n\\n  /// @notice Accounts for depositing to a maturity pool.\\n  /// @param maturity maturity date / pool id where the assets will be deposited.\\n  /// @param supplier address that will be depositing the assets.\\n  /// @param amount amount that the supplier will be depositing.\\n  /// @param minAmountRequired minimum amount that the supplier is expecting to receive at maturity.\\n  /// @return currentTotalDeposit the amount that should be collected at maturity for this deposit.\\n  /// @return earningsSP amount of earnings to be accrued by the smart pool.\\n  function depositMP(\\n    uint256 maturity,\\n    address supplier,\\n    uint256 amount,\\n    uint256 minAmountRequired\\n  ) internal returns (uint256 currentTotalDeposit, uint256 earningsSP) {\\n    PoolLib.MaturityPool storage pool = maturityPools[maturity];\\n\\n    earningsSP = pool.accrueEarnings(maturity, block.timestamp);\\n\\n    (uint256 fee, uint256 feeSP) = interestRateModel.getYieldForDeposit(\\n      pool.smartPoolBorrowed(),\\n      pool.earningsUnassigned,\\n      amount\\n    );\\n\\n    currentTotalDeposit = amount + fee;\\n    if (currentTotalDeposit < minAmountRequired) revert TooMuchSlippage();\\n\\n    smartPoolBorrowed -= pool.deposit(amount);\\n    pool.earningsUnassigned -= fee + feeSP;\\n    smartPoolEarningsAccumulator += feeSP;\\n\\n    // We update users's position\\n    PoolLib.Position memory position = mpUserSuppliedAmount[maturity][supplier];\\n\\n    // If user doesn't have a current position, we add it to the list of all of them\\n    if (position.principal == 0) {\\n      userMpSupplied[supplier] = userMpSupplied[supplier].setMaturity(maturity);\\n    }\\n\\n    mpUserSuppliedAmount[maturity][supplier] = PoolLib.Position(position.principal + amount, position.fee + fee);\\n  }\\n\\n  /// @notice Accounts for withdrawing from a maturity pool.\\n  /// @param maturity maturity date / pool id where the asset should be accounted for.\\n  /// @param redeemer address that should have the assets withdrawn.\\n  /// @param positionAssets amount that the redeemer will be extracting from his position.\\n  /// @param minAmountRequired minimum amount that the supplier is expecting to withdraw.\\n  /// @param smartPoolAssets total assets in the smart pool.\\n  /// @return redeemAmountDiscounted amount of assets to be withdrawn (can include a discount for early withdraw).\\n  /// @return earningsSP amount of earnings to be accrued by the smart pool.\\n  function withdrawMP(\\n    uint256 maturity,\\n    address redeemer,\\n    uint256 positionAssets,\\n    uint256 minAmountRequired,\\n    uint256 smartPoolAssets\\n  ) internal returns (uint256 redeemAmountDiscounted, uint256 earningsSP) {\\n    PoolLib.MaturityPool storage pool = maturityPools[maturity];\\n\\n    earningsSP = pool.accrueEarnings(maturity, block.timestamp);\\n\\n    PoolLib.Position memory position = mpUserSuppliedAmount[maturity][redeemer];\\n\\n    if (positionAssets > position.principal + position.fee) positionAssets = position.principal + position.fee;\\n\\n    // We verify if there are any penalties/fee for him because of\\n    // early withdrawal - if so: discount\\n    if (block.timestamp < maturity) {\\n      updateSmartPoolAssetsAverage(smartPoolAssets);\\n      redeemAmountDiscounted = positionAssets.divWadDown(\\n        1e18 +\\n          interestRateModel.getRateToBorrow(\\n            maturity,\\n            block.timestamp,\\n            positionAssets,\\n            pool.borrowed,\\n            pool.supplied,\\n            smartPoolAssetsAverage\\n          )\\n      );\\n    } else {\\n      redeemAmountDiscounted = positionAssets;\\n    }\\n\\n    if (redeemAmountDiscounted < minAmountRequired) revert TooMuchSlippage();\\n\\n    // We remove the supply from the offer\\n    smartPoolBorrowed += pool.withdraw(\\n      PoolLib.Position(position.principal, position.fee).scaleProportionally(positionAssets).principal,\\n      smartPoolAssets - smartPoolBorrowed\\n    );\\n\\n    // All the fees go to unassigned or to the smart pool\\n    (uint256 earningsUnassigned, uint256 newEarningsSP) = PoolLib.distributeEarningsAccordingly(\\n      positionAssets - redeemAmountDiscounted,\\n      pool.smartPoolBorrowed(),\\n      redeemAmountDiscounted\\n    );\\n    pool.earningsUnassigned += earningsUnassigned;\\n    smartPoolEarningsAccumulator += newEarningsSP;\\n\\n    // the user gets discounted the full amount\\n    position.reduceProportionally(positionAssets);\\n    if (position.principal + position.fee == 0) {\\n      delete mpUserSuppliedAmount[maturity][redeemer];\\n      userMpSupplied[redeemer] = userMpSupplied[redeemer].clearMaturity(maturity);\\n    } else {\\n      // we proportionally reduce the values\\n      mpUserSuppliedAmount[maturity][redeemer] = position;\\n    }\\n  }\\n\\n  /// @notice Accounts for repaying from a maturity pool.\\n  /// @param maturity maturity date / pool id where the asset should be accounted for.\\n  /// @param borrower address where the debt will be reduced.\\n  /// @param positionAssets the sum of principal and fees that this repayment covers.\\n  /// @param maxAmountAllowed maximum amount of debt that the user is willing to accept to be repaid.\\n  /// @return repayAmount the amount with discounts included that will finally be transferred.\\n  /// @return debtCovered the sum of principal and fees that this repayment covers.\\n  /// @return earningsSP amount of earnings to be accrued by the smart pool depositors.\\n  function repayMP(\\n    uint256 maturity,\\n    address borrower,\\n    uint256 positionAssets,\\n    uint256 maxAmountAllowed\\n  )\\n    internal\\n    returns (\\n      uint256 repayAmount,\\n      uint256 debtCovered,\\n      uint256 earningsSP\\n    )\\n  {\\n    PoolLib.MaturityPool storage pool = maturityPools[maturity];\\n\\n    earningsSP = pool.accrueEarnings(maturity, block.timestamp);\\n\\n    PoolLib.Position memory position = mpUserBorrowedAmount[maturity][borrower];\\n\\n    debtCovered = Math.min(positionAssets, position.principal + position.fee);\\n\\n    PoolLib.Position memory scaleDebtCovered = PoolLib.Position(position.principal, position.fee).scaleProportionally(\\n      debtCovered\\n    );\\n\\n    // Early repayment allows you to get a discount from the unassigned earnings\\n    if (block.timestamp < maturity) {\\n      // We calculate the deposit fee considering the amount of debt the user'll pay\\n      (uint256 discountFee, uint256 feeSP) = interestRateModel.getYieldForDeposit(\\n        pool.smartPoolBorrowed(),\\n        pool.earningsUnassigned,\\n        scaleDebtCovered.principal\\n      );\\n\\n      // We remove the fee from unassigned earnings\\n      pool.earningsUnassigned -= discountFee + feeSP;\\n\\n      // The fee gets discounted from the user through `repayAmount`\\n      repayAmount = debtCovered - discountFee;\\n\\n      // The fee charged to the MP supplier go to the smart pool accumulator\\n      smartPoolEarningsAccumulator += feeSP;\\n    } else {\\n      repayAmount = debtCovered + debtCovered.mulWadDown((block.timestamp - maturity) * penaltyRate);\\n\\n      // All penalties go to the smart pool accumulator\\n      smartPoolEarningsAccumulator += repayAmount - debtCovered;\\n    }\\n\\n    // We verify that the user agrees to this discount or penalty\\n    if (repayAmount > maxAmountAllowed) revert TooMuchSlippage();\\n\\n    // We reduce the borrowed and we might decrease the SP debt\\n    smartPoolBorrowed -= pool.repay(scaleDebtCovered.principal);\\n\\n    // We update the user position\\n    position.reduceProportionally(debtCovered);\\n    if (position.principal + position.fee == 0) {\\n      delete mpUserBorrowedAmount[maturity][borrower];\\n      userMpBorrowed[borrower] = userMpBorrowed[borrower].clearMaturity(maturity);\\n    } else {\\n      // We proportionally reduce the values\\n      mpUserBorrowedAmount[maturity][borrower] = position;\\n    }\\n  }\\n\\n  /// @dev Gets all borrows for an account in certain maturity (or MATURITY_ALL).\\n  /// @param who account to return status snapshot in the specified maturity date.\\n  /// @param maturity maturity where the borrow is taking place. MATURITY_ALL returns all borrows.\\n  /// @return sumPositions the total amount of borrows in user position.\\n  /// @return sumPenalties the total penalties for late repayment in all maturities.\\n  function getAccountBorrows(address who, uint256 maturity)\\n    public\\n    view\\n    returns (uint256 sumPositions, uint256 sumPenalties)\\n  {\\n    if (maturity == PoolLib.MATURITY_ALL) {\\n      uint256 encodedMaturities = userMpBorrowed[who];\\n      uint256 baseMaturity = encodedMaturities % (1 << 32);\\n      uint256 packedMaturities = encodedMaturities >> 32;\\n      // We calculate all the timestamps using the baseMaturity and the following bits representing the following weeks\\n      for (uint256 i = 0; i < 224; ) {\\n        if ((packedMaturities & (1 << i)) != 0) {\\n          (uint256 position, uint256 penalties) = getAccountDebt(who, baseMaturity + (i * TSUtils.INTERVAL));\\n          sumPositions += position;\\n          sumPenalties += penalties;\\n        }\\n        unchecked {\\n          ++i;\\n        }\\n        if ((1 << i) > packedMaturities) break;\\n      }\\n    } else (sumPositions, sumPenalties) = getAccountDebt(who, maturity);\\n  }\\n\\n  /// @notice Gets the debt + penalties of an account for a certain maturity.\\n  /// @param who account to return debt status for the specified maturity.\\n  /// @param maturity amount to be transferred.\\n  /// @return position the position debt denominated in number of tokens.\\n  /// @return penalties the penalties for late repayment.\\n  function getAccountDebt(address who, uint256 maturity) internal view returns (uint256 position, uint256 penalties) {\\n    PoolLib.Position memory data = mpUserBorrowedAmount[maturity][who];\\n    position = data.principal + data.fee;\\n    uint256 secondsDelayed = TSUtils.secondsPre(maturity, block.timestamp);\\n    if (secondsDelayed > 0) penalties = position.mulWadDown(secondsDelayed * penaltyRate);\\n  }\\n\\n  /// @notice Updates the smartPoolAssetsAverage.\\n  /// @param smartPoolAssets smart pool total assets.\\n  function updateSmartPoolAssetsAverage(uint256 smartPoolAssets) internal {\\n    uint256 dampSpeedFactor = smartPoolAssets < smartPoolAssetsAverage ? dampSpeedDown : dampSpeedUp;\\n    uint256 averageFactor = uint256(1e18 - (-int256(dampSpeedFactor * (block.timestamp - lastAverageUpdate))).expWad());\\n    smartPoolAssetsAverage =\\n      smartPoolAssetsAverage.mulWadDown(1e18 - averageFactor) +\\n      averageFactor.mulWadDown(smartPoolAssets);\\n    lastAverageUpdate = uint32(block.timestamp);\\n  }\\n}\\n\\nerror AlreadyInitialized();\\nerror TooMuchSlippage();\\nerror SmartPoolReserveExceeded();\\n\",\"keccak256\":\"0x6870be70372fc3a9cd63e48b9c009f4305bf4bf1e93c1471daedab5bc433b91e\",\"license\":\"GPL-3.0-or-later\"},\"contracts/periphery/Previewer.sol\":{\"content\":\"// SPDX-License-Identifier: GPL-3.0-or-later\\npragma solidity 0.8.13;\\n\\nimport { Math } from \\\"@openzeppelin/contracts/utils/math/Math.sol\\\";\\nimport { FixedPointMathLib } from \\\"@rari-capital/solmate/src/utils/FixedPointMathLib.sol\\\";\\nimport { InterestRateModel, AlreadyMatured } from \\\"../InterestRateModel.sol\\\";\\nimport { ExactlyOracle } from \\\"../ExactlyOracle.sol\\\";\\nimport { FixedLender } from \\\"../FixedLender.sol\\\";\\nimport { Auditor } from \\\"../Auditor.sol\\\";\\nimport { PoolLib } from \\\"../utils/PoolLib.sol\\\";\\nimport { TSUtils } from \\\"../utils/TSUtils.sol\\\";\\n\\n/// @title Previewer\\n/// @notice Contract to be consumed by Exactly's front-end dApp.\\ncontract Previewer {\\n  using FixedPointMathLib for uint256;\\n  using FixedPointMathLib for int256;\\n  using PoolLib for PoolLib.Position;\\n\\n  Auditor public immutable auditor;\\n\\n  struct MaturityPosition {\\n    uint256 maturity;\\n    PoolLib.Position position;\\n  }\\n\\n  struct MaturityLiquidity {\\n    uint256 maturity;\\n    uint256 assets;\\n  }\\n\\n  struct MarketAccount {\\n    FixedLender market;\\n    string assetSymbol;\\n    uint256 oraclePrice;\\n    uint128 penaltyRate;\\n    uint128 adjustFactor;\\n    uint8 decimals;\\n    uint8 maxFuturePools;\\n    bool isCollateral;\\n    uint256 smartPoolShares;\\n    uint256 smartPoolAssets;\\n    MaturityLiquidity[] availableLiquidity;\\n    MaturityPosition[] maturitySupplyPositions;\\n    MaturityPosition[] maturityBorrowPositions;\\n  }\\n\\n  struct MaturityBitmap {\\n    uint256 base;\\n    uint256 packed;\\n  }\\n\\n  constructor(Auditor auditor_) {\\n    auditor = auditor_;\\n  }\\n\\n  /// @notice Gets the assets plus yield offered by a maturity when depositing a certain amount.\\n  /// @param market address of the market.\\n  /// @param maturity maturity date/pool where the assets will be deposited.\\n  /// @param assets amount of assets that will be deposited.\\n  /// @return positionAssets amount plus yield that the depositor will receive after maturity.\\n  function previewDepositAtMaturity(\\n    FixedLender market,\\n    uint256 maturity,\\n    uint256 assets\\n  ) public view returns (uint256 positionAssets) {\\n    if (block.timestamp > maturity) revert AlreadyMatured();\\n\\n    PoolLib.MaturityPool memory pool;\\n    (pool.borrowed, pool.supplied, pool.earningsUnassigned, pool.lastAccrual) = market.maturityPools(maturity);\\n    (uint256 smartPoolBorrowed, uint256 unassignedEarnings) = getPoolData(market, maturity);\\n\\n    (uint256 yield, ) = market.interestRateModel().getYieldForDeposit(smartPoolBorrowed, unassignedEarnings, assets);\\n    positionAssets = assets + yield;\\n  }\\n\\n  /// @notice Gets the assets plus yield offered by all VALID maturities when depositing a certain amount.\\n  /// @param market address of the market.\\n  /// @param assets amount of assets that will be deposited.\\n  /// @return positionAssetsMaturities array containing amount plus yield that user will receive after each maturity.\\n  function previewDepositAtAllMaturities(FixedLender market, uint256 assets)\\n    external\\n    view\\n    returns (MaturityLiquidity[] memory positionAssetsMaturities)\\n  {\\n    uint256 maxFuturePools = market.maxFuturePools();\\n    uint256 nextMaturity = block.timestamp - (block.timestamp % TSUtils.INTERVAL) + TSUtils.INTERVAL;\\n    positionAssetsMaturities = new MaturityLiquidity[](maxFuturePools);\\n    for (uint256 i = 0; i < maxFuturePools; i++) {\\n      uint256 maturity = nextMaturity + TSUtils.INTERVAL * i;\\n\\n      positionAssetsMaturities[i].maturity = maturity;\\n      positionAssetsMaturities[i].assets = previewDepositAtMaturity(market, maturity, assets);\\n    }\\n  }\\n\\n  /// @notice Gets the amount plus fees to be repaid at maturity when borrowing certain amount of assets.\\n  /// @param market address of the market.\\n  /// @param maturity maturity date/pool where the assets will be borrowed.\\n  /// @param assets amount of assets that will be borrowed.\\n  /// @return positionAssets amount plus fees that the depositor will repay at maturity.\\n  function previewBorrowAtMaturity(\\n    FixedLender market,\\n    uint256 maturity,\\n    uint256 assets\\n  ) external view returns (uint256 positionAssets) {\\n    PoolLib.MaturityPool memory pool;\\n    (pool.borrowed, pool.supplied, , ) = market.maturityPools(maturity);\\n\\n    uint256 fees = assets.mulWadDown(\\n      market.interestRateModel().getRateToBorrow(\\n        maturity,\\n        block.timestamp,\\n        assets,\\n        pool.borrowed,\\n        pool.supplied,\\n        smartPoolAssetsAverage(market)\\n      )\\n    );\\n    positionAssets = assets + fees;\\n  }\\n\\n  /// @notice Gets the amount to be withdrawn for a certain positionAmount of assets at maturity.\\n  /// @param market address of the market.\\n  /// @param maturity maturity date/pool where the assets will be withdrawn.\\n  /// @param positionAssets amount of assets that will be tried to withdraw.\\n  /// @return withdrawAssets amount that will be withdrawn.\\n  function previewWithdrawAtMaturity(\\n    FixedLender market,\\n    uint256 maturity,\\n    uint256 positionAssets\\n  ) external view returns (uint256 withdrawAssets) {\\n    if (block.timestamp >= maturity) return positionAssets;\\n\\n    PoolLib.MaturityPool memory pool;\\n    (pool.borrowed, pool.supplied, , ) = market.maturityPools(maturity);\\n\\n    withdrawAssets = positionAssets.divWadDown(\\n      1e18 +\\n        market.interestRateModel().getRateToBorrow(\\n          maturity,\\n          block.timestamp,\\n          positionAssets,\\n          pool.borrowed,\\n          pool.supplied,\\n          smartPoolAssetsAverage(market)\\n        )\\n    );\\n  }\\n\\n  /// @notice Gets the assets that will be repaid when repaying a certain amount at the current maturity.\\n  /// @param market address of the market.\\n  /// @param maturity maturity date/pool where the assets will be repaid.\\n  /// @param positionAssets amount of assets that will be subtracted from the position.\\n  /// @param borrower address of the borrower.\\n  /// @return repayAssets amount of assets that will be repaid.\\n  function previewRepayAtMaturity(\\n    FixedLender market,\\n    uint256 maturity,\\n    uint256 positionAssets,\\n    address borrower\\n  ) external view returns (uint256 repayAssets) {\\n    if (block.timestamp >= maturity) {\\n      return\\n        repayAssets = positionAssets + positionAssets.mulWadDown((block.timestamp - maturity) * market.penaltyRate());\\n    }\\n\\n    (uint256 smartPoolBorrowed, uint256 unassignedEarnings) = getPoolData(market, maturity);\\n    PoolLib.Position memory debt;\\n    (debt.principal, debt.fee) = market.mpUserBorrowedAmount(maturity, borrower);\\n    PoolLib.Position memory coveredDebt = debt.scaleProportionally(positionAssets);\\n\\n    (uint256 discount, ) = market.interestRateModel().getYieldForDeposit(\\n      smartPoolBorrowed,\\n      unassignedEarnings,\\n      coveredDebt.principal\\n    );\\n    repayAssets = positionAssets - discount;\\n  }\\n\\n  /// @notice Function to get a certain account extended data.\\n  /// @param account address which the extended data will be calculated.\\n  /// @return data extended accountability of all markets for the account.\\n  function accounts(address account) external view returns (MarketAccount[] memory data) {\\n    ExactlyOracle oracle = auditor.oracle();\\n    uint256 markets = auditor.accountMarkets(account);\\n    uint256 maxValue = auditor.getAllMarkets().length;\\n    data = new MarketAccount[](maxValue);\\n    for (uint256 i = 0; i < maxValue; ++i) {\\n      FixedLender market = auditor.getAllMarkets()[i];\\n      (uint128 adjustFactor, uint8 decimals, , ) = auditor.markets(market);\\n      data[i] = MarketAccount({\\n        market: market,\\n        assetSymbol: market.asset().symbol(),\\n        oraclePrice: oracle.getAssetPrice(market),\\n        penaltyRate: uint128(market.penaltyRate()),\\n        adjustFactor: adjustFactor,\\n        decimals: decimals,\\n        maxFuturePools: market.maxFuturePools(),\\n        isCollateral: markets & (1 << i) != 0 ? true : false,\\n        smartPoolShares: market.balanceOf(account),\\n        smartPoolAssets: market.maxWithdraw(account),\\n        availableLiquidity: availableLiquidity(market),\\n        maturitySupplyPositions: maturityPositions(account, market.userMpSupplied, market.mpUserSuppliedAmount),\\n        maturityBorrowPositions: maturityPositions(account, market.userMpBorrowed, market.mpUserBorrowedAmount)\\n      });\\n    }\\n  }\\n\\n  function availableLiquidity(FixedLender market)\\n    internal\\n    view\\n    returns (MaturityLiquidity[] memory availableLiquidities)\\n  {\\n    uint256 maxFuturePools = market.maxFuturePools();\\n    uint256 nextMaturity = block.timestamp - (block.timestamp % TSUtils.INTERVAL) + TSUtils.INTERVAL;\\n    availableLiquidities = new MaturityLiquidity[](maxFuturePools);\\n    for (uint256 i = 0; i < maxFuturePools; i++) {\\n      uint256 maturity = nextMaturity + TSUtils.INTERVAL * i;\\n      PoolLib.MaturityPool memory pool;\\n      (pool.borrowed, pool.supplied, , ) = market.maturityPools(maturity);\\n\\n      uint256 borrowableAssets = market.smartPoolAssets().mulWadDown(1e18 - market.smartPoolReserveFactor());\\n      uint256 fixedDeposits = pool.supplied - Math.min(pool.supplied, pool.borrowed);\\n\\n      availableLiquidities[i].maturity = maturity;\\n      availableLiquidities[i].assets =\\n        Math.min(\\n          borrowableAssets - Math.min(borrowableAssets, market.smartPoolBorrowed()),\\n          smartPoolAssetsAverage(market)\\n        ) +\\n        fixedDeposits;\\n    }\\n  }\\n\\n  function maturityPositions(\\n    address account,\\n    function(address) external view returns (uint256) getMaturities,\\n    function(uint256, address) external view returns (uint256, uint256) getPositions\\n  ) internal view returns (MaturityPosition[] memory userMaturityPositions) {\\n    uint256 userMaturityCount = 0;\\n    MaturityPosition[] memory allMaturityPositions = new MaturityPosition[](224);\\n    MaturityBitmap memory maturities;\\n    maturities.packed = getMaturities(account);\\n    maturities.base = maturities.packed % (1 << 32);\\n    maturities.packed = maturities.packed >> 32;\\n    for (uint256 i = 0; i < 224; ++i) {\\n      if ((maturities.packed & (1 << i)) != 0) {\\n        uint256 maturity = maturities.base + (i * TSUtils.INTERVAL);\\n        (uint256 principal, uint256 fee) = getPositions(maturity, account);\\n        allMaturityPositions[userMaturityCount].maturity = maturity;\\n        allMaturityPositions[userMaturityCount].position = PoolLib.Position(principal, fee);\\n        ++userMaturityCount;\\n      }\\n      if ((1 << i) > maturities.packed) break;\\n    }\\n\\n    userMaturityPositions = new MaturityPosition[](userMaturityCount);\\n    for (uint256 i = 0; i < userMaturityCount; ++i) userMaturityPositions[i] = allMaturityPositions[i];\\n  }\\n\\n  function getPoolData(FixedLender market, uint256 maturity)\\n    internal\\n    view\\n    returns (uint256 smartPoolBorrowed, uint256 unassignedEarnings)\\n  {\\n    PoolLib.MaturityPool memory pool;\\n    (pool.borrowed, pool.supplied, pool.earningsUnassigned, pool.lastAccrual) = market.maturityPools(maturity);\\n\\n    smartPoolBorrowed = pool.borrowed - Math.min(pool.borrowed, pool.supplied);\\n    unassignedEarnings =\\n      pool.earningsUnassigned -\\n      pool.earningsUnassigned.mulDivDown(block.timestamp - pool.lastAccrual, maturity - pool.lastAccrual);\\n  }\\n\\n  function smartPoolAssetsAverage(FixedLender market) internal view returns (uint256) {\\n    uint256 dampSpeedFactor = market.smartPoolAssets() < market.smartPoolAssetsAverage()\\n      ? market.dampSpeedDown()\\n      : market.dampSpeedUp();\\n    uint256 averageFactor = uint256(\\n      1e18 - (-int256(dampSpeedFactor * (block.timestamp - market.lastAverageUpdate()))).expWad()\\n    );\\n    return\\n      market.smartPoolAssetsAverage().mulWadDown(1e18 - averageFactor) +\\n      averageFactor.mulWadDown(market.smartPoolAssets());\\n  }\\n}\\n\",\"keccak256\":\"0xcf2ee4f8a722bfafc83a22f9d2608d90bd00c61ee0283fc9abd2195d0680c9e2\",\"license\":\"GPL-3.0-or-later\"},\"contracts/utils/PoolLib.sol\":{\"content\":\"// SPDX-License-Identifier: GPL-3.0-or-later\\npragma solidity 0.8.13;\\n\\nimport { FixedPointMathLib } from \\\"@rari-capital/solmate/src/utils/FixedPointMathLib.sol\\\";\\nimport { Math } from \\\"@openzeppelin/contracts/utils/math/Math.sol\\\";\\nimport { TSUtils } from \\\"./TSUtils.sol\\\";\\n\\nlibrary PoolLib {\\n  using FixedPointMathLib for uint256;\\n\\n  /// @notice contains the accountability of a maturity.\\n  /// @param borrowed total amount borrowed from the maturity.\\n  /// @param supplied total amount supplied to the maturity.\\n  /// @param earningsUnassigned total amount of earnings not yet distributed and accrued.\\n  /// @param lastAccrual timestamp for the last time that some earnings have been distributed to earningsSP.\\n  struct MaturityPool {\\n    uint256 borrowed;\\n    uint256 supplied;\\n    uint256 earningsUnassigned;\\n    uint256 lastAccrual;\\n  }\\n\\n  /// @notice contains principal and fee of a borrow or a supply position of a user in a maturity.\\n  /// @param principal amount borrowed or supplied to the maturity.\\n  /// @param fee amount of fees to be repaid or earned at maturity.\\n  struct Position {\\n    uint256 principal;\\n    uint256 fee;\\n  }\\n\\n  uint256 public constant MATURITY_ALL = type(uint256).max;\\n\\n  /// @notice calculates the amount that a maturity borrowed from the smart pool.\\n  /// @param pool maturity pool.\\n  /// @return amount borrowed from the maturity.\\n  function smartPoolBorrowed(MaturityPool storage pool) internal view returns (uint256) {\\n    uint256 borrowed = pool.borrowed;\\n    uint256 supplied = pool.supplied;\\n    return borrowed - Math.min(borrowed, supplied);\\n  }\\n\\n  /// @notice registers an operation to add supply to a maturity and potentially reduce smart pool debt.\\n  /// @param pool maturity pool where an amount will be added to the supply.\\n  /// @param amount amount to be added to the supply.\\n  /// @return smartPoolDebtReduction amount that will be reduced from the smart pool debt.\\n  function deposit(MaturityPool storage pool, uint256 amount) internal returns (uint256 smartPoolDebtReduction) {\\n    uint256 borrowed = pool.borrowed;\\n    uint256 supplied = pool.supplied;\\n    pool.supplied = supplied + amount;\\n    smartPoolDebtReduction = Math.min(borrowed - Math.min(borrowed, supplied), amount);\\n  }\\n\\n  /// @notice registers an operation to reduce borrowed amount from a maturity and potentially reduce smart pool debt.\\n  /// @param pool maturity where an amount will be repaid.\\n  /// @param amount amount to be added to the maturity.\\n  /// @return smartPoolDebtReduction amount that will be reduced from the smart pool debt.\\n  function repay(MaturityPool storage pool, uint256 amount) internal returns (uint256 smartPoolDebtReduction) {\\n    uint256 borrowed = pool.borrowed;\\n    uint256 supplied = pool.supplied;\\n    pool.borrowed = borrowed - amount;\\n    smartPoolDebtReduction = Math.min(borrowed - Math.min(borrowed, supplied), amount);\\n  }\\n\\n  /// @notice registers an operation to increase borrowed amount of a maturity and potentially increase smart pool debt.\\n  /// @param pool maturity where an amount will be borrowed.\\n  /// @param amount amount to be borrowed from the maturity.\\n  /// @return smartPoolDebtAddition amount of new debt that needs to be borrowed from the smart pool.\\n  function borrow(\\n    MaturityPool storage pool,\\n    uint256 amount,\\n    uint256 maxDebt\\n  ) internal returns (uint256 smartPoolDebtAddition) {\\n    uint256 borrowed = pool.borrowed;\\n    uint256 newBorrowed = borrowed + amount;\\n    uint256 oldSupply = Math.max(borrowed, pool.supplied);\\n\\n    smartPoolDebtAddition = newBorrowed - Math.min(oldSupply, newBorrowed);\\n\\n    if (smartPoolDebtAddition > maxDebt) revert InsufficientProtocolLiquidity();\\n\\n    pool.borrowed = newBorrowed;\\n  }\\n\\n  /// @notice registers an operation to reduce supply from a maturity and potentially increase smart pool debt.\\n  /// @param pool maturity where amount will be withdrawn.\\n  /// @param amountToDiscount amoun to be withdrawn from the maturity.\\n  /// @return smartPoolDebtAddition amount of new debt that needs to be borrowed from the smart pool.\\n  function withdraw(\\n    MaturityPool storage pool,\\n    uint256 amountToDiscount,\\n    uint256 maxDebt\\n  ) internal returns (uint256 smartPoolDebtAddition) {\\n    uint256 borrowed = pool.borrowed;\\n    uint256 supplied = pool.supplied;\\n    uint256 newSupply = supplied - amountToDiscount;\\n\\n    smartPoolDebtAddition = Math.min(supplied, borrowed) - Math.min(newSupply, borrowed);\\n\\n    if (smartPoolDebtAddition > maxDebt) revert InsufficientProtocolLiquidity();\\n\\n    pool.supplied = newSupply;\\n  }\\n\\n  /// @notice accrues smart pool earnings from earningsUnassigned based on the lastAccrual time.\\n  /// @param pool maturity where earnings will be accrued.\\n  /// @param currentTimestamp timestamp of the current transaction.\\n  /// @param maturity maturity date of the pool.\\n  /// @return earningsSP amount of earnings to be distributed to the smart pool.\\n  function accrueEarnings(\\n    MaturityPool storage pool,\\n    uint256 maturity,\\n    uint256 currentTimestamp\\n  ) internal returns (uint256 earningsSP) {\\n    uint256 lastAccrual = pool.lastAccrual;\\n\\n    if (lastAccrual == maturity) return 0;\\n\\n    // seconds from last accrual to the closest:\\n    // maturity date or the current timestamp\\n    uint256 secondsSinceLastAccrue = TSUtils.secondsPre(lastAccrual, Math.min(maturity, currentTimestamp));\\n    // seconds from last accrual to the maturity date\\n    uint256 secondsTotalToMaturity = TSUtils.secondsPre(lastAccrual, maturity);\\n    pool.lastAccrual = Math.min(maturity, currentTimestamp);\\n\\n    // assign some of the earnings to be collected at maturity\\n    uint256 earningsUnassigned = pool.earningsUnassigned;\\n    earningsSP = earningsUnassigned.mulDivDown(secondsSinceLastAccrue, secondsTotalToMaturity);\\n    pool.earningsUnassigned = earningsUnassigned - earningsSP;\\n  }\\n\\n  /// @notice modify positions based on a certain amount, keeping the original principal/fee ratio.\\n  /// @dev modifies the original struct and returns it. Needs for the amount to be less than the principal and the fee\\n  /// @param position original position to be scaled.\\n  /// @param amount to be used as a full value (principal + interest).\\n  /// @return Position scaled position.\\n  function scaleProportionally(Position memory position, uint256 amount) internal pure returns (Position memory) {\\n    uint256 principal = amount.mulDivDown(position.principal, position.principal + position.fee);\\n    position.principal = principal;\\n    position.fee = amount - principal;\\n    return position;\\n  }\\n\\n  /// @notice reduce positions based on a certain amount, keeping the original principal/fee ratio.\\n  /// @dev modifies the original struct and returns it.\\n  /// @param position original position to be reduced.\\n  /// @param amount to be used as a full value (principal + interest).\\n  /// @return Position reduced position.\\n  function reduceProportionally(Position memory position, uint256 amount) internal pure returns (Position memory) {\\n    uint256 principal = amount.mulDivDown(position.principal, position.principal + position.fee);\\n    position.principal -= principal;\\n    position.fee -= amount - principal;\\n    return position;\\n  }\\n\\n  /// @notice calculates what proportion of earnings would amountFunded represent considering suppliedSP.\\n  /// @param earnings amount to be distributed.\\n  /// @param suppliedSP amount that the maturity borrowed from the smart pool.\\n  /// @param amountFunded amount that will be checked if came from the smart pool or maturity.\\n  /// @return earningsUnassigned earnings to be added to earningsUnassigned.\\n  /// @return earningsSP earnings to be distributed to the smart pool.\\n  function distributeEarningsAccordingly(\\n    uint256 earnings,\\n    uint256 suppliedSP,\\n    uint256 amountFunded\\n  ) internal pure returns (uint256 earningsUnassigned, uint256 earningsSP) {\\n    earningsSP = amountFunded == 0\\n      ? 0\\n      : earnings.mulDivDown(amountFunded - Math.min(suppliedSP, amountFunded), amountFunded);\\n    earningsUnassigned = earnings - earningsSP;\\n  }\\n\\n  /// @notice adds a maturity date to the borrow or supply positions of the user.\\n  /// @param encoded encoded maturity dates where the user borrowed or supplied to.\\n  /// @param maturity the new maturity where the user will borrow or supply to.\\n  /// @return updated encoded maturity dates.\\n  function setMaturity(uint256 encoded, uint256 maturity) internal pure returns (uint256) {\\n    // we initialize the maturity date with also the 1st bit on the 33th position set\\n    if (encoded == 0) return maturity | (1 << 32);\\n\\n    uint256 baseMaturity = encoded % (1 << 32);\\n    if (maturity < baseMaturity) {\\n      // If the new maturity date is lower than the base, then we need to set it as the new base. We wipe clean the\\n      // last 32 bits, we shift the amount of INTERVALS and we set the new value with the 33rd bit set\\n      uint256 range = (baseMaturity - maturity) / TSUtils.INTERVAL;\\n      if (encoded >> (256 - range) != 0) revert MaturityOverflow();\\n      encoded = ((encoded >> 32) << (32 + range));\\n      return maturity | encoded | (1 << 32);\\n    } else {\\n      uint256 range = (maturity - baseMaturity) / TSUtils.INTERVAL;\\n      if (range > 223) revert MaturityOverflow();\\n      return encoded | (1 << (32 + range));\\n    }\\n  }\\n\\n  /// @notice remove maturity from user's borrow or supplied positions.\\n  /// @param encoded encoded maturity dates where the user borrowed or supplied to.\\n  /// @param maturity maturity date to be removed.\\n  /// @return updated encoded maturity dates.\\n  function clearMaturity(uint256 encoded, uint256 maturity) internal pure returns (uint256) {\\n    if (encoded == 0 || encoded == maturity | (1 << 32)) return 0;\\n\\n    uint256 baseMaturity = encoded % (1 << 32);\\n    // if the baseMaturity is the one being cleaned\\n    if (maturity == baseMaturity) {\\n      // We're wiping 32 bytes + 1 for the old base flag\\n      uint256 packed = encoded >> 33;\\n      uint256 range = 1;\\n      while ((packed & 1) == 0 && packed != 0) {\\n        unchecked {\\n          ++range;\\n        }\\n        packed >>= 1;\\n      }\\n      encoded = ((encoded >> (32 + range)) << 32);\\n      return (maturity + (range * TSUtils.INTERVAL)) | encoded;\\n    } else {\\n      // otherwise just clear the bit\\n      return encoded & ~(1 << (32 + ((maturity - baseMaturity) / TSUtils.INTERVAL)));\\n    }\\n  }\\n\\n  /// @notice checks if the user has positions in a maturity date.\\n  /// @param encoded encoded maturity dates where the user borrowed or supplied to.\\n  /// @param maturity maturity date.\\n  /// @return true if the user has positions in the maturity date.\\n  function hasMaturity(uint256 encoded, uint256 maturity) internal pure returns (bool) {\\n    uint256 baseMaturity = encoded % (1 << 32);\\n    if (maturity < baseMaturity) return false;\\n\\n    uint256 range = (maturity - baseMaturity) / TSUtils.INTERVAL;\\n    if (range > 223) return false;\\n    return ((encoded >> 32) & (1 << range)) != 0;\\n  }\\n}\\n\\nerror InsufficientProtocolLiquidity();\\nerror MaturityOverflow();\\n\",\"keccak256\":\"0xa0220781c09053ff887bc20abf4cbb3b1334ab36ecbbea60ba2358d7a703064c\",\"license\":\"GPL-3.0-or-later\"},\"contracts/utils/TSUtils.sol\":{\"content\":\"// SPDX-License-Identifier: GPL-3.0-or-later\\npragma solidity 0.8.13;\\n\\nlibrary TSUtils {\\n  enum State {\\n    NONE,\\n    INVALID,\\n    MATURED,\\n    VALID,\\n    NOT_READY\\n  }\\n\\n  uint32 public constant INTERVAL = 4 weeks;\\n\\n  /// @notice calculates how many seconds are left to a certain date.\\n  /// @param timestampFrom to calculate the difference in seconds from a date.\\n  /// @param timestampTo to calculate the difference in seconds to a date.\\n  /// @return seconds left to the date.\\n  function secondsPre(uint256 timestampFrom, uint256 timestampTo) internal pure returns (uint256) {\\n    return timestampFrom < timestampTo ? timestampTo - timestampFrom : 0;\\n  }\\n\\n  /// @notice returns a pool `time` state based on the current time, maxPools available, and INTERVAL.\\n  /// @param timestamp timestamp of the current time.\\n  /// @param maturity used as maturity date / pool id.\\n  /// @param maxPools number of pools available in the time horizon.\\n  /// @return state: if a pool is VALID, not yet available(NOT_READY), INVALID or MATURED.\\n  function getPoolState(\\n    uint256 timestamp,\\n    uint256 maturity,\\n    uint8 maxPools\\n  ) private pure returns (State) {\\n    if (maturity % INTERVAL != 0) return State.INVALID;\\n\\n    if (maturity <= timestamp) return State.MATURED;\\n\\n    if (maturity > timestamp - (timestamp % INTERVAL) + (INTERVAL * maxPools)) return State.NOT_READY;\\n\\n    return State.VALID;\\n  }\\n\\n  /// @notice verifies that a maturity is VALID, MATURED, NOT_READY or INVALID.\\n  /// @dev if expected state doesn't match the calculated one, it reverts with a custom error \\\"UnmatchedPoolState\\\".\\n  /// @param maturity timestamp of the maturity date to be verified.\\n  /// @param requiredState state required by the caller to be verified (see TSUtils.State() for description).\\n  /// @param alternativeState state required by the caller to be verified (see TSUtils.State() for description).\\n  function validateRequiredPoolState(\\n    uint8 maxFuturePools,\\n    uint256 maturity,\\n    State requiredState,\\n    State alternativeState\\n  ) internal view {\\n    State poolState = getPoolState(block.timestamp, maturity, maxFuturePools);\\n\\n    if (poolState != requiredState && poolState != alternativeState) {\\n      if (alternativeState == State.NONE) revert UnmatchedPoolState(uint8(poolState), uint8(requiredState));\\n\\n      revert UnmatchedPoolStateMultiple(uint8(poolState), uint8(requiredState), uint8(alternativeState));\\n    }\\n  }\\n}\\n\\nerror UnmatchedPoolState(uint8 state, uint8 requiredState);\\nerror UnmatchedPoolStateMultiple(uint8 state, uint8 requiredState, uint8 alternativeState);\\n\",\"keccak256\":\"0x3164707721594e1bf2d69a1aa45c43730595a0fa62ad236dfb0bc39939165cd6\",\"license\":\"GPL-3.0-or-later\"}},\"version\":1}",
  "bytecode": "0x60a06040523480156200001157600080fd5b5060405162002b0c38038062002b0c833981016040819052620000349162000046565b6001600160a01b031660805262000078565b6000602082840312156200005957600080fd5b81516001600160a01b03811681146200007157600080fd5b9392505050565b608051612a56620000b66000396000818160d301528181610810015281816108ce0152818161093f01528181610a8a0152610b2e0152612a566000f3fe608060405234801561001057600080fd5b506004361061007d5760003560e01c80633ec045a61161005b5780633ec045a6146100ce5780635e5c06e21461010d5780638eab0a2a1461012d578063b15a3f611461014057600080fd5b8063109c46ce14610082578063221e81f6146100a857806338e73ff3146100bb575b600080fd5b6100956100903660046121b7565b610160565b6040519081526020015b60405180910390f35b6100956100b63660046121ec565b610363565b6100956100c93660046121b7565b6105de565b6100f57f000000000000000000000000000000000000000000000000000000000000000081565b6040516001600160a01b03909116815260200161009f565b61012061011b366004612236565b61080a565b60405161009f919061234d565b61009561013b3660046121b7565b611004565b61015361014e3660046124cc565b61121d565b60405161009f91906124f8565b600061018d6040518060800160405280600081526020016000815260200160008152602001600081525090565b6040517fa29cb7e1000000000000000000000000000000000000000000000000000000008152600481018590526001600160a01b0386169063a29cb7e190602401608060405180830381865afa1580156101eb573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061020f919061254f565b905050826000018360200182815250828152505050600061034d866001600160a01b031663f3fdb15a6040518163ffffffff1660e01b8152600401602060405180830381865afa158015610267573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061028b9190612585565b6001600160a01b0316637b5c15ef874288876000015188602001516102af8e61139b565b6040517fffffffff0000000000000000000000000000000000000000000000000000000060e089901b1681526004810196909652602486019490945260448501929092526064840152608483015260a482015260c401602060405180830381865afa158015610322573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061034691906125a2565b85906116c8565b905061035981856125ea565b9695505050505050565b60008342106103fd576103ec856001600160a01b031663d6b7494f6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156103ad573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906103d191906125a2565b6103db8642612602565b6103e59190612619565b84906116c8565b6103f690846125ea565b90506105d6565b60008061040a87876116dd565b9150915061042b604051806040016040528060008152602001600081525090565b6040517f821993ec000000000000000000000000000000000000000000000000000000008152600481018890526001600160a01b03868116602483015289169063821993ec906044016040805180830381865afa158015610490573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906104b49190612656565b6020830152815260006104c78288611800565b90506000896001600160a01b031663f3fdb15a6040518163ffffffff1660e01b8152600401602060405180830381865afa158015610509573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061052d9190612585565b82516040517f5e8e0ebe000000000000000000000000000000000000000000000000000000008152600481018890526024810187905260448101919091526001600160a01b039190911690635e8e0ebe906064016040805180830381865afa15801561059d573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906105c19190612656565b5090506105ce8189612602565b955050505050505b949350505050565b60008242106105ee575080610803565b6106196040518060800160405280600081526020016000815260200160008152602001600081525090565b6040517fa29cb7e1000000000000000000000000000000000000000000000000000000008152600481018590526001600160a01b0386169063a29cb7e190602401608060405180830381865afa158015610677573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061069b919061254f565b5050602080840191909152908252604080517ff3fdb15a00000000000000000000000000000000000000000000000000000000815290516107ff926001600160a01b0389169263f3fdb15a92600480830193928290030181865afa158015610707573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061072b9190612585565b6001600160a01b0316637b5c15ef8642878660000151876020015161074f8d61139b565b6040517fffffffff0000000000000000000000000000000000000000000000000000000060e089901b1681526004810196909652602486019490945260448501929092526064840152608483015260a482015260c401602060405180830381865afa1580156107c2573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906107e691906125a2565b6107f890670de0b6b3a76400006125ea565b8490611850565b9150505b9392505050565b606060007f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316637dc0d1d06040518163ffffffff1660e01b8152600401602060405180830381865afa15801561086c573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906108909190612585565b6040517fff383ae60000000000000000000000000000000000000000000000000000000081526001600160a01b0385811660048301529192506000917f0000000000000000000000000000000000000000000000000000000000000000169063ff383ae690602401602060405180830381865afa158015610915573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061093991906125a2565b905060007f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663b0772d0b6040518163ffffffff1660e01b8152600401600060405180830381865afa15801561099b573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526109c391908101906126da565b5190508067ffffffffffffffff8111156109df576109df61267a565b604051908082528060200260200182016040528015610a7857816020015b604080516101a08101825260008082526060602083018190529282018190528282018190526080820181905260a0820181905260c0820181905260e082018190526101008201819052610120820152610140810182905261016081018290526101808101919091528152602001906001900390816109fd5790505b50935060005b81811015610ffb5760007f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663b0772d0b6040518163ffffffff1660e01b8152600401600060405180830381865afa158015610ae6573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610b0e91908101906126da565b8281518110610b1f57610b1f612780565b602002602001015190506000807f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316638e8f294b846040518263ffffffff1660e01b8152600401610b8791906001600160a01b0391909116815260200190565b608060405180830381865afa158015610ba4573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610bc891906127c5565b505091509150604051806101a00160405280846001600160a01b03168152602001846001600160a01b03166338d52e0f6040518163ffffffff1660e01b8152600401602060405180830381865afa158015610c27573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610c4b9190612585565b6001600160a01b03166395d89b416040518163ffffffff1660e01b8152600401600060405180830381865afa158015610c88573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610cb0919081019061282c565b81526040517fb3596f070000000000000000000000000000000000000000000000000000000081526001600160a01b0386811660048301526020909201918a169063b3596f0790602401602060405180830381865afa158015610d17573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610d3b91906125a2565b8152602001846001600160a01b031663d6b7494f6040518163ffffffff1660e01b8152600401602060405180830381865afa158015610d7e573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610da291906125a2565b6fffffffffffffffffffffffffffffffff168152602001836fffffffffffffffffffffffffffffffff1681526020018260ff168152602001846001600160a01b0316630e52dbec6040518163ffffffff1660e01b8152600401602060405180830381865afa158015610e18573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610e3c91906128c0565b60ff1681526020016001861b8816600003610e58576000610e5b565b60015b151581526040517f70a082310000000000000000000000000000000000000000000000000000000081526001600160a01b038c811660048301526020909201918616906370a0823190602401602060405180830381865afa158015610ec4573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610ee891906125a2565b81526040517fce96cb770000000000000000000000000000000000000000000000000000000081526001600160a01b038c8116600483015260209092019186169063ce96cb7790602401602060405180830381865afa158015610f4f573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610f7391906125a2565b8152602001610f8185611865565b8152602001610fa48b6001600160a01b03871663f618bd1e816345227d5f611c0d565b8152602001610fc78b6001600160a01b03871663ce42af678163821993ec611c0d565b815250888581518110610fdc57610fdc612780565b602002602001018190525050505080610ff4906128db565b9050610a7e565b50505050919050565b600082421115611040576040517fb453c22000000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b61106b6040518060800160405280600081526020016000815260200160008152602001600081525090565b6040517fa29cb7e1000000000000000000000000000000000000000000000000000000008152600481018590526001600160a01b0386169063a29cb7e190602401608060405180830381865afa1580156110c9573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906110ed919061254f565b606085015260408401526020830152815260008061110b87876116dd565b915091506000876001600160a01b031663f3fdb15a6040518163ffffffff1660e01b8152600401602060405180830381865afa15801561114f573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906111739190612585565b6040517f5e8e0ebe0000000000000000000000000000000000000000000000000000000081526004810185905260248101849052604481018890526001600160a01b039190911690635e8e0ebe906064016040805180830381865afa1580156111e0573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906112049190612656565b50905061121181876125ea565b98975050505050505050565b60606000836001600160a01b0316630e52dbec6040518163ffffffff1660e01b8152600401602060405180830381865afa15801561125f573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061128391906128c0565b60ff16905060006224ea006112988142612913565b6112a29042612602565b6112ac91906125ea565b90508167ffffffffffffffff8111156112c7576112c761267a565b60405190808252806020026020018201604052801561130c57816020015b60408051808201909152600080825260208201528152602001906001900390816112e55790505b50925060005b82811015611392576000611329826224ea00612619565b61133390846125ea565b90508085838151811061134857611348612780565b60209081029190910101515261135f878288611004565b85838151811061137157611371612780565b6020908102919091018101510152508061138a816128db565b915050611312565b50505092915050565b600080826001600160a01b031663b87d7d8d6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156113dc573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061140091906125a2565b836001600160a01b031663b0f64c196040518163ffffffff1660e01b8152600401602060405180830381865afa15801561143e573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061146291906125a2565b106114ce57826001600160a01b0316630539fa8c6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156114a5573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906114c991906125a2565b611530565b826001600160a01b0316633aa18d6f6040518163ffffffff1660e01b8152600401602060405180830381865afa15801561150c573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061153091906125a2565b905060006115c1846001600160a01b031663fb0fc4c36040518163ffffffff1660e01b8152600401602060405180830381865afa158015611575573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611599919061294e565b6115a99063ffffffff1642612602565b6115b39084612619565b6115bc90612974565b611ef3565b6115d390670de0b6b3a76400006129ac565b9050611641846001600160a01b031663b0f64c196040518163ffffffff1660e01b8152600401602060405180830381865afa158015611616573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061163a91906125a2565b82906116c8565b6116be61165683670de0b6b3a7640000612602565b866001600160a01b031663b87d7d8d6040518163ffffffff1660e01b8152600401602060405180830381865afa158015611694573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906116b891906125a2565b906116c8565b6105d691906125ea565b60006108038383670de0b6b3a7640000612136565b60008061170b6040518060800160405280600081526020016000815260200160008152602001600081525090565b6040517fa29cb7e1000000000000000000000000000000000000000000000000000000008152600481018590526001600160a01b0386169063a29cb7e190602401608060405180830381865afa158015611769573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061178d919061254f565b60608501526040840152602083018190528183526117ab9190612155565b81516117b79190612602565b92506117e78160600151426117cc9190612602565b60608301516117db9087612602565b60408401519190612136565b81604001516117f69190612602565b9150509250929050565b6040805180820190915260008082526020820152825160208401516000916118349161182c90826125ea565b859190612136565b80855290506118438184612602565b6020850152509192915050565b600061080383670de0b6b3a764000084612136565b60606000826001600160a01b0316630e52dbec6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156118a7573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906118cb91906128c0565b60ff16905060006224ea006118e08142612913565b6118ea9042612602565b6118f491906125ea565b90508167ffffffffffffffff81111561190f5761190f61267a565b60405190808252806020026020018201604052801561195457816020015b604080518082019091526000808252602082015281526020019060019003908161192d5790505b50925060005b82811015611c05576000611971826224ea00612619565b61197b90846125ea565b90506119a86040518060800160405280600081526020016000815260200160008152602001600081525090565b6040517fa29cb7e1000000000000000000000000000000000000000000000000000000008152600481018390526001600160a01b0388169063a29cb7e190602401608060405180830381865afa158015611a06573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611a2a919061254f565b9050508260000183602001828152508281525050506000611af6886001600160a01b0316635b1afd676040518163ffffffff1660e01b8152600401602060405180830381865afa158015611a82573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611aa691906125a2565b611ab890670de0b6b3a7640000612602565b896001600160a01b031663b0f64c196040518163ffffffff1660e01b8152600401602060405180830381865afa158015611694573d6000803e3d6000fd5b90506000611b0c83602001518460000151612155565b8360200151611b1b9190612602565b905083888681518110611b3057611b30612780565b6020026020010151600001818152505080611bc2611baf848c6001600160a01b031663fd8ecd176040518163ffffffff1660e01b8152600401602060405180830381865afa158015611b86573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611baa91906125a2565b612155565b611bb99085612602565b611baa8c61139b565b611bcc91906125ea565b888681518110611bde57611bde612780565b60200260200101516020018181525050505050508080611bfd906128db565b91505061195a565b505050919050565b6040805160e0808252611c2082019092526060916000918291816020015b611c3361216b565b815260200190600190039081611c2b57505060408051808201909152600080825260208201529091506040517fffffffff0000000000000000000000000000000000000000000000000000000060e089901b1681526001600160a01b038a16600482015288908890602401602060405180830381865afa158015611cbb573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611cdf91906125a2565b60208201819052611cf69064010000000090612913565b81526020808201805190911c905260005b60e0811015611e3d5760208201516001821b1615611e1f576000611d2e6224ea0083612619565b8351611d3a91906125ea565b90506000808989848f6040518363ffffffff1660e01b8152600401611d729291909182526001600160a01b0316602082015260400190565b6040805180830381865afa158015611d8e573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611db29190612656565b9150915082868881518110611dc957611dc9612780565b60200260200101516000018181525050604051806040016040528083815260200182815250868881518110611e0057611e00612780565b60200260200101516020018190525086611e19906128db565b96505050505b60208201516001821b11611e3d57611e36816128db565b9050611d07565b508267ffffffffffffffff811115611e5757611e5761267a565b604051908082528060200260200182016040528015611e9057816020015b611e7d61216b565b815260200190600190039081611e755790505b50935060005b83811015611ee657828181518110611eb057611eb0612780565b6020026020010151858281518110611eca57611eca612780565b602002602001018190525080611edf906128db565b9050611e96565b5050505095945050505050565b60007ffffffffffffffffffffffffffffffffffffffffffffffffdb731c958f34d94c18213611f2457506000919050565b680755bf798b4a1bf1e58212611f9a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152600c60248201527f4558505f4f564552464c4f570000000000000000000000000000000000000000604482015260640160405180910390fd5b6503782dace9d9604e83901b059150600060606bb17217f7d1cf79abc9e3b39884821b056b80000000000000000000000001901d6bb17217f7d1cf79abc9e3b39881029093037fffffffffffffffffffffffffffffffffffffffdbf3ccf1604d263450f02a550481018102606090811d6d0277594991cfc85f6e2461837cd9018202811d7fffffffffffffffffffffffffffffffffffffe5adedaa1cb095af9e4da10e363c018202811d6db1bbb201f443cf962f1a1d3db4a5018202811d7ffffffffffffffffffffffffffffffffffffd38dc772608b0ae56cce01296c0eb018202811d6e05180bb14799ab47a8a8cb2a527d57016d02d16720577bd19bf614176fe9ea6c10fe68e7fd37d0007b713f765084018402831d9081019084017ffffffffffffffffffffffffffffffffffffffe2c69812cf03b0763fd454a8f7e010290911d6e0587f503bb6ea29d25fcb7401964500190910279d835ebba824c98fb31b83b2ca45c000000000000000000000000010574029d9dc38563c32e5c2f6dc192ee70ef65f9978af30260c3939093039290921c92915050565b82820281151584158583048514171661214e57600080fd5b0492915050565b60008183106121645781610803565b5090919050565b60405180604001604052806000815260200161219a604051806040016040528060008152602001600081525090565b905290565b6001600160a01b03811681146121b457600080fd5b50565b6000806000606084860312156121cc57600080fd5b83356121d78161219f565b95602085013595506040909401359392505050565b6000806000806080858703121561220257600080fd5b843561220d8161219f565b93506020850135925060408501359150606085013561222b8161219f565b939692955090935050565b60006020828403121561224857600080fd5b81356108038161219f565b60005b8381101561226e578181015183820152602001612256565b8381111561227d576000848401525b50505050565b6000815180845261229b816020860160208601612253565b601f01601f19169290920160200192915050565b600081518084526020808501945080840160005b838110156122f3576122e087835180518252602090810151910152565b60409690960195908201906001016122c3565b509495945050505050565b600081518084526020808501945080840160005b838110156122f3578151805188528301516123398489018280518252602090810151910152565b506060969096019590820190600101612312565b60006020808301818452808551808352604092508286019150828160051b87010184880160005b838110156124be578883037fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc0018552815180516001600160a01b031684526101a088820151818a8701526123ca82870182612283565b91505087820151888601526060808301516123f8828801826fffffffffffffffffffffffffffffffff169052565b50506080828101516fffffffffffffffffffffffffffffffff169086015260a08083015160ff9081169187019190915260c0808401519091169086015260e08083015115159086015261010080830151908601526101208083015190860152610140808301518683038288015261246f83826122af565b92505050610160808301518683038288015261248b83826122fe565b9250505061018080830151925085820381870152506124aa81836122fe565b968901969450505090860190600101612374565b509098975050505050505050565b600080604083850312156124df57600080fd5b82356124ea8161219f565b946020939093013593505050565b602080825282518282018190526000919060409081850190868401855b828110156125425761253284835180518252602090810151910152565b9284019290850190600101612515565b5091979650505050505050565b6000806000806080858703121561256557600080fd5b505082516020840151604085015160609095015191969095509092509050565b60006020828403121561259757600080fd5b81516108038161219f565b6000602082840312156125b457600080fd5b5051919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b600082198211156125fd576125fd6125bb565b500190565b600082821015612614576126146125bb565b500390565b6000817fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0483118215151615612651576126516125bb565b500290565b6000806040838503121561266957600080fd5b505080516020909101519092909150565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b604051601f8201601f1916810167ffffffffffffffff811182821017156126d2576126d261267a565b604052919050565b600060208083850312156126ed57600080fd5b825167ffffffffffffffff8082111561270557600080fd5b818501915085601f83011261271957600080fd5b81518181111561272b5761272b61267a565b8060051b915061273c8483016126a9565b818152918301840191848101908884111561275657600080fd5b938501935b8385101561121157845192506127708361219f565b828252938501939085019061275b565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b805160ff811681146127c057600080fd5b919050565b600080600080608085870312156127db57600080fd5b84516fffffffffffffffffffffffffffffffff811681146127fb57600080fd5b9350612809602086016127af565b9250612817604086016127af565b91506060850151801515811461222b57600080fd5b60006020828403121561283e57600080fd5b815167ffffffffffffffff8082111561285657600080fd5b818401915084601f83011261286a57600080fd5b81518181111561287c5761287c61267a565b61288f6020601f19601f840116016126a9565b91508082528560208285010111156128a657600080fd5b6128b7816020840160208601612253565b50949350505050565b6000602082840312156128d257600080fd5b610803826127af565b60007fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff820361290c5761290c6125bb565b5060010190565b600082612949577f4e487b7100000000000000000000000000000000000000000000000000000000600052601260045260246000fd5b500690565b60006020828403121561296057600080fd5b815163ffffffff8116811461080357600080fd5b60007f800000000000000000000000000000000000000000000000000000000000000082036129a5576129a56125bb565b5060000390565b6000808312837f8000000000000000000000000000000000000000000000000000000000000000018312811516156129e6576129e66125bb565b837f7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff018313811615612a1a57612a1a6125bb565b5050039056fea26469706673582212206a97d299e1e98674a81c215f371a4d1e421c9ca2cab08dbb6328cf803d694f2664736f6c634300080d0033",
  "deployedBytecode": "0x608060405234801561001057600080fd5b506004361061007d5760003560e01c80633ec045a61161005b5780633ec045a6146100ce5780635e5c06e21461010d5780638eab0a2a1461012d578063b15a3f611461014057600080fd5b8063109c46ce14610082578063221e81f6146100a857806338e73ff3146100bb575b600080fd5b6100956100903660046121b7565b610160565b6040519081526020015b60405180910390f35b6100956100b63660046121ec565b610363565b6100956100c93660046121b7565b6105de565b6100f57f000000000000000000000000000000000000000000000000000000000000000081565b6040516001600160a01b03909116815260200161009f565b61012061011b366004612236565b61080a565b60405161009f919061234d565b61009561013b3660046121b7565b611004565b61015361014e3660046124cc565b61121d565b60405161009f91906124f8565b600061018d6040518060800160405280600081526020016000815260200160008152602001600081525090565b6040517fa29cb7e1000000000000000000000000000000000000000000000000000000008152600481018590526001600160a01b0386169063a29cb7e190602401608060405180830381865afa1580156101eb573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061020f919061254f565b905050826000018360200182815250828152505050600061034d866001600160a01b031663f3fdb15a6040518163ffffffff1660e01b8152600401602060405180830381865afa158015610267573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061028b9190612585565b6001600160a01b0316637b5c15ef874288876000015188602001516102af8e61139b565b6040517fffffffff0000000000000000000000000000000000000000000000000000000060e089901b1681526004810196909652602486019490945260448501929092526064840152608483015260a482015260c401602060405180830381865afa158015610322573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061034691906125a2565b85906116c8565b905061035981856125ea565b9695505050505050565b60008342106103fd576103ec856001600160a01b031663d6b7494f6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156103ad573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906103d191906125a2565b6103db8642612602565b6103e59190612619565b84906116c8565b6103f690846125ea565b90506105d6565b60008061040a87876116dd565b9150915061042b604051806040016040528060008152602001600081525090565b6040517f821993ec000000000000000000000000000000000000000000000000000000008152600481018890526001600160a01b03868116602483015289169063821993ec906044016040805180830381865afa158015610490573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906104b49190612656565b6020830152815260006104c78288611800565b90506000896001600160a01b031663f3fdb15a6040518163ffffffff1660e01b8152600401602060405180830381865afa158015610509573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061052d9190612585565b82516040517f5e8e0ebe000000000000000000000000000000000000000000000000000000008152600481018890526024810187905260448101919091526001600160a01b039190911690635e8e0ebe906064016040805180830381865afa15801561059d573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906105c19190612656565b5090506105ce8189612602565b955050505050505b949350505050565b60008242106105ee575080610803565b6106196040518060800160405280600081526020016000815260200160008152602001600081525090565b6040517fa29cb7e1000000000000000000000000000000000000000000000000000000008152600481018590526001600160a01b0386169063a29cb7e190602401608060405180830381865afa158015610677573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061069b919061254f565b5050602080840191909152908252604080517ff3fdb15a00000000000000000000000000000000000000000000000000000000815290516107ff926001600160a01b0389169263f3fdb15a92600480830193928290030181865afa158015610707573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061072b9190612585565b6001600160a01b0316637b5c15ef8642878660000151876020015161074f8d61139b565b6040517fffffffff0000000000000000000000000000000000000000000000000000000060e089901b1681526004810196909652602486019490945260448501929092526064840152608483015260a482015260c401602060405180830381865afa1580156107c2573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906107e691906125a2565b6107f890670de0b6b3a76400006125ea565b8490611850565b9150505b9392505050565b606060007f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316637dc0d1d06040518163ffffffff1660e01b8152600401602060405180830381865afa15801561086c573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906108909190612585565b6040517fff383ae60000000000000000000000000000000000000000000000000000000081526001600160a01b0385811660048301529192506000917f0000000000000000000000000000000000000000000000000000000000000000169063ff383ae690602401602060405180830381865afa158015610915573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061093991906125a2565b905060007f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663b0772d0b6040518163ffffffff1660e01b8152600401600060405180830381865afa15801561099b573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526109c391908101906126da565b5190508067ffffffffffffffff8111156109df576109df61267a565b604051908082528060200260200182016040528015610a7857816020015b604080516101a08101825260008082526060602083018190529282018190528282018190526080820181905260a0820181905260c0820181905260e082018190526101008201819052610120820152610140810182905261016081018290526101808101919091528152602001906001900390816109fd5790505b50935060005b81811015610ffb5760007f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663b0772d0b6040518163ffffffff1660e01b8152600401600060405180830381865afa158015610ae6573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610b0e91908101906126da565b8281518110610b1f57610b1f612780565b602002602001015190506000807f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316638e8f294b846040518263ffffffff1660e01b8152600401610b8791906001600160a01b0391909116815260200190565b608060405180830381865afa158015610ba4573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610bc891906127c5565b505091509150604051806101a00160405280846001600160a01b03168152602001846001600160a01b03166338d52e0f6040518163ffffffff1660e01b8152600401602060405180830381865afa158015610c27573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610c4b9190612585565b6001600160a01b03166395d89b416040518163ffffffff1660e01b8152600401600060405180830381865afa158015610c88573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610cb0919081019061282c565b81526040517fb3596f070000000000000000000000000000000000000000000000000000000081526001600160a01b0386811660048301526020909201918a169063b3596f0790602401602060405180830381865afa158015610d17573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610d3b91906125a2565b8152602001846001600160a01b031663d6b7494f6040518163ffffffff1660e01b8152600401602060405180830381865afa158015610d7e573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610da291906125a2565b6fffffffffffffffffffffffffffffffff168152602001836fffffffffffffffffffffffffffffffff1681526020018260ff168152602001846001600160a01b0316630e52dbec6040518163ffffffff1660e01b8152600401602060405180830381865afa158015610e18573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610e3c91906128c0565b60ff1681526020016001861b8816600003610e58576000610e5b565b60015b151581526040517f70a082310000000000000000000000000000000000000000000000000000000081526001600160a01b038c811660048301526020909201918616906370a0823190602401602060405180830381865afa158015610ec4573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610ee891906125a2565b81526040517fce96cb770000000000000000000000000000000000000000000000000000000081526001600160a01b038c8116600483015260209092019186169063ce96cb7790602401602060405180830381865afa158015610f4f573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610f7391906125a2565b8152602001610f8185611865565b8152602001610fa48b6001600160a01b03871663f618bd1e816345227d5f611c0d565b8152602001610fc78b6001600160a01b03871663ce42af678163821993ec611c0d565b815250888581518110610fdc57610fdc612780565b602002602001018190525050505080610ff4906128db565b9050610a7e565b50505050919050565b600082421115611040576040517fb453c22000000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b61106b6040518060800160405280600081526020016000815260200160008152602001600081525090565b6040517fa29cb7e1000000000000000000000000000000000000000000000000000000008152600481018590526001600160a01b0386169063a29cb7e190602401608060405180830381865afa1580156110c9573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906110ed919061254f565b606085015260408401526020830152815260008061110b87876116dd565b915091506000876001600160a01b031663f3fdb15a6040518163ffffffff1660e01b8152600401602060405180830381865afa15801561114f573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906111739190612585565b6040517f5e8e0ebe0000000000000000000000000000000000000000000000000000000081526004810185905260248101849052604481018890526001600160a01b039190911690635e8e0ebe906064016040805180830381865afa1580156111e0573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906112049190612656565b50905061121181876125ea565b98975050505050505050565b60606000836001600160a01b0316630e52dbec6040518163ffffffff1660e01b8152600401602060405180830381865afa15801561125f573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061128391906128c0565b60ff16905060006224ea006112988142612913565b6112a29042612602565b6112ac91906125ea565b90508167ffffffffffffffff8111156112c7576112c761267a565b60405190808252806020026020018201604052801561130c57816020015b60408051808201909152600080825260208201528152602001906001900390816112e55790505b50925060005b82811015611392576000611329826224ea00612619565b61133390846125ea565b90508085838151811061134857611348612780565b60209081029190910101515261135f878288611004565b85838151811061137157611371612780565b6020908102919091018101510152508061138a816128db565b915050611312565b50505092915050565b600080826001600160a01b031663b87d7d8d6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156113dc573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061140091906125a2565b836001600160a01b031663b0f64c196040518163ffffffff1660e01b8152600401602060405180830381865afa15801561143e573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061146291906125a2565b106114ce57826001600160a01b0316630539fa8c6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156114a5573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906114c991906125a2565b611530565b826001600160a01b0316633aa18d6f6040518163ffffffff1660e01b8152600401602060405180830381865afa15801561150c573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061153091906125a2565b905060006115c1846001600160a01b031663fb0fc4c36040518163ffffffff1660e01b8152600401602060405180830381865afa158015611575573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611599919061294e565b6115a99063ffffffff1642612602565b6115b39084612619565b6115bc90612974565b611ef3565b6115d390670de0b6b3a76400006129ac565b9050611641846001600160a01b031663b0f64c196040518163ffffffff1660e01b8152600401602060405180830381865afa158015611616573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061163a91906125a2565b82906116c8565b6116be61165683670de0b6b3a7640000612602565b866001600160a01b031663b87d7d8d6040518163ffffffff1660e01b8152600401602060405180830381865afa158015611694573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906116b891906125a2565b906116c8565b6105d691906125ea565b60006108038383670de0b6b3a7640000612136565b60008061170b6040518060800160405280600081526020016000815260200160008152602001600081525090565b6040517fa29cb7e1000000000000000000000000000000000000000000000000000000008152600481018590526001600160a01b0386169063a29cb7e190602401608060405180830381865afa158015611769573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061178d919061254f565b60608501526040840152602083018190528183526117ab9190612155565b81516117b79190612602565b92506117e78160600151426117cc9190612602565b60608301516117db9087612602565b60408401519190612136565b81604001516117f69190612602565b9150509250929050565b6040805180820190915260008082526020820152825160208401516000916118349161182c90826125ea565b859190612136565b80855290506118438184612602565b6020850152509192915050565b600061080383670de0b6b3a764000084612136565b60606000826001600160a01b0316630e52dbec6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156118a7573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906118cb91906128c0565b60ff16905060006224ea006118e08142612913565b6118ea9042612602565b6118f491906125ea565b90508167ffffffffffffffff81111561190f5761190f61267a565b60405190808252806020026020018201604052801561195457816020015b604080518082019091526000808252602082015281526020019060019003908161192d5790505b50925060005b82811015611c05576000611971826224ea00612619565b61197b90846125ea565b90506119a86040518060800160405280600081526020016000815260200160008152602001600081525090565b6040517fa29cb7e1000000000000000000000000000000000000000000000000000000008152600481018390526001600160a01b0388169063a29cb7e190602401608060405180830381865afa158015611a06573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611a2a919061254f565b9050508260000183602001828152508281525050506000611af6886001600160a01b0316635b1afd676040518163ffffffff1660e01b8152600401602060405180830381865afa158015611a82573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611aa691906125a2565b611ab890670de0b6b3a7640000612602565b896001600160a01b031663b0f64c196040518163ffffffff1660e01b8152600401602060405180830381865afa158015611694573d6000803e3d6000fd5b90506000611b0c83602001518460000151612155565b8360200151611b1b9190612602565b905083888681518110611b3057611b30612780565b6020026020010151600001818152505080611bc2611baf848c6001600160a01b031663fd8ecd176040518163ffffffff1660e01b8152600401602060405180830381865afa158015611b86573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611baa91906125a2565b612155565b611bb99085612602565b611baa8c61139b565b611bcc91906125ea565b888681518110611bde57611bde612780565b60200260200101516020018181525050505050508080611bfd906128db565b91505061195a565b505050919050565b6040805160e0808252611c2082019092526060916000918291816020015b611c3361216b565b815260200190600190039081611c2b57505060408051808201909152600080825260208201529091506040517fffffffff0000000000000000000000000000000000000000000000000000000060e089901b1681526001600160a01b038a16600482015288908890602401602060405180830381865afa158015611cbb573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611cdf91906125a2565b60208201819052611cf69064010000000090612913565b81526020808201805190911c905260005b60e0811015611e3d5760208201516001821b1615611e1f576000611d2e6224ea0083612619565b8351611d3a91906125ea565b90506000808989848f6040518363ffffffff1660e01b8152600401611d729291909182526001600160a01b0316602082015260400190565b6040805180830381865afa158015611d8e573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611db29190612656565b9150915082868881518110611dc957611dc9612780565b60200260200101516000018181525050604051806040016040528083815260200182815250868881518110611e0057611e00612780565b60200260200101516020018190525086611e19906128db565b96505050505b60208201516001821b11611e3d57611e36816128db565b9050611d07565b508267ffffffffffffffff811115611e5757611e5761267a565b604051908082528060200260200182016040528015611e9057816020015b611e7d61216b565b815260200190600190039081611e755790505b50935060005b83811015611ee657828181518110611eb057611eb0612780565b6020026020010151858281518110611eca57611eca612780565b602002602001018190525080611edf906128db565b9050611e96565b5050505095945050505050565b60007ffffffffffffffffffffffffffffffffffffffffffffffffdb731c958f34d94c18213611f2457506000919050565b680755bf798b4a1bf1e58212611f9a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152600c60248201527f4558505f4f564552464c4f570000000000000000000000000000000000000000604482015260640160405180910390fd5b6503782dace9d9604e83901b059150600060606bb17217f7d1cf79abc9e3b39884821b056b80000000000000000000000001901d6bb17217f7d1cf79abc9e3b39881029093037fffffffffffffffffffffffffffffffffffffffdbf3ccf1604d263450f02a550481018102606090811d6d0277594991cfc85f6e2461837cd9018202811d7fffffffffffffffffffffffffffffffffffffe5adedaa1cb095af9e4da10e363c018202811d6db1bbb201f443cf962f1a1d3db4a5018202811d7ffffffffffffffffffffffffffffffffffffd38dc772608b0ae56cce01296c0eb018202811d6e05180bb14799ab47a8a8cb2a527d57016d02d16720577bd19bf614176fe9ea6c10fe68e7fd37d0007b713f765084018402831d9081019084017ffffffffffffffffffffffffffffffffffffffe2c69812cf03b0763fd454a8f7e010290911d6e0587f503bb6ea29d25fcb7401964500190910279d835ebba824c98fb31b83b2ca45c000000000000000000000000010574029d9dc38563c32e5c2f6dc192ee70ef65f9978af30260c3939093039290921c92915050565b82820281151584158583048514171661214e57600080fd5b0492915050565b60008183106121645781610803565b5090919050565b60405180604001604052806000815260200161219a604051806040016040528060008152602001600081525090565b905290565b6001600160a01b03811681146121b457600080fd5b50565b6000806000606084860312156121cc57600080fd5b83356121d78161219f565b95602085013595506040909401359392505050565b6000806000806080858703121561220257600080fd5b843561220d8161219f565b93506020850135925060408501359150606085013561222b8161219f565b939692955090935050565b60006020828403121561224857600080fd5b81356108038161219f565b60005b8381101561226e578181015183820152602001612256565b8381111561227d576000848401525b50505050565b6000815180845261229b816020860160208601612253565b601f01601f19169290920160200192915050565b600081518084526020808501945080840160005b838110156122f3576122e087835180518252602090810151910152565b60409690960195908201906001016122c3565b509495945050505050565b600081518084526020808501945080840160005b838110156122f3578151805188528301516123398489018280518252602090810151910152565b506060969096019590820190600101612312565b60006020808301818452808551808352604092508286019150828160051b87010184880160005b838110156124be578883037fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc0018552815180516001600160a01b031684526101a088820151818a8701526123ca82870182612283565b91505087820151888601526060808301516123f8828801826fffffffffffffffffffffffffffffffff169052565b50506080828101516fffffffffffffffffffffffffffffffff169086015260a08083015160ff9081169187019190915260c0808401519091169086015260e08083015115159086015261010080830151908601526101208083015190860152610140808301518683038288015261246f83826122af565b92505050610160808301518683038288015261248b83826122fe565b9250505061018080830151925085820381870152506124aa81836122fe565b968901969450505090860190600101612374565b509098975050505050505050565b600080604083850312156124df57600080fd5b82356124ea8161219f565b946020939093013593505050565b602080825282518282018190526000919060409081850190868401855b828110156125425761253284835180518252602090810151910152565b9284019290850190600101612515565b5091979650505050505050565b6000806000806080858703121561256557600080fd5b505082516020840151604085015160609095015191969095509092509050565b60006020828403121561259757600080fd5b81516108038161219f565b6000602082840312156125b457600080fd5b5051919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b600082198211156125fd576125fd6125bb565b500190565b600082821015612614576126146125bb565b500390565b6000817fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0483118215151615612651576126516125bb565b500290565b6000806040838503121561266957600080fd5b505080516020909101519092909150565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b604051601f8201601f1916810167ffffffffffffffff811182821017156126d2576126d261267a565b604052919050565b600060208083850312156126ed57600080fd5b825167ffffffffffffffff8082111561270557600080fd5b818501915085601f83011261271957600080fd5b81518181111561272b5761272b61267a565b8060051b915061273c8483016126a9565b818152918301840191848101908884111561275657600080fd5b938501935b8385101561121157845192506127708361219f565b828252938501939085019061275b565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b805160ff811681146127c057600080fd5b919050565b600080600080608085870312156127db57600080fd5b84516fffffffffffffffffffffffffffffffff811681146127fb57600080fd5b9350612809602086016127af565b9250612817604086016127af565b91506060850151801515811461222b57600080fd5b60006020828403121561283e57600080fd5b815167ffffffffffffffff8082111561285657600080fd5b818401915084601f83011261286a57600080fd5b81518181111561287c5761287c61267a565b61288f6020601f19601f840116016126a9565b91508082528560208285010111156128a657600080fd5b6128b7816020840160208601612253565b50949350505050565b6000602082840312156128d257600080fd5b610803826127af565b60007fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff820361290c5761290c6125bb565b5060010190565b600082612949577f4e487b7100000000000000000000000000000000000000000000000000000000600052601260045260246000fd5b500690565b60006020828403121561296057600080fd5b815163ffffffff8116811461080357600080fd5b60007f800000000000000000000000000000000000000000000000000000000000000082036129a5576129a56125bb565b5060000390565b6000808312837f8000000000000000000000000000000000000000000000000000000000000000018312811516156129e6576129e66125bb565b837f7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff018313811615612a1a57612a1a6125bb565b5050039056fea26469706673582212206a97d299e1e98674a81c215f371a4d1e421c9ca2cab08dbb6328cf803d694f2664736f6c634300080d0033",
  "devdoc": {
    "kind": "dev",
    "methods": {
      "accounts(address)": {
        "params": {
          "account": "address which the extended data will be calculated."
        },
        "returns": {
          "data": "extended accountability of all markets for the account."
        }
      },
      "previewBorrowAtMaturity(address,uint256,uint256)": {
        "params": {
          "assets": "amount of assets that will be borrowed.",
          "market": "address of the market.",
          "maturity": "maturity date/pool where the assets will be borrowed."
        },
        "returns": {
          "positionAssets": "amount plus fees that the depositor will repay at maturity."
        }
      },
      "previewDepositAtAllMaturities(address,uint256)": {
        "params": {
          "assets": "amount of assets that will be deposited.",
          "market": "address of the market."
        },
        "returns": {
          "positionAssetsMaturities": "array containing amount plus yield that user will receive after each maturity."
        }
      },
      "previewDepositAtMaturity(address,uint256,uint256)": {
        "params": {
          "assets": "amount of assets that will be deposited.",
          "market": "address of the market.",
          "maturity": "maturity date/pool where the assets will be deposited."
        },
        "returns": {
          "positionAssets": "amount plus yield that the depositor will receive after maturity."
        }
      },
      "previewRepayAtMaturity(address,uint256,uint256,address)": {
        "params": {
          "borrower": "address of the borrower.",
          "market": "address of the market.",
          "maturity": "maturity date/pool where the assets will be repaid.",
          "positionAssets": "amount of assets that will be subtracted from the position."
        },
        "returns": {
          "repayAssets": "amount of assets that will be repaid."
        }
      },
      "previewWithdrawAtMaturity(address,uint256,uint256)": {
        "params": {
          "market": "address of the market.",
          "maturity": "maturity date/pool where the assets will be withdrawn.",
          "positionAssets": "amount of assets that will be tried to withdraw."
        },
        "returns": {
          "withdrawAssets": "amount that will be withdrawn."
        }
      }
    },
    "title": "Previewer",
    "version": 1
  },
  "userdoc": {
    "kind": "user",
    "methods": {
      "accounts(address)": {
        "notice": "Function to get a certain account extended data."
      },
      "previewBorrowAtMaturity(address,uint256,uint256)": {
        "notice": "Gets the amount plus fees to be repaid at maturity when borrowing certain amount of assets."
      },
      "previewDepositAtAllMaturities(address,uint256)": {
        "notice": "Gets the assets plus yield offered by all VALID maturities when depositing a certain amount."
      },
      "previewDepositAtMaturity(address,uint256,uint256)": {
        "notice": "Gets the assets plus yield offered by a maturity when depositing a certain amount."
      },
      "previewRepayAtMaturity(address,uint256,uint256,address)": {
        "notice": "Gets the assets that will be repaid when repaying a certain amount at the current maturity."
      },
      "previewWithdrawAtMaturity(address,uint256,uint256)": {
        "notice": "Gets the amount to be withdrawn for a certain positionAmount of assets at maturity."
      }
    },
    "notice": "Contract to be consumed by Exactly's front-end dApp.",
    "version": 1
  },
  "storageLayout": {
    "storage": [],
    "types": null
  }
}